<!DOCTYPE HTML><html lang="zh-CN" data-default-color-scheme="auto"><head><meta charset="utf-8"><meta name="keywords" content="hexo, matery, Github, cdn, seo, blog, google, baidu, bing, shenma"><meta name="description" content="有了一个独立博客后，访问速度很忙怎么办？这时候你需要上各种各样的优化手段了，比喻CDN，service worker,页面压缩技术，SEO优化等等。"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="renderer" content="webkit|ie-stand|ie-comp"><meta name="mobile-web-app-capable" content="yes"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="apple-mobile-web-app-title" content="夜法之书"><meta name="theme-color" content="#7e9fc4"><meta name="msapplication-TileImage" content="/medias/icons/android-chrome-192x192.png"><meta name="msapplication-TileColor" content="#7e9fc4"><meta http-equiv="Content-Security-Policy" content="default-src * vitals.vercel-insights.com 'unsafe-inline' 'unsafe-eval'; script-src * 'unsafe-inline' 'unsafe-eval'; connect-src * 'unsafe-inline'; img-src * data: blob: 'unsafe-inline'; font-src * data: blob: 'unsafe-inline'; frame-src *;style-src * 'unsafe-inline';"><link rel="apple-touch-icon" href="/medias/icons/apple-touch-icon.png"><link rel="mask-icon" href="/medias/icons/android-chrome-512x512.svg" color="#000000"><title>基于Hexo的matery主题搭建博客网络优化篇3 | 夜法之书</title><link rel="manifest" href="/manifest.json"><link rel="icon" type="image/webp" href="/favicon.webp"><link href="//cimg1.17lai.fun" rel="preconnect" crossorigin><link href="https://live2dapi.17lai.site" rel="preconnect" crossorigin><link href="https://live2dapi.17lai.site" rel="dns-prefetch" crossorigin><link href="//cdn.webpushr.com" rel="preconnect" crossorigin><link href="//bot.webpushr.com" rel="preconnect" crossorigin><link href="//analytics.webpushr.com" rel="preconnect" crossorigin><link href="https://waline.17lai.site" rel="preconnect" crossorigin><link href="https://waline.17lai.site" rel="dns-prefetch" crossorigin><link rel="alternate" type="application/atom+xml" title="所有订阅ATOM--夜法之书" href="https://blog.17lai.site/atom.xml"><link rel="alternate" type="application/rss+xml" title="所有订阅RSS2--夜法之书" href="https://blog.17lai.site/rss.xml"><link rel="alternate" type="application/json" title="所有订阅JSON--夜法之书" href="https://blog.17lai.site/feed.json"><script src="/libs/jquery/jquery.min.js?v=3.7.1"></script><link rel="stylesheet preload" as="style" type="text/css" href="/libs/awesome/css/all.min.css?v=5.15.4" importance="auto"><link rel="modulepreload" href="/libs/waline/waline.min.js?v=3.6.0" as="script" importance="low"><link rel="stylesheet preload" as="style" type="text/css" href="/libs/materialize/materialize.min.css?v=1.2.2"><link rel="stylesheet preload" as="style" type="text/css" href="/libs/aos/aos.min.css"><link rel="stylesheet preload" as="style" type="text/css" href="/libs/animate/animate.min.css" importance="low"><link rel="stylesheet preload" as="style" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css" importance="low"><link rel="stylesheet preload" as="style" type="text/css" href="/libs/jquery/jquery-ui.min.css?v=1.14.0" importance="low"><link rel="stylesheet preload" as="style" type="text/css" href="/css/main.css?v=1.2.7"><noscript><link rel="stylesheet" href="/libs/materialize/materialize.min.css?v=1.2.2"><link rel="stylesheet" href="/css/main.css?v=1.2.7"></noscript><link rel="stylesheet preload" as="style" href="/libs/tocbot/tocbot.min.css?v=4.36.4"><link rel="stylesheet preload" as="style" type="text/css" href="/libs/share/css/share.min.css?v=1.0.16"><link rel="stylesheet preload" as="style" type="text/css" href="/css/highlight.css?v=1.0.0" id="highlight-css"><link rel="stylesheet preload" as="style" type="text/css" href="/css/highlight-dark.css?v=1.0.0" id="highlight-css-dark"><link rel="stylesheet" href="/libs/waline/waline.min.css?v=3.6.0" importance="low"><link rel="modulepreload" href="/libs/waline/waline.min.js?v=3.6.0" as="script" importance="low"><link rel="stylesheet" type="text/css" href="/css/waline.css?v=1.0.2" media="none" onload='"all"!=media&&(media="all")'><link rel="preload" href="/libs/jquery/jquery.min.js?v=3.7.1" as="script" importance="high"><link rel="preload" href="/js/utils.js?v=1.1.2" as="script" importance="high"><link rel="preload" href="/js/color-schema.js?v=1.0.1" as="script" importance="high"><link rel="stylesheet preload" as="style" type="text/css" href="/libs/live2d/waifu.css" importance="low"><link rel="preload" href="/libs/materialize/materialize.min.js?v=1.2.2" as="script" importance="auto"><link rel="preload" href="/libs/masonry/masonry.pkgd.min.js?v=4.2.2" as="script"><link rel="preload" href="/libs/aos/aos.min.js?v=2.3.4" as="script"><link rel="preload" href="/libs/lightGallery/js/lightgallery-all.min.js?v=1.10.0" as="script" importance="low"><link rel="preload" href="/js/events.js?v=1.0.0" as="script"><link rel="preload" href="/js/plugins.js?v=1.1.2" as="script"><link rel="preload" href="/libs/scrollprogress/scrollProgress.min.js?v=3.0.2" as="script"><link rel="preload" href="/js/boot.js?v=1.0.0" as="script" importance="low"><link rel="preload" href="/libs/tocbot/tocbot.min.js?v=4.36.4" as="script"><link rel="preload" href="/libs/tag-common/index.js" as="script"><link rel="prefetch" as="script" href="/libs/share/js/social-share.min.js?v=1.0.16" importance="low"><link rel="preload" href="/libs/prism/components/prism-core.min.js?v=1.30.0" as="script"><link rel="preload" href="/libs/prism/plugins/autoloader/prism-autoloader.min.js" as="script"><link rel="stylesheet preload" as="style" type="text/css" href="/libs/prism/plugins/line-numbers/prism-line-numbers.min.css"><link rel="preload" href="/libs/prism/plugins/line-numbers/prism-line-numbers.min.js" as="script"><link rel="stylesheet preload" as="style" type="text/css" href="/libs/prism/plugins/autolinker/prism-autolinker.min.css"><link rel="preload" href="/libs/prism/plugins/autolinker/prism-autolinker.min.js" as="script"><script id="matery-configs">var Matery=window.Matery||{};Matery.ctx=Object.assign({},Matery.ctx);var CONFIG={hostname:"blog.17lai.site",root:"/",version:"2.0.0",zh_default:2,typing:{enable:!0,typeSpeed:70,cursorChar:"_",loop:!1,scope:[]},postTyped:{enable:!0,loop:!1,showCursor:!0,cursorChar:"_",startDelay:50,typeSpeed:70,backSpeed:50},subtitleTyped:{loop:!0,showCursor:!0,cursorChar:"_",startDelay:100,typeSpeed:80,backSpeed:50},anchorjs:{enable:!1,element:"h1,h2,h3,h4,h5,h6",placement:"right",visible:"hover",icon:""},progressbar:{enable:!1,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"TEXT"},copy_btn:!0,show_full:!0,show_expand:!0,shrink:!0,break:!1,image_caption:{enable:!0},fun_features:{typing:{enable:!0,typeSpeed:70,cursorChar:"_",loop:!1,scope:[]},anchorjs:{enable:!1,element:"h1,h2,h3,h4,h5,h6",placement:"right",visible:"hover",icon:""},progressbar:{enable:!1,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},monitortext:{enable:!1,text:"你看不到我！"},videobg:{enable:!1,url:"/video_url.json?v=1.0.0"}},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0,showToggleBtn:!0},outdate:{enable:!1,warning_day:365,error_day:3650},lazyload:{enable:!0,loading_img:"/medias_webp/loading2.svg",loading_img_dark:"/medias_webp/loading2-dark.svg",onlypost:!1,offset_factor:2},web_analytics:{enable:!0,follow_dnt:!1,baidu:{enable:!1,id:"22cc5bdea6e529c1349d44b7306b3b8c"},baiduPush:!1,google:{enable:!1,measurement_id:"G-JNYZP4ZLDJ"},umami:{enable:!0,totalTraffic:!0,totalNumberOfvisitors:!0,pageStats:!0,src:"https://ana.17lai.site/script.js",start_time:"2023-01-01T00:00:00.000Z",token:"OgIvVJnSmkB37SNyb9UYE33p9hKuI/6jodFSsENOJbyjfg+AG+lYaU499pgVo8gZ1uPIUu9mYMFOk0E9U5cFMbUvI2guPKZZHMxp/xs+1vWtaoV7055ou/e8Ig8Rpm23VRreWzvLZiu+TpbreotPGLXUCYLxUqeedDjKvFPb+Rx6D34/l+gEetxG/vbJJvfTgITk+snFv0zwxx9i2Ig8jhycilhDEhKKva/8L/0+uAewZ2i+6mq4Mn+s0UKfzXVCsDCJ08lJS9UcyjL5d8t5eZ8A2u1b3IV0ElqiaCepF7+HgmsTPR8c2h76Sf1yaUJa+0tPvMcRGLjClA5tFB3+N5hOF8anC072cw==",api_server:"https://ana.17lai.site",website_id:"e532f69d-5606-40c9-9dbb-bfa04258384f"},tencent:{enable:!1,sid:null,cid:null},woyaola:{enable:!1,id:"JynRUZuReKUzZQSo",ck:"JynRUZuReKUzZQSo"},cnzz:{enable:!1,id:null},leancloud:{app_id:null,app_key:null,server_url:null,path:"window.location.pathname",ignore_local:!1}},search_path:"/local-search.xml"};if(CONFIG.web_analytics.follow_dnt){var dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack;Matery.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on"))}</script><script src="/js/utils.js?v=1.1.2"></script><script src="/js/color-schema.js?v=1.0.1"></script><link rel="stylesheet" href="/libs/prism/plugins/line-numbers/prism-line-numbers.min.css"><link rel="stylesheet" href="/libs/prism/plugins/autolinker/prism-autolinker.min.css"><script async>window.WebGLRenderingContext||console.log("您的浏览器不支持WebGL，可能会影响部分页面显示，请尝试重启浏览器，使用最新版 Chrome 或 Edge 浏览器。");var windowWidth=window.innerWidth,minFunWidth=1024;window.addEventListener("resize",(function(){windowWidth=window.innerWidth}));var supportsPassive=!1;try{var opts=Object.defineProperty({},"passive",{get:function(){supportsPassive=!0}});window.addEventListener("testpassive",null,opts),window.removeEventListener("testpassive",null,opts)}catch(e){}var runningOnBrowser="undefined"!=typeof window,isBot=runningOnBrowser&&!("onscroll"in window)||"undefined"!=typeof navigator&&/(gle|ing|ro|msn)bot|crawl|spider|yand|duckgo|Google (Page Speed|Web Preview)/i.test(navigator.userAgent)</script><script async>const swUrl="/sw.js",swScope="/";(async()=>{if("serviceWorker"in navigator)try{const r=await navigator.serviceWorker.register(swUrl,{scope:"/"});console.log("[PWA]Service Worker registered:",r)}catch(r){console.error("[PWA]Service Worker registration failed:",r)}})()</script><script async>Matery.ctx.dnt||isBot||function(){var t=document.createElement("script");t.async=!0,t.dataset.cache=!0,t.dataset.websiteId="e532f69d-5606-40c9-9dbb-bfa04258384f",t.src="https://ana.17lai.site/script.js";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()</script><script>let HEXO_MMEDIA_DATA={js:[],css:[],aplayerData:[],metingData:[],artPlayerData:[],dplayerData:[]}</script><meta name="generator" content="Hexo 7.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head><body><header class="navbar-fixed"><nav id="headNav" class="bg-color nav-transparent"><div id="navContainer" class="nav-wrapper container"><div class="brand-logo"><a href="/" class="waves-effect waves-light"><img no-lazy src="/favicon.webp" width="108" height="108" style="width:40px;height:45px" class="logo-img" alt="LOGO"> <span class="logo-span">夜法之书</span></a></div><a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse" aria-label="侧边菜单"><i class="fas fa-bars"></i></a><ul class="right nav-menu"><li class="hide-on-med-and-down nav-item menu-2d-home"><a href="/" class="nav-link"><i class="fas fa-home"></i> 首页</a></li><li class="hide-on-med-and-down nav-item menu-2d-nav"><a target="_blank" rel="noopener external nofollow noreferrer" href="https://nav.17lai.site/" class="nav-link"><i class="fas fa-suitcase"></i> 导航</a></li><li class="hide-on-med-and-down nav-item menu-2d-sosuo"><a target="_blank" rel="noopener external nofollow noreferrer" href="https://so.17lai.site/" class="nav-link"><i class="fas fa-mask"></i> SO</a></li><li class="hide-on-med-and-down nav-item menu-2d-media"><a href="#" class="nav-link"><i class="fas fa-music"></i> 多媒体 <i class="fas fa-chevron-down" aria-hidden="true"></i></a><ul class="sub-nav menus_item_child"><li class="menu-2d-musics"><a class="nav-link" href="/musics/"><i class="fas fa-music fa-fw" style="margin-top:-20px"></i> 音乐</a></li><li class="menu-2d-galleries"><a class="nav-link" href="/galleries/"><i class="fas fa-image fa-fw" style="margin-top:-20px"></i> 相册</a></li><li class="menu-2d-movies"><a class="nav-link" href="/movies/"><i class="fas fa-film fa-fw" style="margin-top:-20px"></i> 视频</a></li><li class="menu-2d-musicplayer"><a class="nav-link" target="_blank" rel="noopener external nofollow noreferrer" href="https://musicplayer.17lai.site/"><i class="fas fa-music fa-fw" style="margin-top:-20px"></i> 在线云音乐</a></li><li class="menu-2d-music"><a class="nav-link" target="_blank" rel="noopener external nofollow noreferrer" href="https://music.17lai.site/"><i class="fas fa-music fa-fw" style="margin-top:-20px"></i> 音乐播放器</a></li></ul></li><li class="hide-on-med-and-down nav-item menu-2d-posts"><a href="#" class="nav-link"><i class="fas fa-folder-plus"></i> 文章 <i class="fas fa-chevron-down" aria-hidden="true"></i></a><ul class="sub-nav menus_item_child"><li class="menu-2d-tags"><a class="nav-link" href="/tags/"><i class="fas fa-tags fa-fw" style="margin-top:-20px"></i> 标签</a></li><li class="menu-2d-categories"><a class="nav-link" href="/categories/"><i class="fas fa-bookmark fa-fw" style="margin-top:-20px"></i> 分类</a></li><li class="menu-2d-archives"><a class="nav-link" href="/archives/"><i class="fas fa-archive fa-fw" style="margin-top:-20px"></i> 归档</a></li></ul></li><li class="hide-on-med-and-down nav-item menu-2d-toolbox"><a href="#" class="nav-link"><i class="fas fa-toolbox"></i> 工具 <i class="fas fa-chevron-down" aria-hidden="true"></i></a><ul class="sub-nav menus_item_child"><li class="menu-2d-tg"><a class="nav-link" target="_blank" rel="noopener external nofollow noreferrer" href="https://t.me/chat_17laisite"><i class="fab fa-telegram-plane fa-fw" style="margin-top:-20px"></i> TG交流群</a></li><li class="menu-2d-linuxtool"><a class="nav-link" target="_blank" rel="noopener external nofollow noreferrer" href="https://linux-command.17lai.site/"><i class="fas fa-terminal fa-fw" style="margin-top:-20px"></i> Linux命令</a></li><li class="menu-2d-cheatsheets"><a class="nav-link" href="/dash/"><i class="fas fa-laptop-code fa-fw" style="margin-top:-20px"></i> 各种快查表</a></li><li class="menu-2d-onebox"><a class="nav-link" target="_blank" rel="noopener external nofollow noreferrer" href="https://alist.17lai.site/"><i class="fas fa-cloud fa-fw" style="margin-top:-20px"></i> 私人网盘</a></li><li class="menu-2d-staticnav"><a class="nav-link" href="/nav/"><i class="fas fa-tools fa-fw" style="margin-top:-20px"></i> 网址导航</a></li></ul></li><li class="hide-on-med-and-down nav-item menu-2d-mirror"><a href="#" class="nav-link"><i class="fas fa-link"></i> 镜像 <i class="fas fa-chevron-down" aria-hidden="true"></i></a><ul class="sub-nav menus_item_child"><li class="menu-2d-mirror-cf"><a class="nav-link" target="_blank" rel="noopener external nofollow noreferrer" href="https://cfblog.17lai.site/"><i class="fas fa-link fa-fw" style="margin-top:-20px"></i> CF镜像</a></li><li class="menu-2d-mirror-vps20"><a class="nav-link" target="_blank" rel="noopener" href="https://v20blog.17lai.site/"><i class="fas fa-link fa-fw" style="margin-top:-20px"></i> VPS镜像</a></li><li class="menu-2d-mirror-main"><a class="nav-link" href="https://blog.17lai.site/"><i class="fas fa-link fa-fw" style="margin-top:-20px"></i> 主站</a></li></ul></li><li class="hide-on-med-and-down nav-item menu-2d-friends"><a href="/friends/" class="nav-link"><i class="fas fa-link"></i> 友链</a></li><li class="hide-on-med-and-down nav-item menu-2d-msg"><a href="/msg/" class="nav-link"><i class="fas fa-comment-alt"></i> 留言</a></li><li class="hide-on-med-and-down nav-item menu-2d-about"><a href="/about/" class="nav-link"><i class="fas fa-user-circle"></i> 关于</a></li><li class="nav-item menu-2d-search"><a href="#searchModal" class="nav-link modal-trigger" data-umami-event-search="search modal click" onclick="handleSearchClick()"><i id="searchIcon" class="fas fa-search" title="搜索"></i></a></li><li class="nav-item menu-2d-dark" data-umami-event-color="color toggle" id="color-toggle-btn"><a class="nav-link" target="_self" href="javascript:;" rel="external nofollow noreferrer" aria-label="Color Toggle">&nbsp; <i class="fas fa-sun" id="color-toggle-icon"></i>&nbsp;</a></li></ul><div id="mobile-nav" class="side-nav sidenav"><div class="mobile-head bg-color"><div><img src="/favicon.webp" width="108" height="108" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload style="width:45px;height:45px" class="logo-img circle responsive-img" alt="LOGO"><div class="logo-name">夜法之书</div><div class="logo-desc">~软件驱动世界~个人独立技术博客，关于Linux,开源，Nas，Docker，嵌入式，理财，健身等主题！</div></div></div><ul class="menu-list mobile-menu-list"><li class="m-nav-item"><a href="/" class="waves-effect waves-light"><i class="fa-fw fas fa-home"></i> 首页</a></li><li class="m-nav-item"><a target="_blank" rel="noopener external nofollow noreferrer" href="https://nav.17lai.site/" class="waves-effect waves-light"><i class="fa-fw fas fa-suitcase"></i> 导航</a></li><li class="m-nav-item"><a target="_blank" rel="noopener external nofollow noreferrer" href="https://so.17lai.site/" class="waves-effect waves-light"><i class="fa-fw fas fa-mask"></i> SO</a></li><li class="m-nav-item"><a href="javascript:;" rel="external nofollow noreferrer"><i class="fa-fw fas fa-music"></i> 多媒体 <span class="m-icon"><i class="fas fa-chevron-right"></i></span></a><ul><li><a href="/musics/" style="margin-left:75px"><i class="fas fa-music fa-fw" style="position:absolute;left:50px"></i> <span>音乐</span></a></li><li><a href="/galleries/" style="margin-left:75px"><i class="fas fa-image fa-fw" style="position:absolute;left:50px"></i> <span>相册</span></a></li><li><a href="/movies/" style="margin-left:75px"><i class="fas fa-film fa-fw" style="position:absolute;left:50px"></i> <span>视频</span></a></li><li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://musicplayer.17lai.site/" style="margin-left:75px"><i class="fas fa-music fa-fw" style="position:absolute;left:50px"></i> <span>在线云音乐</span></a></li><li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://music.17lai.site/" style="margin-left:75px"><i class="fas fa-music fa-fw" style="position:absolute;left:50px"></i> <span>音乐播放器</span></a></li></ul></li><li class="m-nav-item"><a href="javascript:;" rel="external nofollow noreferrer"><i class="fa-fw fas fa-folder-plus"></i> 文章 <span class="m-icon"><i class="fas fa-chevron-right"></i></span></a><ul><li><a href="/tags/" style="margin-left:75px"><i class="fas fa-tags fa-fw" style="position:absolute;left:50px"></i> <span>标签</span></a></li><li><a href="/categories/" style="margin-left:75px"><i class="fas fa-bookmark fa-fw" style="position:absolute;left:50px"></i> <span>分类</span></a></li><li><a href="/archives/" style="margin-left:75px"><i class="fas fa-archive fa-fw" style="position:absolute;left:50px"></i> <span>归档</span></a></li></ul></li><li class="m-nav-item"><a href="javascript:;" rel="external nofollow noreferrer"><i class="fa-fw fas fa-toolbox"></i> 工具 <span class="m-icon"><i class="fas fa-chevron-right"></i></span></a><ul><li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://t.me/chat_17laisite" style="margin-left:75px"><i class="fab fa-telegram-plane fa-fw" style="position:absolute;left:50px"></i> <span>TG交流群</span></a></li><li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://linux-command.17lai.site/" style="margin-left:75px"><i class="fas fa-terminal fa-fw" style="position:absolute;left:50px"></i> <span>Linux命令</span></a></li><li><a href="/dash/" style="margin-left:75px"><i class="fas fa-laptop-code fa-fw" style="position:absolute;left:50px"></i> <span>各种快查表</span></a></li><li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://alist.17lai.site/" style="margin-left:75px"><i class="fas fa-cloud fa-fw" style="position:absolute;left:50px"></i> <span>私人网盘</span></a></li><li><a href="/nav/" style="margin-left:75px"><i class="fas fa-tools fa-fw" style="position:absolute;left:50px"></i> <span>网址导航</span></a></li></ul></li><li class="m-nav-item"><a href="javascript:;" rel="external nofollow noreferrer"><i class="fa-fw fas fa-link"></i> 镜像 <span class="m-icon"><i class="fas fa-chevron-right"></i></span></a><ul><li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://cfblog.17lai.site/" style="margin-left:75px"><i class="fas fa-link fa-fw" style="position:absolute;left:50px"></i> <span>CF镜像</span></a></li><li><a target="_blank" rel="noopener" href="https://v20blog.17lai.site/" style="margin-left:75px"><i class="fas fa-link fa-fw" style="position:absolute;left:50px"></i> <span>VPS镜像</span></a></li><li><a href="https://blog.17lai.site/" style="margin-left:75px"><i class="fas fa-link fa-fw" style="position:absolute;left:50px"></i> <span>主站</span></a></li></ul></li><li class="m-nav-item"><a href="/friends/" class="waves-effect waves-light"><i class="fa-fw fas fa-link"></i> 友链</a></li><li class="m-nav-item"><a href="/msg/" class="waves-effect waves-light"><i class="fa-fw fas fa-comment-alt"></i> 留言</a></li><li class="m-nav-item"><a href="/about/" class="waves-effect waves-light"><i class="fa-fw fas fa-user-circle"></i> 关于</a></li></ul></div></div></nav></header><div id="banner" class="bg-cover pd-header post-cover" style="background-image:url(/medias_webp/cover/hexo.webp)"><div class="bg-cover-before"></div><div class="container" style="right:0;left:0"><div class="row"><div class="col s12 m12 l12"><div class="brand center"><h1 id="post-title" class="description center-align post-title"><span id="typed-strings"><span>基于Hexo的matery主题搭建博客网络优化篇3</span> </span><span id="typed"></span></h1><div class="center-align"><div id="umami-page-views-container" class="post-meta" style="display:inline"><i class="far fa-eye fa-fw"></i>查阅:&nbsp;&nbsp; <span id="umami-page-views" style="display:none;min-width:2rem"></span> <i id="umami_pageviews_loading_icon" class="fas fa-sync fa-spin" style="display:inline-block;min-width:2rem"></i>&nbsp;&nbsp;</div><div id="waline_container_comment_count" class="post-meta" style="display:inline"><i class="far fa-comment fa-fw"></i>评论:&nbsp;&nbsp; <span id="waline_comments_count" class="waline-comment-count" data-path="/posts/9b056c86/" style="display:none;min-width:2rem"></span> <i id="waline_commentcount_loading_icon" class="fas fa-sync fa-spin infinite-rotate" style="display:inline-block;min-width:2rem"></i>条</div></div></div></div></div></div><div class="bg-cover-after"></div></div><main class="post-container content"><div class="row"><div id="main-content" class="col s12 m12"><div id="artDetail"><div class="card"><div class="card-content article-info"><div class="row tag-cate"><div class="col s7"><div class="article-tag"><a href="/tags/github/"><span class="chip bg-color">github</span> </a><a href="/tags/hexo/"><span class="chip bg-color">hexo</span> </a><a href="/tags/matery/"><span class="chip bg-color">matery</span> </a><a href="/tags/cdn/"><span class="chip bg-color">cdn</span> </a><a href="/tags/seo/"><span class="chip bg-color">seo</span></a></div></div><div class="col s5 right-align"><div class="post-cate"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="/categories/hexo/" class="post-category">hexo</a><link rel="alternate dns-prefetch" type="application/atom+xml" title="分类订阅--hexo" href="https://blog.17lai.site/categories/hexo/atom.xml"></div></div></div><div class="post-info"><div class="post-date info-break-policy"><i class="far fa-calendar-minus fa-fw"></i> <span>发布:&nbsp;&nbsp;</span><time datetime="2022-03-27 15:27" pubdate> 2022年3月27日 下午</time></div><div class="post-date info-break-policy"><i class="far fa-calendar-check fa-fw"></i> <span>更新:&nbsp;&nbsp;</span><time datetime="2025-06-28 23:07" update> 2025年6月28日 晚上</time></div><div class="info-break-policy"><i class="far fa-file-word fa-fw"></i>字数:&nbsp;&nbsp; 16.4k</div><div class="info-break-policy"><i class="far fa-clock fa-fw"></i>阅时:&nbsp;&nbsp; 67 分</div><div id="read_mode" class="info-break-policy" style="display:inline"><i class="fas fa-expand-arrows-alt" title="【进入/离开】 阅读模式" aria-hidden="true"></i>&nbsp;&nbsp; <span title="【进入/离开】阅读模式" aria-hidden="true">阅读模式</span></div></div></div><hr class="clearfix"><div class="card-content article-card-content markdown-body"><div id="articleContent"><blockquote><p>经过一系列优化修改后，网站测速评分总算是过得去了。😄使用技术大概有如下：</p><ul><li>各种CDN</li><li>webp</li><li>lazyload</li><li>preload</li><li>gulp 压缩</li><li>cloudflare parter</li><li>service worker， PWA</li><li>部分资源异步加载</li></ul></blockquote><p><img src="https://cimg1.17lai.site/data/2023/03/14/20230314060200.webp" width="2556" height="1240" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload alt="page test优化前"></p><p><img src="https://cimg1.17lai.site/data/2023/03/14/20230314060200-1.webp" width="2551" height="1240" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload alt="page test优化后"></p><p><img src="https://cimg1.17lai.site/data/2023/03/14/20230314060200-2.webp" width="1500" height="1082" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload alt="PageSpeed Insights 测速"></p><blockquote><p>优化无止境，每当以为只能上钞能力的时候，又发现了新的优化方法！</p><p>看来，钞能力还得保留一整子了~</p></blockquote><h2 id="加载速度优化概要">加载速度优化概要</h2><div class="markmap-container" style="height:1800px"><svg data="{&quot;t&quot;:&quot;root&quot;,&quot;d&quot;:0,&quot;v&quot;:&quot;&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:2,&quot;p&quot;:{&quot;lines&quot;:[1,2]},&quot;v&quot;:&quot;评估&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[2,3]},&quot;v&quot;:&quot;Google PageSpeed Insights&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[3,4]},&quot;v&quot;:&quot;Chrome Audites(Lighthouse)&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[4,5]},&quot;v&quot;:&quot;webpagetest&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[5,6]},&quot;v&quot;:&quot;用户反馈&quot;}]},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:2,&quot;p&quot;:{&quot;lines&quot;:[6,7]},&quot;v&quot;:&quot;优化&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[7,8]},&quot;v&quot;:&quot;域名&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[8,9]},&quot;v&quot;:&quot;启用SSL&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[9,10]},&quot;v&quot;:&quot;负载均衡&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[10,11]},&quot;v&quot;:&quot;防劫持&quot;}]},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[11,12]},&quot;v&quot;:&quot;DNS优化&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[12,13]},&quot;v&quot;:&quot;解析路线&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[13,14]},&quot;v&quot;:&quot;不同线路解析&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[14,15]},&quot;v&quot;:&quot;不同地域解析&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[15,16]},&quot;v&quot;:&quot;双上联&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[16,17]},&quot;v&quot;:&quot;自建DNS&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:8,&quot;p&quot;:{&quot;lines&quot;:[17,18]},&quot;v&quot;:&quot;smartdns&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:8,&quot;p&quot;:{&quot;lines&quot;:[18,19]},&quot;v&quot;:&quot;DNSMasq&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:8,&quot;p&quot;:{&quot;lines&quot;:[19,20]},&quot;v&quot;:&quot;hosts&quot;}]},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[20,21]},&quot;v&quot;:&quot;减少跳转&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:8,&quot;p&quot;:{&quot;lines&quot;:[21,22]},&quot;v&quot;:&quot;cname&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:8,&quot;p&quot;:{&quot;lines&quot;:[22,23]},&quot;v&quot;:&quot;ping延迟&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:8,&quot;p&quot;:{&quot;lines&quot;:[23,24]},&quot;v&quot;:&quot;最近dns&quot;}]}]},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[24,25]},&quot;v&quot;:&quot;服务器优化&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[25,26]},&quot;v&quot;:&quot;多节点部署&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[26,27]},&quot;v&quot;:&quot;异地备灾&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[27,28]},&quot;v&quot;:&quot;多线路服务器&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[28,29]},&quot;v&quot;:&quot;更高主频，内存，带宽&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[29,30]},&quot;v&quot;:&quot;nginx&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:8,&quot;p&quot;:{&quot;lines&quot;:[30,31]},&quot;v&quot;:&quot;指定cpu构架编译&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:8,&quot;p&quot;:{&quot;lines&quot;:[31,32]},&quot;v&quot;:&quot;cache&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:8,&quot;p&quot;:{&quot;lines&quot;:[32,33]},&quot;v&quot;:&quot;module 模块优化&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:8,&quot;p&quot;:{&quot;lines&quot;:[33,34]},&quot;v&quot;:&quot;负载均衡&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:10,&quot;p&quot;:{&quot;lines&quot;:[34,35]},&quot;v&quot;:&quot;dns&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:10,&quot;p&quot;:{&quot;lines&quot;:[35,36]},&quot;v&quot;:&quot;硬件&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:10,&quot;p&quot;:{&quot;lines&quot;:[36,37]},&quot;v&quot;:&quot;nginx 负载均衡&quot;}]}]}]},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[37,38]},&quot;v&quot;:&quot;缓存&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[38,39]},&quot;v&quot;:&quot;本地缓存&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[39,40]},&quot;v&quot;:&quot;Service Worker&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[40,41]},&quot;v&quot;:&quot;nginx gache&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[41,42]},&quot;v&quot;:&quot;CDN&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[42,43]},&quot;v&quot;:&quot;CDN&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:8,&quot;p&quot;:{&quot;lines&quot;:[43,44]},&quot;v&quot;:&quot;静态js css加速&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:8,&quot;p&quot;:{&quot;lines&quot;:[44,45]},&quot;v&quot;:&quot;通用库加速&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:8,&quot;p&quot;:{&quot;lines&quot;:[45,46]},&quot;v&quot;:&quot;图片分发网络&quot;}]},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[46,47]},&quot;v&quot;:&quot;体积&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[47,48]},&quot;v&quot;:&quot;压缩&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:8,&quot;p&quot;:{&quot;lines&quot;:[48,49]},&quot;v&quot;:&quot;js html css压缩&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:8,&quot;p&quot;:{&quot;lines&quot;:[49,50]},&quot;v&quot;:&quot;gulp&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:8,&quot;p&quot;:{&quot;lines&quot;:[50,51]},&quot;v&quot;:&quot;webpack&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:8,&quot;p&quot;:{&quot;lines&quot;:[51,52]},&quot;v&quot;:&quot;图片压缩&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:8,&quot;p&quot;:{&quot;lines&quot;:[52,53]},&quot;v&quot;:&quot;webp webm替代&quot;}]},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[53,54]},&quot;v&quot;:&quot;精简&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:8,&quot;p&quot;:{&quot;lines&quot;:[54,55]},&quot;v&quot;:&quot;不必要的js css 图片&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:8,&quot;p&quot;:{&quot;lines&quot;:[55,56]},&quot;v&quot;:&quot;网站结构调整&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:10,&quot;p&quot;:{&quot;lines&quot;:[56,57]},&quot;v&quot;:&quot;菜单&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:10,&quot;p&quot;:{&quot;lines&quot;:[57,58]},&quot;v&quot;:&quot;特效&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:10,&quot;p&quot;:{&quot;lines&quot;:[58,59]},&quot;v&quot;:&quot;第三方库&quot;}]},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:8,&quot;p&quot;:{&quot;lines&quot;:[59,60]},&quot;v&quot;:&quot;第三方库减少使用&quot;}]},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[60,61]},&quot;v&quot;:&quot;图片优化&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:8,&quot;p&quot;:{&quot;lines&quot;:[61,62]},&quot;v&quot;:&quot;大小优化&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:10,&quot;p&quot;:{&quot;lines&quot;:[62,63]},&quot;v&quot;:&quot;webp webm&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:10,&quot;p&quot;:{&quot;lines&quot;:[63,64]},&quot;v&quot;:&quot;减少分辨率&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:10,&quot;p&quot;:{&quot;lines&quot;:[64,65]},&quot;v&quot;:&quot;图像质量&quot;}]},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:8,&quot;p&quot;:{&quot;lines&quot;:[65,66]},&quot;v&quot;:&quot;懒加载&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:10,&quot;p&quot;:{&quot;lines&quot;:[66,67]},&quot;v&quot;:&quot;loading img&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:10,&quot;p&quot;:{&quot;lines&quot;:[67,68]},&quot;v&quot;:&quot;thumbnail&quot;}]}]},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[68,69]},&quot;v&quot;:&quot;前端资源优化&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[69,70]},&quot;v&quot;:&quot;JS和CSS优化&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[70,71]},&quot;v&quot;:&quot;第三方库优化&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[71,72]},&quot;v&quot;:&quot;preload prefetch&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[72,73]},&quot;v&quot;:&quot;async defer&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[73,74]},&quot;v&quot;:&quot;ajax&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[74,75]},&quot;v&quot;:&quot;内容结构优化&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:8,&quot;p&quot;:{&quot;lines&quot;:[75,76]},&quot;v&quot;:&quot;加载更多&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:8,&quot;p&quot;:{&quot;lines&quot;:[76,77]},&quot;v&quot;:&quot;异步ajax&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:8,&quot;p&quot;:{&quot;lines&quot;:[77,78]},&quot;v&quot;:&quot;分页&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:8,&quot;p&quot;:{&quot;lines&quot;:[78,79]},&quot;v&quot;:&quot;长文章拆分&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:8,&quot;p&quot;:{&quot;lines&quot;:[79,80]},&quot;v&quot;:&quot;适当图片&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:8,&quot;p&quot;:{&quot;lines&quot;:[80,81]},&quot;v&quot;:&quot;适当特效&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:8,&quot;p&quot;:{&quot;lines&quot;:[81,82]},&quot;v&quot;:&quot;适当插件&quot;}]},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[82,83]},&quot;v&quot;:&quot;静态化技术&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[83,84]},&quot;v&quot;:&quot;AMP&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[84,85]},&quot;v&quot;:&quot;广告优化&quot;}]}]}],&quot;p&quot;:{}}"></svg></div><h2 id="性能优化">性能优化</h2><blockquote><p>浏览器渲染网页的过程可以参考这篇文章 <a href="/posts/656a0abb/">在浏览器输入 URL 回车之后发生了什么</a></p></blockquote><p>前端性能优化作为前端开发中的一项系统化工程，不仅仅是提升页面加载速度或减少资源大小，它涵盖了从网络请求、资源加载、代码执行到页面渲染等多个环节的优化策略，是一个复杂且系统化的工程。然而，在实际开发过程中，许多开发者往往只关注某些局部的优化点，如压缩图片、减少HTTP请求等，而缺乏对性能优化全局的把握。这种碎片化的优化方式虽然能在一定程度上提升性能，但往往难以达到最佳效果，甚至可能引入新的性能瓶颈。</p><p>因此，掌握前端性能优化的全局视角，理解各个环节的优化原理与实践方法，是每一位前端开发者必须面对的重要课题。本文将从性能优化的核心目标出发，探索性能优化的整个流程的核心关键节点以及其优化手段，帮助开发者建立起系统化的性能优化思维。</p><h3 id="整体流程">整体流程</h3><p>前端性能优化的核心目标是提升用户从<strong>输入 URL</strong> 到最终看到<strong>完整页面并与之交互的体验</strong>。这一过程可以概括为三个主要环节：<strong>从用户输入 URL 到资源加载完成</strong>、<strong>浏览器解析与渲染网页</strong>、<strong>JavaScript 脚本执行</strong>。每个环节都涉及不同的性能瓶颈和优化机会，只有系统性地分析并优化这些环节，才能真正提升前端性能。</p><h3 id="输入URl到请求结束的流程">输入URl到请求结束的流程</h3><p><img src="https://cimg1.17lai.site/data/2025/03/17/20250317220600.webp" width="3840" height="883" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload alt="输入URl到请求结束的流程"></p><ol><li><strong>输入URL</strong></li><li><strong>URL解析</strong></li><li><strong>DNS查询</strong></li><li><strong>建立TCP连接</strong></li><li><strong>发送HTTP请求</strong></li><li><strong>服务器处理请求</strong></li><li><strong>服务器返回响应</strong></li><li><strong>关闭连接</strong></li></ol><p>通过思维导图，再看看其中的详细过程</p><p><img src="https://cimg1.17lai.site/data/2025/03/17/20250317220542.webp" width="2946" height="1580" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload alt="浏览器输入URL到返回内容的流程"></p><div class="markmap-container" style="height:300px"><svg data="{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:2,&quot;p&quot;:{&quot;lines&quot;:[1,2]},&quot;v&quot;:&quot;性能优化&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[3,4]},&quot;v&quot;:&quot;网络请求&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[4,5]},&quot;v&quot;:&quot;页面渲染&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[5,6]},&quot;v&quot;:&quot;程序执行&quot;}]}"></svg></div><h3 id="网络请求优化">网络请求优化</h3><p>当用户在浏览器地址栏输入 URL 并按下回车键后，浏览器会经历一系列步骤，包括 DNS 解析、建立 TCP 连接、发送 HTTP 请求、等待服务器响应，以及最终将资源（如 HTML、CSS、JavaScript 等）下载到本地。</p><p>这一过程的核心是从用户发起请求到浏览器接收到完整的资源数据，其效率直接影响页面的首次加载时间（First Contentful Paint, FCP）。</p><p>优化这一环节的关键在于<code>减少网络延迟</code>、<code>压缩资源体积</code>、<code>利用缓存机制</code>以及<code>优化服务器响应</code>时间。把这些点总结一下可以分两个思路：<strong>网络链路加速</strong>和<strong>网络负载体积减少</strong></p><div class="markmap-container" style="height:400px"><svg data="{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:2,&quot;p&quot;:{&quot;lines&quot;:[1,2]},&quot;v&quot;:&quot;网络请求优化&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[3,4]},&quot;v&quot;:&quot;网络链路加速&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[4,5]},&quot;v&quot;:&quot;DNS预解析&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[5,6]},&quot;v&quot;:&quot;请求预链接&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[6,7]},&quot;v&quot;:&quot;缓存&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[7,8]},&quot;v&quot;:&quot;并发&quot;}]},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[8,9]},&quot;v&quot;:&quot;网络负载体积减少&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[9,10]},&quot;v&quot;:&quot;压缩&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:8,&quot;p&quot;:{&quot;lines&quot;:[10,11]},&quot;v&quot;:&quot;代码压缩&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:8,&quot;p&quot;:{&quot;lines&quot;:[11,12]},&quot;v&quot;:&quot;服务器压缩 br gzip&quot;}]},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[12,13]},&quot;v&quot;:&quot;拆包&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[13,14]},&quot;v&quot;:&quot;剪枝 tree-shaking&quot;}]}]}"></svg></div><h3 id="渲染优化">渲染优化</h3><p>当浏览器接收到 HTML、CSS、JavaScript 等资源后，会开始解析和渲染页面。这个过程包括构建 DOM 树、CSSOM 树、合并生成渲染树（Render Tree），以及进行布局（Layout）和绘制（Paint）。浏览器解析和渲染的效率直接影响页面的交互性和流畅度。</p><p>优化这一环节的关键在于<code>减少渲染阻塞资源</code>、<code>优化 CSS 和 HTML 结构</code>、<code>避免不必要的重排（Reflow）和重绘（Repaint）</code>以及GPU加速等。</p><div class="markmap-container" style="height:400px"><svg data="{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:2,&quot;p&quot;:{&quot;lines&quot;:[1,2]},&quot;v&quot;:&quot;渲染优化&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[3,4]},&quot;v&quot;:&quot;减少资源阻塞&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[4,5]},&quot;v&quot;:&quot;优化 CSS, HTML 结构&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[5,6]},&quot;v&quot;:&quot;减少重排，重绘&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[6,7]},&quot;v&quot;:&quot;GPU 加速&quot;}]}"></svg></div><h3 id="JS-执行优化"><strong>JS 执行优化</strong></h3><p>JavaScript 是前端交互的核心，但它的执行效率直接影响页面的响应速度和用户体验。JavaScript 的解析、编译和执行可能会阻塞主线程，导致页面卡顿或无响应。</p><p>优化这一环节的关键在于 <strong>减少 JavaScript 文件大小</strong>、<strong>避免长任务（Long Tasks）</strong>、<strong>优化代码执行效率</strong>，以及合理使用 <strong>Web Workers</strong> 等技术来分担主线程的压力。以下是几种常见的优化方法：</p><hr><h4 id="使用-async-和-defer-加载脚本"><strong>使用 <code>async</code> 和 <code>defer</code> 加载脚本</strong></h4><p>JavaScript 默认是 <strong>同步加载并执行</strong> 的，会阻塞 HTML 解析，因此对于外部脚本文件，推荐使用 <code>async</code> 或 <code>defer</code> 来优化加载策略。</p><table><thead><tr><th><strong>属性</strong></th><th><strong>执行顺序</strong></th><th><strong>是否阻塞 HTML 解析</strong></th><th><strong>适用场景</strong></th></tr></thead><tbody><tr><td><code>async</code></td><td><strong>下载完立即执行</strong>，多个 <code>async</code> 脚本执行顺序不固定</td><td>否</td><td><strong>独立脚本，不依赖其他脚本</strong>（如广告、统计代码）</td></tr><tr><td><code>defer</code></td><td><strong>HTML 解析完后按顺序执行</strong></td><td>否</td><td><strong>依赖 HTML 结构或其他脚本</strong>（如主逻辑 JS 文件）</td></tr></tbody></table><p>✅ <strong>示例</strong></p><figure><div class="code-area"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">&lt;!-- async：适用于无依赖的独立脚本 --&gt;
&lt;script async src="analytics.js"&gt;&lt;/script&gt;

&lt;!-- defer：适用于依赖 HTML 结构的脚本（推荐）--&gt;
&lt;script defer src="main.js"&gt;&lt;/script&gt;</code></pre></div></figure><hr><h4 id="代码拆分-按需加载"><strong>代码拆分 &amp; 按需加载</strong></h4><p>加载过多的 JavaScript 会拖慢页面速度，因此可以使用 <strong>代码拆分</strong>（Code Splitting）和 <strong>按需加载</strong>（Lazy Loading）减少主线程压力。</p><p>✅ <strong>示例：使用 <code>import()</code> 进行动态加载</strong></p><figure><div class="code-area"><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">document.getElementById('loadFeature').addEventListener('click', async () =&gt; {
  const { featureFunction } = await import('./featureModule.js');
  featureFunction();
});</code></pre></div></figure><ul><li>只有用户点击按钮时才会加载 <code>featureModule.js</code>，减少初始加载时间。</li></ul><hr><h4 id="避免长任务（Long-Tasks）"><strong>避免长任务（Long Tasks）</strong></h4><p><strong>长任务</strong>（执行时间超过 50ms 的任务）会导致页面卡顿，影响交互流畅性。可以使用 <strong><code>requestIdleCallback</code></strong> 或 <strong><code>setTimeout</code></strong> 将任务拆分成多个小块执行。</p><p>✅ <strong>示例：使用 <code>requestIdleCallback</code> 让低优先级任务在空闲时间执行</strong></p><figure><div class="code-area"><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">requestIdleCallback(() =&gt; {
  heavyTask(); // 仅在浏览器空闲时执行
});</code></pre></div></figure><p>✅ <strong>示例：使用 <code>setTimeout</code> 让任务拆分执行</strong></p><figure><div class="code-area"><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">function processLargeArray(arr) {
  let i = 0;
  function nextChunk() {
    const start = performance.now();
    while (i &lt; arr.length &amp;&amp; performance.now() - start &lt; 50) {
      processItem(arr[i]);
      i++;
    }
    if (i &lt; arr.length) {
      setTimeout(nextChunk, 0);
    }
  }
  nextChunk();
}</code></pre></div></figure><ul><li><strong>每次执行 50ms</strong>，避免长时间阻塞主线程，提高页面流畅度。</li></ul><hr><h4 id="使用-Web-Workers-进行多线程计算"><strong>使用 Web Workers 进行多线程计算</strong></h4><p>JavaScript 运行在 <strong>单线程环境</strong> 下，繁重的计算任务会导致页面卡顿。可以使用 <strong>Web Workers</strong> 将计算任务放到后台线程运行。</p><p>✅ <strong>示例：使用 Web Worker</strong> <strong><code>worker.js</code></strong></p><figure><div class="code-area"><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">self.onmessage = function (event) {
  const result = heavyComputation(event.data);
  self.postMessage(result);
};</code></pre></div></figure><p><strong>主线程</strong></p><figure><div class="code-area"><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">const worker = new Worker('worker.js');
worker.postMessage(largeData);

worker.onmessage = function (event) {
  console.log('计算结果:', event.data);
};</code></pre></div></figure><ul><li><strong>计算任务在后台线程执行</strong>，主线程不会被阻塞，提高页面响应速度。</li></ul><hr><h4 id="其他优化技巧"><strong>其他优化技巧</strong></h4><p>✅ <strong>减少 JavaScript 体积</strong></p><ul><li>使用 <strong>Tree Shaking</strong> 移除无用代码（适用于 ES6 <code>import</code>/<code>export</code>）</li><li>启用 <strong>gzip、Brotli</strong> 压缩（<code>Content-Encoding: gzip</code>）</li><li>使用 <strong>CDN 加速</strong> 静态资源加载</li></ul><p>✅ <strong>优化 DOM 操作</strong></p><ul><li><p><strong>减少回流（Reflow）和重绘（Repaint）</strong></p></li><li><p>使用</p><p><code>documentFragment</code></p><p>进行批量 DOM 插入：</p><figure><div class="code-area"><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">const fragment = document.createDocumentFragment();
for (let i = 0; i &lt; 1000; i++) {
  const div = document.createElement('div');
  div.textContent = `Item ${i}`;
  fragment.appendChild(div);
}
document.body.appendChild(fragment);</code></pre></div></figure></li></ul><p>✅ <strong>使用 <code>requestAnimationFrame()</code> 提高动画流畅度</strong></p><figure><div class="code-area"><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">function smoothScroll() {
  requestAnimationFrame(smoothScroll);
}
smoothScroll();</code></pre></div></figure><hr><h4 id="总结"><strong>总结</strong></h4><table><thead><tr><th><strong>优化方法</strong></th><th><strong>关键点</strong></th></tr></thead><tbody><tr><td><code>async</code> &amp; <code>defer</code></td><td><code>async</code> 适用于无依赖脚本，<code>defer</code> 适用于依赖 HTML 的脚本</td></tr><tr><td>代码拆分 &amp; 按需加载</td><td>仅在需要时加载 JavaScript</td></tr><tr><td>避免长任务</td><td>使用 <code>requestIdleCallback</code> 或 <code>setTimeout</code> 拆分任务</td></tr><tr><td>Web Workers</td><td>将 CPU 密集型任务放到后台线程</td></tr><tr><td>压缩 JavaScript</td><td>使用 Tree Shaking、Gzip/Brotli 压缩</td></tr><tr><td>优化 DOM 操作</td><td>减少回流 &amp; 使用 <code>documentFragment</code></td></tr></tbody></table><p>合理使用这些技术，可以有效提升 JavaScript 执行效率，提高页面流畅度 🚀</p><div class="markmap-container" style="height:400px"><svg data="{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:2,&quot;p&quot;:{&quot;lines&quot;:[1,2]},&quot;v&quot;:&quot;JS 执行优化&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[3,4]},&quot;v&quot;:&quot;减少代码体积&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[4,5]},&quot;v&quot;:&quot;拆分长任务&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[5,6]},&quot;v&quot;:&quot;代码效率优化&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[6,7]},&quot;v&quot;:&quot;提高执行效率&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[7,8]},&quot;v&quot;:&quot;web worker&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[8,9]},&quot;v&quot;:&quot;webassembly&quot;}]}]}"></svg></div><h3 id="网络链路优化">网络链路优化</h3><h4 id="DNS-预解析-–-dns-prefetch">DNS 预解析 – dns-prefetch</h4><p>通过在页面加载初期就解析可能需要的域名，当实际需要加载这些域名的资源时，DNS 解析已经完成，从而加快资源的加载速度。这个标签对于 CDN 域名等非主域名提前解析 CDN ，有很大的帮助，强烈建议添加。</p><p><code>dns-prefetch</code> 可以通过 <code>&lt;link&gt;</code> 标签在 HTML 中声明，或者通过 HTTP 头部进行配置。</p><figure><div class="code-area"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">&lt;head&gt;
  &lt;link rel="dns-prefetch" href="https://blog.17lai.site"&gt;
&lt;/head&gt;</code></pre></div></figure><h4 id="HTTP-预连接-–-preconnect">HTTP 预连接 – preconnect</h4><p><code>preconnect</code> 用于提前建立与目标域名的连接，包括 DNS 解析、TCP 握手和 TLS 协商。这比 <code>dns-prefetch</code> 更全面，适用于需要更早建立连接的场景。</p><p>使用方法和 <code>dns-prefetch</code> 类似</p><figure><div class="code-area"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">&lt;head&gt;
  &lt;link rel="preconnect" href="https://blog.17lai.site" crossorigin&gt;
&lt;head&gt;</code></pre></div></figure><h4 id="内容预加载-–-prefetch">内容预加载 – prefetch</h4><p><code>prefetch</code> 是一种资源提示，它告诉浏览器在空闲时间提前下载并缓存将来可能需要的资源。这可以显著减少用户请求这些资源时的等待时间，从而提高用户体验。</p><p><strong>使用场景</strong>：</p><ul><li>当您预测用户可能会导航到另一个页面或执行某个操作时，可以提前预加载该页面或操作所需的资源。</li><li>对于单页应用（SPA），预加载用户可能访问的下一个视图或组件可以显著提高性能。</li></ul><p><strong>使用方法</strong>：</p><figure><div class="code-area"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">&lt;head&gt;
  &lt;!-- 预加载整个页面 --&gt;
  &lt;link rel="prefetch" href="next-page.html"&gt;

  &lt;!-- 预加载特定资源，如图片、脚本或样式表 --&gt;
  &lt;link rel="prefetch" href="image.png" as="image"&gt;
  &lt;link rel="prefetch" href="script.js" as="script"&gt;
  &lt;link rel="prefetch" href="styles.css" as="style"&gt;
&lt;/head&gt;</code></pre></div></figure><p><strong>注意事项</strong>：</p><ul><li>不要过度使用 <code>prefetch</code>，因为它可能会浪费带宽和资源，特别是当预加载的资源最终未被使用时。</li></ul><h4 id="优先加载-–-preload">优先加载 – preload</h4><p><code>preload</code> 是一种更强大的资源提示，它告诉浏览器立即请求并缓存特定资源，以便在需要时立即使用。与 <code>prefetch</code> 不同，<code>preload</code> 更侧重于当前页面渲染所需的资源，而不是将来可能需要的资源。</p><p><strong>使用场景</strong>：</p><ul><li>当您知道某个资源对当前页面的渲染至关重要，并且希望确保它在需要时立即可用时，可以使用 <code>preload</code>。</li><li>对于关键路径上的资源，如关键的 CSS、JavaScript 或字体文件，<code>preload</code> 可以显著提高页面加载性能。</li></ul><p><strong>使用方法</strong>：</p><figure><div class="code-area"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">&lt;head&gt;
  &lt;!-- 立即加载 CSS --&gt;
  &lt;link rel="preload" href="styles.css" as="style"&gt;
  &lt;link rel="stylesheet" href="styles.css"&gt;

  &lt;!-- 立即加载 JavaScript --&gt;
  &lt;link rel="preload" href="main.js" as="script"&gt;
  &lt;script src="main.js"&gt;&lt;/script&gt;

  &lt;!-- 立即加载 --&gt;
  &lt;link rel="preload" href="font.woff2" as="font" type="font/woff2" crossorigin&gt;
&lt;/head&gt;</code></pre></div></figure><p><strong>注意事项</strong>：</p><ul><li><code>preload</code> 的资源会被浏览器优先加载，这可能会影响其他资源的加载顺序和性能。</li></ul><p>以上四种优化方式我们同程为 <code>resource hints</code></p><p><img src="https://cimg1.17lai.site/data/2025/03/17/20250317221825.webp" width="2390" height="948" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload alt="Resource Hints 优化"></p><h4 id="资源缓存">资源缓存</h4><p>通过http的缓存能力，将资源缓存到浏览器端，可以直接从浏览器拿取内容，不经过服务器，或者经过浏览器，浏览器返回 304，告诉浏览器直接使用缓存，不用下载。</p><p>缓存常用的 http header 包括，cach-control 和 expire 。这里内容较多，暂不展开，之后详细介绍</p><h4 id="升级-HTTP-协议">升级 HTTP 协议</h4><p>HTTP 协议，主要包括HTTP/1.1、HTTP/2和HTTP/3。高版本在性能、安全性和功能上进行了优化和改进。能使用高版本，尽量使用高版本，同时做好兼容性配置。下面是几个版本的核心能力</p><table><thead><tr><th>HTTP 版本号</th><th>核心功能</th></tr></thead><tbody><tr><td>HTTP/1.1</td><td>引入持久连接和管道化，提升了连接复用和传输效率，但存在队头阻塞问题</td></tr><tr><td>HTTP/2</td><td>采用二进制协议和多路复用，消除了队头阻塞，引入头部压缩和服务器推送，显著提升了性能和效率。</td></tr><tr><td>HTTP/3</td><td>基于QUIC协议，进一步优化了连接建立速度、传输效率和安全性，解决了TCP的一些固有问题，提供了更好的用户体验。</td></tr></tbody></table><h3 id="减少网络负载">减少网络负载</h3><h4 id="网络传输协议压缩">网络传输协议压缩</h4><h5 id="开启-gzip-和-Brotli-压缩">开启 gzip 和 Brotli 压缩</h5><p>在服务端放置 gzip 压缩后的文件，开启 gzip 之后，可以直接发送 gzip 文件，浏览器端会自动解析 gzip。</p><p>Brotli 和 gzip 一样的压缩策略，只不过压缩比更高，后来居上，但是兼容性不好，使用 brotli 需要考虑兼容性</p><h4 id="资源内容压缩">资源内容压缩</h4><h5 id="JS-和-CSS-压缩">JS 和 CSS 压缩</h5><p>通过打包工具，去掉注释，空格，各种名称精简等方式，将 js 和 CSS 压缩到更小的体积，</p><h4 id="图片压缩">图片压缩</h4><p>图片大小优化有两个方向：</p><ol><li>通过压缩算法，将图片压缩到更小的体积，常用的网站如：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://tinify.cn/">https://tinify.cn/</a></li><li>转换图片格式，获得更小的体积。比如 jpg 转 png，png 转 webp等，webp 有更小的体积，但要考虑兼容性问题。</li></ol><h4 id="利用-tree-shaking">利用 tree shaking</h4><p>使用第三方库时，经常会将所有代码引入进来，但是只用到其中的很少的功能。因此，通过打包工具，开启tree shaking，可以有效减少生成代码的体积。</p><p>开始tree shaking 的优化</p><h4 id="代码拆分">代码拆分</h4><p>不同页面有不同的功能，代码逻辑不同。因此，在加载首页时，非必要的内容就不要加载，减少首次加载的资源的体积。</p><h2 id="网站测速工具">网站测速工具</h2><p>网站打开速度已经成为 SEO 重要的排名依据，除了上面说到的<strong>人肉测试</strong>，就<strong>面向国内用户 + 加载速度测试</strong>场景而言，推荐以下三款工具：</p><div class="tag-common tabs" id="测速工具"><ul class="nav-tabs"><li class="tab active"><a data-target="测速工具-1">站长工具</a></li><li class="tab"><a data-target="测速工具-2">IPIP.NET TraceRoute 查询</a></li><li class="tab"><a data-target="测速工具-3">Pingdom Website Speed Test</a></li></ul><div class="tab-content"><div class="tab-pane active" id="测速工具-1"><p><strong>站长工具 网站速度测试</strong></p><p>针对国内资源加载、网站速度测试。包括 Ping 检测、国内外多监测点网速测试、网站速度对比、DNS 查询和路由跟踪等工具。</p><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://tool.chinaz.com/sitespeed">点击打开</a></p></div><div class="tab-pane" id="测速工具-2"><p><strong><a target="_blank" rel="noopener external nofollow noreferrer" href="http://IPIP.NET">IPIP.NET</a> TraceRoute 查询</strong></p><p><a target="_blank" rel="noopener external nofollow noreferrer" href="http://IPIP.NET">IPIP.NET</a> 是一家专注 IP 地理位置以及 IP 画像数据的研究、整理与发行的数据公司，提供 TraceRoute 等一系列 IP 相关的在线工具。<br>使用 Trace 的方式可以查看用户到站点的路由信息，一般来说跳数越少打开速度越快，选择 <a target="_blank" rel="noopener external nofollow noreferrer" href="http://IPIP.NET">IPIP.NET</a> 是因为其 TraceRoute 提供了可视化的效果，一眼看清问题所在。</p><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://tools.ipip.net/traceroute.php">点击打开</a></p></div><div class="tab-pane" id="测速工具-3"><p><strong>Pingdom Website Speed Test</strong></p><p>知名的网站测速工具，相比 Google PageSpeed Insights 不能指定测速节点，它可以指定从全球数个节点发起测试请求，更贴近你的用户群体。</p><p>亚洲这边只有东京区域，四舍五入一下我选择东京区域来测试好了。</p><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://tools.pingdom.com/">点击打开</a></p></div></div></div><p>其它还有</p><ul><li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.itdog.cn/http/">https://www.itdog.cn/http/</a></li><li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://tool.chinaz.com/speedtest/">https://tool.chinaz.com/speedtest/</a></li><li>网络测速 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.speedtest.net/">https://www.speedtest.net/</a></li></ul><p><img src="https://cimg1.17lai.site/data/2022/08/16/20220816203057.webp" width="1856" height="1100" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload alt="itdog测速"></p><h2 id="加载速度评估">加载速度评估</h2><blockquote><p>要想优化加载速度，我们首先要通过一些方法量化分析网站加载速度，这样才能更好的对加载速度进行优化。以下是常用的一些分析网站加载速度的工具。</p></blockquote><h3 id="Google-PageSpeed-Insights">Google PageSpeed Insights</h3><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://pagespeed.web.dev/">https://pagespeed.web.dev/</a></p><p>PageSpeed是检测网站加载速度很重要的工具，它可以给予我们非常详细的优化点，从中可以发现拖慢网站的元凶。</p><p><img src="https://cimg1.17lai.site/data/2022/08/16/20220816203443.webp" width="1879" height="1086" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload alt="PageSpeed Insights"></p><h3 id="移动设备适合性测试">移动设备适合性测试</h3><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://search.google.com/test/mobile-friendly?hl=zh_CN">https://search.google.com/test/mobile-friendly?hl=zh_CN</a></p><p><img src="https://cimg1.17lai.site/data/2022/12/03/20221203152351.webp" width="1751" height="1149" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload alt="mobile-friendly"></p><h3 id="experte-pagespeed">experte pagespeed</h3><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.experte.com/pagespeed">https://www.experte.com/pagespeed</a> 一次自动化测试多个网页评分<br><img src="https://cimg1.17lai.site/data/2023/03/14/20230314060200-3.webp" width="1514" height="1099" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload alt="pagespeed"></p><h3 id="Chrome-Audits-Lighthouse">Chrome Audits(Lighthouse)</h3><blockquote><p>现代浏览器都自带性能测试工具，例如 Chrome, firefox，打开网页， 按 F12 键即可调出测试工具！</p></blockquote><p><img src="https://cimg1.17lai.site/data/2023/03/14/20230314060200-4.webp" width="2556" height="1240" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload alt="Lighthouse"></p><p>Chrome浏览器自带的Audits除了能让我们查看网站的加载速度，还可以查看网站最佳实践、可用性、SEO及PWA方面的评分及改进点。如果你的网站在这几方面评分都超过90分，那一定是Google在这几方面很喜欢的网站了。</p><h3 id="webpagetest"><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.webpagetest.org/">webpagetest</a></h3><p><img src="https://cimg1.17lai.site/data/2022/08/15/20220815192950.webp" width="1883" height="1079" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload alt="webpagetest"></p><p>webpagetest是<strong>非常强大</strong>的测试网站加载速度并深入分析网站资源加载速度的工具，还可以测试网站在不加载（屏蔽）某些资源的情况下网站加载速度与正常加载的对比，这样可以发现让网站加载速度变慢的资源或库。</p><h3 id="用户反馈">用户反馈</h3><p>有时候不同地区的加载速度是不同的，更麻烦的是你很难知道当地的网络情况，这时候就需要用户的反馈了。</p><h2 id="加载速度优化概要-2">加载速度优化概要</h2><h3 id="图片优化">图片优化</h3><h4 id="图片大小优化">图片大小优化</h4><p>优化图片大小非常重要，网站资源大头一般都是图片，图片太大会导致加载速度很慢，在手机端也很耗费用户的流量。一般可以通过对图片大小进行裁剪，对图片格式进行转换这些方式来降低图片大小。</p><p>有多种实现方法</p><figure><div class="code-area"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">&lt;img src="original.jpg"
     srcset="thumbnail.jpg"
     data-srcset="original.jpg"&gt;</code></pre></div></figure><p>虽然 <code>&lt;img&gt;</code>标签定义了 <code>src</code>属性，但是由于有 <code>srcset</code>属性，所以现代浏览器会优先使用 <code>srcset</code>的属性加载缩略图 <code>thumbnail.jpg</code> （如果愿意，你也可以使用空白小图 <code>blank.gif</code>）。同时负责 <code>lazyload</code>的 JS 会在页面滚动的时候将 <code>data-srcset</code>属性赋值给 <code>srcset</code> 展示原图。而在不支持 <code>srcset</code>的老旧浏览器或者 <code>RSS</code>阅读器上<code>srcset</code>属性都会被忽略、直接读取 <code>src</code>加载图片。</p><p>使用 <code>srcset</code>属性的好处还有更多，比如对响应式设计友好、支持 <code>WebP</code>图片及其 <code>Fallback</code>、对那些 curl 爬虫也很友好。 <code>srcset</code>这个属性的关键之处在于它的优先级比 <code>src</code>属性要高，这就是为什么我们可以在不对 <code>src</code>属性动刀的前提下还可以做到不立刻加载原图。</p><p>另一个实现方法 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/hexojs/hexo-filter-lqip">hexo-filter-lqip</a></p><h4 id="图片懒加载">图片懒加载</h4><p>例如这个插件，<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/Troy-Yang/hexo-lazyload-image">hexo-lazyload-image</a>，可以极大提高首次显示时间</p><h3 id="前端资源优化">前端资源优化</h3><p>网站的前端资源越来越大了，尤其是当你使用了很多第三方库的时候。</p><blockquote><p>用库一时爽，优化火葬场！</p></blockquote><p>如果想极大的提高网站加载速度，尽可能使用少的第三方库。</p><h4 id="JS和CSS优化">JS和CSS优化</h4><p>通过压缩，去除不需要的代码减小前端资源文件大小。</p><h4 id="第三方库优化">第三方库优化</h4><p>在这篇<a target="_blank" rel="noopener external nofollow noreferrer" href="https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/loading-third-party-javascript/">《Loading Third-Party JavaScript》</a>中提到了如何正确加载第三方包，通过分析第三方包的加载时序图来判断对加载速度影响最大的几个因素，从而帮助你优化第三方包的加载。</p><h3 id="内容结构优化">内容结构优化</h3><h4 id="加载更多">加载更多</h4><p>一般对于瀑布流布局的网站，通过加载更多来降低每页返回的页面大小。不过这种方式对爬虫并不算友好，只有第一个页面可以被爬取到。</p><h4 id="分页">分页</h4><p>常规网站一般通过分页来控制每页返回的页面大小。分页页面通过设置唯一的 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://support.google.com/webmasters/answer/139066?hl=zh-Hans">canonical url</a> 可以让爬虫更好的爬取到分页页面。</p><h3 id="CDN">CDN</h3><p>本站使用了免费的 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.netlify.com/">netlify</a> 作为CDN来提高网站在不同地区的加载速度，CDN通过边缘服务器缓存来提高用户请求网页的速度，一般的CDN都会设置某个失效时间后自动去源站拉取最新的内容缓存到边缘服务器。</p><p>你也可以选择诸如 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://aws.amazon.com/cn/cloudfront/">Amazon CloudFront</a> 与 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.cloudflare.com/">cloudflare</a> 这类CDN。还有一些特殊的比如具备反爬虫的CDN，如imperva收购的 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.imperva.com/products/bot-management/">distilnetworks</a> 就是很厉害的反爬虫CDN。</p><h3 id="静态化技术">静态化技术</h3><p>动态网站一般需要做一些查询数据库和页面渲染的额外工作，为了提高网站响应速度，一些框架可以自动生成静态化页面部署到CDN中来提高网站响应速度。比如本站使用了基于 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://gohugo.io/">Hugo</a> 的静态化技术框架，类似的还有 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io/">Hexo</a>，这类技术都属于 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://jamstack.org/">JAMSTACK</a>，还有新型的 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.gatsbyjs.org/">gatsbyjs</a> 技术让我们更容易开发出更快的网站。</p><h3 id="AMP"><a target="_blank" rel="noopener external nofollow noreferrer" href="https://amp.dev/">AMP</a></h3><p>AMP是Google推出的Web组件框架，可以加速移动端的访问速度，比如你可以看看<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.bmpi.dev/amp/dev/guide-to-setup-blog-site-with-zero-cost-4/">本篇文章的AMP</a>版本页面，在移动端访问速度是非常快的。</p><h3 id="广告优化">广告优化</h3><p>使用webpagetest研究本站前端资源的加载速度，最终发现让网站变慢的是Google Adsense广告资源。</p><p>通过将广告延迟5秒展示加载的方式来提高页面访问速度，具体代码见 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/bmpi-dev/bmpi.dev/commit/a98beba8e14a4a75884c3ecfa3b9037469caae67">seo improve by delay google ads load</a>，此举将网站加载速度评分提升至90+了。但是测试后发现这种延迟广告展示的方式会降低广告收入😂。</p><h3 id="总结-2">总结</h3><p>在SEO技术性优化中，提升加载速度是很重要的一个方面，我们需要使用多种手段去降低页面返回的大小来提升网站的加载速度。而且在设计、开发与运营网站的全流程中，加载速度始终是各个环节都需要考虑的问题。</p><h2 id="加速NPM安装下载">加速NPM安装下载</h2><p><strong>安装淘宝镜像</strong></p><figure><div class="code-area"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">npm config set registry https://registry.npm.taobao.org</code></pre></div></figure><p><strong>安装CNPM</strong></p><figure><div class="code-area"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">npm install -g cnpm --registry=https://registry.npm.taobao.org</code></pre></div></figure><h2 id="测试您的网络状况">测试您的网络状况</h2><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://ip.skk.moe/simple">Network Test</a></p><iframe src="https://ip.skk.moe/simple" style="width:100%;border:0" loading="lazy"></iframe><h2 id="DNS优化">DNS优化</h2><ul><li>多节点部署，多线路DNS配置</li><li>少用cname</li><li>双上联负载均衡</li></ul><h2 id="CDN-加速">CDN 加速</h2><ul><li><strong>为什么强烈建议启用CDN？</strong></li></ul><blockquote><p>研究表明，用户最满意的打开网页时间，是在 2 秒以下。用户能够忍受的最长等待时间在 6～8 秒之间。就是说，8 秒是一个临界值，如果你的网站打开速度在 8 秒以上，那么你将失去大部分用户。研究显示，如果等待 12 秒以后，网页还是没有载入，那么 99% 以上的用户会选择关闭网页。</p><p>Google 做过一个试验，10 条搜索结果的页面载入时间需要 0.4 秒，显示 30 条搜索结果的页面载入时间需要 0.9 秒，结果后者使得 Google 总的流量和收入减少了 20%。Google 地图上线的时候，首页大小有 100KB，后来下降到 70~80KB。结果，流量在第一个星期上升了 10%，接下来的 3 个星期又再上升了 25%。Amazon 的统计也显示了相近的结果，首页打开时间每增加 100 毫秒，网站销售量会减少 1%。</p><p>以上数据说明了一个非常重要的问题，如果你的网站速度如果超过 2s 以上，那么你的客户可能在流失和离你而去了。这一点对于电商网站尤其重要，打开速度慢，那么将造成转化率降低，损失将会大量增加。</p></blockquote><p>放在 Github 的资源在国内加载速度比较慢，因此需要使用 CDN 加速来优化网站打开速度，<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.jsdelivr.com/">jsDelivr</a> + Github 便是免费且好用的 CDN，非常适合博客网站使用。也可以选择主流云服务商提供的对象存储+CDN 来获得更快速及稳定的访问效果，费用低到几乎可忽略。</p><p><strong>用法：</strong></p><figure><div class="code-area"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">https://cdn.jsdelivr.net/gh/{你的用户名}/{你的仓库名}@{发布的版本号}/{文件路径}</code></pre></div></figure><p><strong>例如：</strong></p><figure><div class="code-area"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">https://cdn.jsdelivr.net/gh/appotry/cloudimg@latest/data/2022/03/1120220311110247.webp</code></pre></div></figure><p>注意：版本号不是必需的，是为了区分新旧资源，如果不使用版本号，将会直接引用最新资源。</p><blockquote><p>还可以配合 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/Molunerfinn/PicGo">PicGo</a>图床上传工具的<strong>自定义域名前缀</strong>来上传图片，使用极其方便。具体使用方法可参见这篇文章: <a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.lixl.cn/2019/120114500.html">使用 Typora+iPic/PicGo 图床+CDN 实现高效 Markdown 创作</a></p></blockquote><h3 id="jsdelivr">jsdelivr</h3><p>jsdelivr 是还在目前还在国内运营的可以通过特殊方法免费使用的CDN。</p><blockquote><p>Github<mark>开源</mark>仓库发<mark>布版</mark>本才能使用jsdelivr，懂了怎么做了吧。</p></blockquote><figure><div class="code-area"><pre class="line-numbers language-none"><code class="language-none">https://cdn.jsdelivr.net/gh/[name]/[repo]@latest/data/2022/03/1120220311110247.webp</code></pre></div></figure><h3 id="Cloudflare-CDN">Cloudflare CDN</h3><blockquote><p>配置最简单的CDN方式了。在github raw链接地址前面加<code>https://images.weserv.nl/?url=</code>, 就会自动使用cloudflare cdn来加速图片访问。使用发现无法加速gif。</p></blockquote><p>本blog主要使用这个方法，如下所示。</p><ul><li>未加速图片地址</li></ul><figure><div class="code-area"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">https://raw.githubusercontent.com/appotry/cloudimg/main/data/2021/09/1020210910231815.png</code></pre></div></figure><ul><li>Cloudflare加速图片地址</li></ul><figure><div class="code-area"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"># 使用了cloudflare partner 加速
https://cimg1.17lai.site/data/2021/09/1020210910231815.png</code></pre></div></figure><h2 id="配置Service-worker">配置Service worker</h2><blockquote><p>后篇文章<a href="/posts/4a2050e2/">基于Hexo的matery主题搭建博客个性定制篇5</a>中提到的 <strong>让hexo支持pwa</strong> 就是使用的<code>Service worker</code> ，参考个性定制篇，把常用的大体积文件加入<code>Service worker</code> 缓存列表，可以极大的提高访问速度！</p><p><strong>原理</strong>：在访问时，后台异步加载 SW 缓存文件列表，后面渲染网页，直接使用缓存中的文件，不再从网络中获取。你可以提前把所有常用的大体积资源放到缓存列表中，后面访问其它页面时，很多资源已经提前加载好了，可以极大的提高访问速度！</p></blockquote><h2 id="SEO-优化">SEO 优化</h2><div class="markmap-container" style="height:950px"><svg data="{&quot;t&quot;:&quot;root&quot;,&quot;d&quot;:0,&quot;v&quot;:&quot;&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:2,&quot;p&quot;:{&quot;lines&quot;:[0,1]},&quot;v&quot;:&quot;现状研究&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[1,2]},&quot;v&quot;:&quot;域名研究&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[2,3]},&quot;v&quot;:&quot;是否有黑历史&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[3,4]},&quot;v&quot;:&quot;老域名301跳转&quot;}]},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[4,5]},&quot;v&quot;:&quot;流量来源研究&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[5,6]},&quot;v&quot;:&quot;直接流量&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[6,7]},&quot;v&quot;:&quot;搜索流量&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[7,8]},&quot;v&quot;:&quot;引荐流量&quot;}]},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[8,9]},&quot;v&quot;:&quot;索引研究&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[9,10]},&quot;v&quot;:&quot;内容好&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[10,11]},&quot;v&quot;:&quot;关键字密度适中&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[11,12]},&quot;v&quot;:&quot;访问速度快&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[12,13]},&quot;v&quot;:&quot;sitemap&quot;}]},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[13,14]},&quot;v&quot;:&quot;关键词研究&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[14,15]},&quot;v&quot;:&quot;Google Keyword plan&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[15,16]},&quot;v&quot;:&quot;<a href=\&quot;search.google.com/search-console\&quot;>google search console</a>&quot;}]},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[16,17]},&quot;v&quot;:&quot;竞品研究&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[17,18]},&quot;v&quot;:&quot;内容研究&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[18,19]},&quot;v&quot;:&quot;反向链接研究&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[19,20]},&quot;v&quot;:&quot;<a href=\&quot;https://chrome.google.com/webstore/detail/seoquake/akdgnmcogleenhbclghghlkkdndkjdjc/\&quot;>SEOquake</a>&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[20,21]},&quot;v&quot;:&quot;<a href=\&quot;search.google.com/search-console\&quot;>google search console</a>&quot;}]}]},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:2,&quot;p&quot;:{&quot;lines&quot;:[21,22]},&quot;v&quot;:&quot;优化&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[22,23]},&quot;v&quot;:&quot;博客搭建框架优化对比&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[23,24]},&quot;v&quot;:&quot;站内优化&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[24,25]},&quot;v&quot;:&quot;meta&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[25,26]},&quot;v&quot;:&quot;<a href=\&quot;https://www.omiod.com/meta-seo-inspector/\&quot;>meta seo inspector</a>&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[26,27]},&quot;v&quot;:&quot;<a href=\&quot;https://chrome.google.com/webstore/detail/seo-minion/giihipjfimkajhlcilipnjeohabimjhi\&quot;>SEO Minion</a>&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[27,28]},&quot;v&quot;:&quot;关键字&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[28,29]},&quot;v&quot;:&quot;关键字挖掘&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:8,&quot;p&quot;:{&quot;lines&quot;:[29,30]},&quot;v&quot;:&quot;google 搜索排名&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:8,&quot;p&quot;:{&quot;lines&quot;:[30,31]},&quot;v&quot;:&quot;google搜索建议&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:8,&quot;p&quot;:{&quot;lines&quot;:[31,32]},&quot;v&quot;:&quot;data.chinaz.com&quot;}]}]},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[32,33]},&quot;v&quot;:&quot;技术性优化&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[33,34]},&quot;v&quot;:&quot;加载速度&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[34,35]},&quot;v&quot;:&quot;图片优化&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[35,36]},&quot;v&quot;:&quot;rebot.txt&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[36,37]},&quot;v&quot;:&quot;sitemap.xml&quot;}]},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[37,38]},&quot;v&quot;:&quot;内容优化&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[38,39]},&quot;v&quot;:&quot;网站定位&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[39,40]},&quot;v&quot;:&quot;关键伙伴 代理平台，广告平台&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[40,41]},&quot;v&quot;:&quot;搭建网站&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[41,42]},&quot;v&quot;:&quot;写手招聘与管理&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[42,43]},&quot;v&quot;:&quot;读者关系维护 聚会 群 留言 email&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[43,44]},&quot;v&quot;:&quot;支出与收入&quot;}]},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[44,45]},&quot;v&quot;:&quot;站外优化&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[45,46]},&quot;v&quot;:&quot;其他平台导流&quot;,&quot;c&quot;:[{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:8,&quot;p&quot;:{&quot;lines&quot;:[46,47]},&quot;v&quot;:&quot;各大社区同步发送&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:8,&quot;p&quot;:{&quot;lines&quot;:[47,48]},&quot;v&quot;:&quot;国外社区论坛&quot;}]},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[48,49]},&quot;v&quot;:&quot;友情链接&quot;},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:6,&quot;p&quot;:{&quot;lines&quot;:[49,50]},&quot;v&quot;:&quot;社交分享&quot;}]},{&quot;t&quot;:&quot;list_item&quot;,&quot;d&quot;:4,&quot;p&quot;:{&quot;lines&quot;:[50,51]},&quot;v&quot;:&quot;内链优化&quot;}]}],&quot;p&quot;:{}}"></svg></div><blockquote><ul><li><p>搜索引擎优化，又称为 SEO，即 Search Engine Optimization，它是一种通过分析搜索引擎的排名规律，了解各种搜索引擎怎样进行搜索、怎样抓取互联网页面、怎样确定特定关键词的搜索结果排名的技术。Google 自动收录效果还不错，百度就差得远了（<code>GitHub</code>不允许百度的<code>Spider</code>爬取<code>GitHub</code>上的内容）。</p></li><li><p>如果<mark>没有备案，百度seo是不会收录的</mark>！所以如果你有国内vps，并且备案了，可以做百度seo，如果没有，百度seo内容都不需要看了。</p></li></ul></blockquote><h3 id="网域提交方式">网域提交方式</h3><ol><li><p>自动提交</p><p>（分三种）</p><ul><li>主动推送</li><li>自动推送</li><li>sitemap（站点地图）</li></ul></li><li><p>手动提交</p><ul><li>即手动地将链接一次性提交给百度</li></ul></li></ol><p>一般自动提交比手动提交效果好一点，自动提交又从效率上来说：</p><p><strong>主动推送&gt;自动推送&gt;sitemap</strong></p><p><strong>自动提交的三种方式</strong>：</p><ol><li><code>主动推送</code>：最为快速的提交方式。将站点当天新产出链接通过此方式推送给百度，以保证新链接可以及时被百度收录。</li><li><code>自动推送</code>：最为便捷的提交方式。将自动推送的JS代码部署在站点的每一个页面源代码中，当部署代码的页面在每次被浏览时，链接就会被自动推送给百度。可以与主动推送配合使用。</li><li><code>sitemap</code>：您可以定期将网站链接放到<code>sitemap文件</code>中，然后将<code>sitemap文件</code>提交给百度。百度会周期性的抓取检查您提交的<code>sitemap</code>，对其中的链接进行处理，但收录速度慢于主动推送。</li></ol><h3 id="使用sitemap方式推送">使用sitemap方式推送</h3><p>安装 sitemap 插件生成站点地图文件:</p><figure><div class="code-area"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">npm install hexo-generator-sitemap --save
npm install hexo-generator-baidu-sitemap --save  #百度专用</code></pre></div></figure><p>安装后直接执行 <code>hexo cl&amp;&amp;hexo g -d</code> 命令，就会在网站根目录生成 <code>sitemap.xml</code> 及 <code>baidusitemap.xml</code> 文件。</p><ul><li>在博客目录的_config.yml中添加如下代码</li></ul><figure><div class="code-area"><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"># 通用站点地图
sitemap:
  path: sitemap.xml

# 百度站点地图
baidusitemap:
  path: baidusitemap.xml</code></pre></div></figure><h3 id="百度优化">百度优化</h3><p>登录<a target="_blank" rel="noopener external nofollow noreferrer" href="https://ziyuan.baidu.com/">百度搜索资源平台</a>， 登录成功之后在 用户中心 –&gt; 站点管理 页面中点击<a target="_blank" rel="noopener external nofollow noreferrer" href="https://ziyuan.baidu.com/site/siteadd">添加网站</a>，按提示操作。</p><p><img src="https://cimg1.17lai.site/data/2022/10/14/20221014091815.webp" width="1452" height="1006" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload alt="站点管理"></p><p><img src="https://cimg1.17lai.site/data/2022/10/14/20221014091815-1.webp" width="1738" height="748" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload alt="添加网站"></p><p><strong>添加网站</strong></p><blockquote><p>提示：由于百度的 spider 是爬取不到 GitHub 的内容的，所以在第三步验证网站的时候，建议选择<code>CNAME验证</code>的方式。</p></blockquote><p>经过以上步骤，百度已经知道有我们网站的存在了，但是百度还不知道我们的网站上有什么内容，所以要向百度推送我们的内容。点击 网站支持 –&gt; 数据引入 –&gt; 链接提交菜单，提交站点地图：</p><p><img src="https://cimg1.17lai.site/data/2022/10/14/20221014091815-2.webp" width="1845" height="1044" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload alt="提交站点地图"></p><p><strong>提交站点地图</strong></p><p>另外，<code>hexo-theme-matery</code>主题已经内置了 <code>自动推送</code> 的功能， 检查 <code>themes/hexo-theme-matery/_config.yml</code> 文件中如下配置:</p><figure><div class="code-area"><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"># 百度搜索资源平台提交链接
baiduPush: true</code></pre></div></figure><p>自动推送的 JS 代码部署在站点的每一个页面源代码中，当页面在每次被浏览时，链接就会被自动推送给百度。</p><h3 id="谷歌优化">谷歌优化</h3><p>登录 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://search.google.com/search-console?hl=zh-CN">Google Search Console</a>，点击添加资源，输入自己的域名，按提示操作。</p><p><img src="https://cimg1.17lai.site/data/2022/10/14/20221014091815-3.webp" width="1162" height="953" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload alt="添加资源"></p><p><strong>添加资源</strong></p><blockquote><p>提示：需要进行 DNS 验证，进入 DNS 域名解析设置页面，按提示增加 TXT 记录，如下图:</p><p><img src="https://cimg1.17lai.site/data/2023/03/14/20230314060200-5.webp" width="1280" height="99" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload alt="DNS验证内容填写示例"></p><p><strong>DNS验证内容填写示例</strong></p></blockquote><p>验证成功后，需要提交站点地图。参照下图提交，然后等待收录。</p><p><img src="https://cimg1.17lai.site/data/2022/10/14/20221014091815-4.webp" width="1820" height="1042" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload alt="提交站点地图"></p><p><strong>提交站点地图</strong></p><blockquote><p>注意：hexo 配置文件中的 url 一定要输入正确的域名，插件是根据 url 生成站点地图的。</p></blockquote><h3 id="其它搜索引擎">其它搜索引擎</h3><blockquote><ul><li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.bing.com/webmasters/home">Bing提交</a></li><li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://zhanzhang.sm.cn/open/detialPage">神马站长</a></li></ul></blockquote><h3 id="百度自动推送方式">百度自动推送方式</h3><p>只要每个需要被百度爬取的HTML页面中加入一段JS代码即可：</p><figure><div class="code-area"><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">&lt;script&gt;
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
&lt;/script&gt;</code></pre></div></figure><p>我所使用的matery主题可以自动给每个页面加上这段代码，只需在主题配置文件中配置：</p><figure><div class="code-area"><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"># 百度搜索资源平台提交链接
baiduPush: true</code></pre></div></figure><p>即可！</p><p>其他主题一般都有这个功能的实现，如果没有的话，想办法在每个页面加入以上JS代码即可，原理是一样。</p><h3 id="百度主动推送SEO方式">百度主动推送SEO方式</h3><blockquote><ul><li>配置文章自动推送到百度蜘蛛</li></ul></blockquote><h4 id="获取百度推送密钥">获取百度推送密钥</h4><p>在 <a href="ziyuan.baidu.com/site">百度资源</a> 注册你的网址，验证完后可在<code>站点管理-&gt;资源提交-&gt;链接提交-&gt;主动推送(实时)</code> 中找到你的推送密钥，下面说明中的 token= 后的内容即为推送密钥。</p><figure><div class="code-area"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">推送接口
接口调用地址：http://data.zz.baidu.com/urls?site=https://ifibe.com&amp;token=xxxxxxxxxx</code></pre></div></figure><h4 id="安装主动推送插件：hexo-baidu-url-submit">安装主动推送插件：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/huiwang/hexo-baidu-url-submit">hexo-baidu-url-submit</a></h4><figure><div class="code-area"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ npm install hexo-baidu-url-submit --save</code></pre></div></figure><h4 id="然后打开hexo配置文件，在末尾加入以下配置：">然后打开<code>hexo配置文件</code>，在末尾加入以下配置：</h4><figure><div class="code-area"><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"># hexo-baidu-url-submit  百度主动推送
baidu_url_submit:
  count: 80 # 提交最新的一个链接
  host: https://blog.17lai.site # 在百度站长平台中注册的域名
  token: xxxxxxx # 请注意这是您的秘钥， 所以请不要把博客源代码发布在公众仓库里!
  path: baidu_urls.txt # 文本文档的地址， 新链接会保存在此文本文档里</code></pre></div></figure><p>密匙的获取是在百度的自动提交的主动推送那里。</p><p><img src="https://cimg1.17lai.site/data/2023/03/14/20230314060200-6.webp" width="742" height="282" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload alt=""></p><h4 id="再加入新的deploy：">再加入新的<code>deploy</code>：</h4><figure><div class="code-area"><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">deploy:
- type: baidu_url_submitter</code></pre></div></figure><p>如图：</p><p><img src="https://cimg1.17lai.site/data/2023/03/14/20230314060200-7.webp" width="716" height="323" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload alt=""></p><p>这样每次执行 <code>hexo d</code> 的时候，新的链接就会被推送了。</p><figure><div class="code-area"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo clean
$ hexo g
$ hexo d</code></pre></div></figure><p>推送成功时,会有如下终端提示!</p><p><img src="https://cimg1.17lai.site/data/2023/03/14/20230314060200-8.webp" width="1459" height="336" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload alt="baidu_url_submitter"></p><p>各种不同的推送反馈字段说明<a target="_blank" rel="noopener external nofollow noreferrer" href="https://ziyuan.baidu.com/college/courseinfo?id=267&amp;page=2#h2_article_title12">点我</a>查看，一般来说，推送失败基本都是地址不相符造成的，我们只需对比<code>baidu_url_submit</code>在<code>public</code>中生成的<code>baidu_urls.txt</code>的地址,与自己填写在<code>host</code>字段中的地址对比看是否一样即可。</p><h3 id="Github-Action-自动提交SEO方式">Github Action 自动提交SEO方式</h3><blockquote><p>强烈推荐使用！<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/Lete114/Hexo-SEO-AutoPush">Hexo-SEO-AutoPush</a></p></blockquote><h4 id="安装插件">安装插件</h4><figure><div class="code-area"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">npm i hexo-seo-autopush --save</code></pre></div></figure><h4 id="配置">配置</h4><p>在hexo 的config.yml里添加</p><p>hexo-seo-autopush配置</p><figure><div class="code-area"><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"># enable: 开启/关闭 推送
# count: 每次提交最新的10篇文章
# https://github.com/lete114/hexo-seo-autopush
hexo_seo_autopush:
  baidu:
    enable: true
    count: 100
  bing:
    enable: true
    count: 10
  google:
    enable: true
    count: 10
    google_file: google_service_account.json # 谷歌服务账户</code></pre></div></figure><p>添加<code>Google Push</code>配置和解决push后没有GitHub Actions <code>.github\workflows\AutoPush.yml</code>文件的问题</p><figure><div class="code-area"><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"># Deployment
## Docs: https://hexo.io/docs/one-command-deployment
deploy:
   - type: git
     repo: https://github.com/lete114/Test.git
     branch: main
     ignore_hidden: false  # 忽略隐藏文件及文件夹(目录)
   - type: GooglePush # 谷歌提交</code></pre></div></figure><h3 id="获取站长平台密钥">获取站长平台密钥</h3><h4 id="Baidu-Key">Baidu Key</h4><ol><li>打开百度站长平台，点击左侧的普通收录<a target="_blank" rel="noopener external nofollow noreferrer" href="https://ziyuan.baidu.com/">https://ziyuan.baidu.com/</a><br><img src="https://cimg1.17lai.site/data/2022/08/16/20220816180233.webp" width="1643" height="958" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload alt="百度api key"></li></ol><h4 id="Bing-Key">Bing Key</h4><ol><li>打开Bing站长平台，<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.bing.com/webmasters/home">https://www.bing.com/webmasters/home</a></li><li>点击右上角头像 旁边的齿轮，跟着下图操作<br><img src="https://cimg1.17lai.site/data/2023/03/14/20230314060200-9.webp" width="1268" height="563" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload alt=""></li></ol><h4 id="Google-Key">Google Key</h4><blockquote><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://cloud.google.com/docs/authentication/production?hl=zh-cn">Google Wiki</a>， 使用参考。</p></blockquote><ol><li><p>打开Google indexing API<a target="_blank" rel="noopener external nofollow noreferrer" href="https://console.developers.google.com/flows/enableapi?apiid=indexing.googleapis.com&amp;credential=client_key">官网</a></p></li><li><p>选择创建项目，点击继续</p></li><li><p>点击转到凭据页面</p></li><li><p>跟着如下图片步骤</p><p><img src="https://cimg1.17lai.site/data/2023/03/14/20230314060200-10.webp" width="1001" height="815" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload alt="GoogleProof"></p><p><img src="https://cimg1.17lai.site/data/2023/03/14/20230314060200-11.webp" width="1016" height="799" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload alt="GoogleAddProof"></p><p><img src="https://cimg1.17lai.site/data/2023/03/14/20230314060200-12.webp" width="734" height="340" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload alt="GoogleNone"></p><p><img src="https://cimg1.17lai.site/data/2023/03/14/20230314060200-13.webp" width="1395" height="832" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload alt="GoogleKey"></p><p>json文件内的内容</p><figure><div class="code-area"><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">{
  "type": "service_account",
  "project_id": "elated-guild-298003",
  "private_key_id": "cf58d669c0e8c8e082b2c403ade5e2548078e384",
  "private_key": "-----BEGIN PRIVATE KEY-----\nMIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQDEAJw89yeylRrA\nB+bzOAfQQNgOCABIwEKCy5mMxWSaiXy2RktyCJWjMR2Pgz770NJgClQHPJjsFn0c\nukHufpnuiX3VPlimLANPCRFdU/qp+yiaw4quIhYF1UZJkhmhL30anghUcvi+r9hQ\nw+RwcKrgA4EUzqUJaPdvjtzSoo315PPGfR91ASD5S8gE02yVI8igtYMX7v2x1JYR\n7PwHJwOVemiM9lot8ilvoUbV4BU0vSlwFoxKMJAbEXTmJjEKQi9992rcMW0GzXO8\ncHldUUtURXkt3VFjYTH27KhHiTkTXw+uZRBu1rkubDJkS8lGIWN7Fc/r4HMMCVTu\nXPS6HbJ/AgMBAAECggEANSS7OBaFd3jRL3cVCiZLjA5A5pEJzq/+eKtOn2oYDISx\nwVRO+YTVWdGj47kg1zM4D11NikbGaeDxHFxuKwW9o/04lpyYebneTcw2Hpl6EiOs\nz0WssOlCEmPQ8nrAI0GWiKSHuqoPwtg37TIoGsqZsjKRCby759DDokZYnm3/0sc+\niEllT0ZyBZhGDzyguVLEdCIR2P02q/hQzLyd6ejWGGwZebImbGoILhmuOjVrco0p\nV0JbrrNskjM5Epe7w+CpGftEASJ7Dxa8oj0qIT6cyAipra2AZAGnG9jrLcWpJuhu\nvNeDIFnTfpNEac+khXZZE2++MIQfTX9wGJc8tox2vQKBgQD6yiNvAL7sxExiy6ER\ntLtFQ3bvmMpKRFGvFOyPOtMbmjZ3D1GEtNNKGH4v1TI+tncEy7Q5Dm7nWwpi8yvL\nbh8xKghelAc/CU1nw0xDEDCkMbAwpFg5A5ZDImy3LZsQh0kNXniIMy1vMSt5yLKS\n80gXQKGCxG8t3rP8Qd/2a55g1QKBgQDIExP1nG9sHJaigmitEUwr0Ow6Shqr56Me\nd7995gaV1oLWWCQzrXt/viWkb1W5ZGIxzcWNWz99m4CbvqfewRr598Eenald0csN\nVcIEk+0C+6KqA+jU9Tfs2zow/C7JuKULP2N++o0EoSz/ngokP7f1yLOYbr507v/R\n0cLElQBQAwKBgAbxDWYHKUG4dTzO0hiBXiWepm4fVooTtgcYlyunvywmapeFDwaT\nUr3cS7HbPtbJiiXR1Z02rw8sT+9JN88brzVXKoAjrMer5D6ZA0Vf71i8H1pZUi/R\nz5jwHP48/uvIMtdx4/gxInLPc5qdWYQDw90Q5ueNtF4aqfSzhhV2CR45AoGBAJN9\nPOF6iMjx6jmyWOf8MGK8iOgPaMoA4Ea9j/SHdaNPlvPb1hQid0AcNDObv14Dmj+M\nqW0jLxKxZ4VobufPAsvyz/J51zjKRx11cqldQwNH7QnYB/O1MZzxn1wtC3C5JTG9\ncONSYFJhXoKxRliigEI3ye089jnNVdifAS1ZiflxAoGBANTX1fEMEeNuYU0v3rtd\n5CkPZg4TNZ+y2MGl5xR1LdIgrJ8c9xKoW4rpp7SsOIvHpWX494f90D7o9uFEGSQ4\nyQK53jVzJ0ekGV5BdPF3n3/2j2VEqFLHi7LL4CJSxr6ci7OfBoHOGE8odhevQCCK\njnFzEin0QsBEgIC73fBh6XcH\n-----END PRIVATE KEY-----\n",
  "client_email": "googleindexing@elated-guild-298003.iam.gserviceaccount.com",
  "client_id": "103034240916368863393",
  "auth_uri": "https://accounts.google.com/o/oauth2/auth",
  "token_uri": "https://oauth2.googleapis.com/token",
  "auth_provider_x509_cert_url": "https://www.googleapis.com/oauth2/v1/certs",
  "client_x509_cert_url": "https://www.googleapis.com/robot/v1/metadata/x509/googleindexing%40elated-guild-298003.iam.gserviceaccount.com"
}</code></pre></div></figure></li><li><p>打开<a target="_blank" rel="noopener external nofollow noreferrer" href="https://search.google.com/search-console">谷歌站长平台</a><br><img src="https://cimg1.17lai.site/data/2023/03/14/20230314060200-14.webp" width="1727" height="815" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload alt="GoogleAddUser"><br><img src="https://cimg1.17lai.site/data/2023/03/14/20230314060200-15.webp" width="1920" height="729" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload alt="GoogleAddEmail"></p></li></ol><h4 id="配置博客仓库">配置博客仓库</h4><ol><li><p>Name必须是<code>baidu_token</code>和<code>bing_apikey</code>(不区分大小写)</p></li><li><p>添加完成后<br><img src="https://cimg1.17lai.site/data/2023/03/14/20230314060200-16.webp" width="1153" height="374" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload alt="Secrets-token"></p></li></ol><h4 id="谷歌的一些问题">谷歌的一些问题</h4><p>触发谷歌提交的命令是<code>hexo d</code></p><p>由于谷歌需要配合Google indexing API平台提供的json进行提交，而这个json格式不能泄露<br>为防止json泄露只能本地提交，将json放到hexo根目录可自定义重命名(必须对应插件的配置)<br><code>如果你的使用Github Actions自动部署的话请把仓库设置为私有</code><br><img src="https://cimg1.17lai.site/data/2023/03/14/20230314060200-17.webp" width="1027" height="652" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload alt="GoogleConfig"></p><h4 id="提交成功返回状态码">提交成功返回状态码</h4><p>以上步骤完成后即可<code>hexo d</code>部署了</p><ol><li><p>看看Github仓库是否上传成功<br><img src="https://cimg1.17lai.site/data/2023/03/14/20230314060427.webp" width="1509" height="871" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload alt=""></p></li><li><p>点击<code>Actions</code>查看是否执行<br><img src="https://cimg1.17lai.site/data/2023/03/14/20230314060427-1.webp" width="1891" height="774" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload alt=""></p></li><li><p>点击 Auto Push—-&gt;build—–&gt;点击第2步 自动提交</p><p>如图43行</p><p><img src="https://cimg1.17lai.site/data/2023/03/14/20230314060427-2.webp" width="1444" height="836" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload alt=""></p><figure><div class="code-area"><pre class="line-numbers language-json" data-language="json"><code class="language-json">// baidu返回的结果
{
	"remain": 2060,  // 表示当天剩余的可推送url条数
	"success": 47    // 成功推送的url条数
} 
// bing返回结果(错误)
{
	"ErrorCode": 2,  // 错误 
	"Message": "ERROR!!! Quota remaining for today: 2, Submitted: 47"
    // Message：表示 你目前只剩2个url推送，而你现在推送的是47条url
    // bing新用户开始每日只有10个推送额，据我了解连续推送10天(这我也不确定)
    // 如果出现这个错误的话，你就只能先手动添加等系统给你分配额了(分配9999)
}
// bing返回结果(成功)
{"d":null}</code></pre></div></figure></li><li><p>Google 返回状态码</p><p>成功返回</p><figure><div class="code-area"><pre class="line-numbers language-json" data-language="json"><code class="language-json">Google response:  {
  urlNotificationMetadata: {
    url: 'https://blog.lete114.top/article/hexo-seo-autopush.html',
    latestUpdate: {
      url: 'https://blog.lete114.top/article/hexo-seo-autopush.html',
      type: 'URL_UPDATED',
      notifyTime: '2020-12-08T02:31:32.871417693Z'
    }
  }
}</code></pre></div></figure><p>出现此错误需要: 翻墙</p><figure><div class="code-area"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">FetchError: request to https://www.googleapis.com/oauth2/v4/token failed, reason: connect ETIMEDOUT 172.217.27.138:443
    at ClientRequest.&lt;anonymous&gt; (D:\Lete\GitHub\Hexo-Butterfly\node_modules\node-fetch\lib\index.js:1461:11)
    at ClientRequest.emit (events.js:321:20)
    at TLSSocket.socketErrorListener (_http_client.js:426:9)
    at TLSSocket.emit (events.js:321:20)
    at emitErrorNT (internal/streams/destroy.js:92:8)
    at emitErrorAndCloseNT (internal/streams/destroy.js:60:3)
    at processTicksAndRejections (internal/process/task_queues.js:84:21) {
  message: 'request to https://www.googleapis.com/oauth2/v4/token failed, reason: connect ETIMEDOUT 172.217.27.138:443',
  type: 'system',
  errno: 'ETIMEDOUT',
  code: 'ETIMEDOUT',
  config: {
    method: 'POST',
    url: 'https://www.googleapis.com/oauth2/v4/token',
    data: {
      grant_type: 'urn:ietf:params:oauth:grant-type:jwt-bearer',
      assertion: 'eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJnb29nbGVpbmRleGluZ0BzdGF0ZWx5LXRyYW5zaXQtMjk3NzE1LmlhbS5nc2VydmljZWFjY291bnQuY29tIiwic2NvcGUiOiJodHRwczovL3d3d</code></pre></div></figure></li></ol><h3 id="本地主动提交SEO">本地主动提交SEO</h3><blockquote><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/abnerwei/hexo-url-submission">hexo-url-submission</a></p><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://abnerwei.com/wiki/hexo/url-submission">Wiki</a></p></blockquote><h4 id="安装方法"><strong>安装方法</strong></h4><ol><li>在终端中输入：</li></ol><figure><div class="code-area"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">npm i hexo-url-submission</code></pre></div></figure><ol start="2"><li>在 <code>blog/_config.yml</code> 文件中添加配置：</li></ol><figure><div class="code-area"><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">url_submission:
   enable: true
   type: 'latest' # latest or all( latest: modified pages; all: posts &amp; pages)
   channel: ['baidu', 'bing', 'google', 'shenma'] # Included channels are `baidu`, `google`, `bing`, `shenma`
   prefix: ['/post', '/wiki'] # URL prefix
   count: 10 # Submit limit
   proxy: '' # Set the proxy used to submit urls to Google
   urls_path: 'submit_url.txt' # URL list file path
   baidu_token: '' # Baidu private key
   bing_token: '' # Bing private key
   google_key: '' # Google key path (e.g. `google_key.json` or `data/google_key.json`)
   shenma_token: '' # ShenMa private key
   shenma_user: '' # Username used when registering
   sitemap: '' # Sitemap path(e.g. the url is like this https://abnerwei.com/baidusitemap.xml, you can fill in `baidusitemap.xml`)</code></pre></div></figure><h4 id="更新方法"><strong>更新方法</strong></h4><p>在站点根目录执行：</p><figure><div class="code-area"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">npm update hexo-url-submission</code></pre></div></figure><h4 id="deploy">deploy</h4><figure><div class="code-area"><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">deploy:
  - type: us_baidu_deployer
  - type: us_bing_deployer
  - type: us_google_deployer
  - type: us_shenma_deployer</code></pre></div></figure><h4 id="good-job">good job</h4><p>Run:</p><figure><div class="code-area"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</code></pre></div></figure><p>enjoy it!</p><h2 id="提交-robots-txt">提交 robots.txt</h2><h3 id="robots-txt是干嘛的？">robots.txt是干嘛的？</h3><blockquote><p><code>robots.txt</code> 是一种存放于网站根目录下的 <code>ASCII</code> 编码的文本文件，它的作用是告诉搜索引擎此网站中哪些内容是可以被爬取的，哪些是禁止爬取的。<br><code>robots.txt</code> 要放在 <code>Hexo根目录</code> 下的 <code>source</code> 文件夹中。</p></blockquote><p>每个人站点目录可能不太一样，可以参考下我的 <code>robots.txt</code> 文件，内容如下：</p><figure><div class="code-area"><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">User-agent: *
Allow: /
Allow: /posts/
Disallow: /about/
Disallow: /archives/
Disallow: /js/
Disallow: /css/
Disallow: /contact/
Disallow: /fonts/
Disallow: /friends/
Disallow: /libs/
Disallow: /medias/
Disallow: /page/
Disallow: /tags/
Disallow: /categories/</code></pre></div></figure><p>更多关于 <code>robots.txt</code> 的写法参见 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.csdn.net/fanghua_vip/article/details/79535639">https://blog.csdn.net/fanghua_vip/article/details/79535639</a></p><p>编写完以上内容再重新部署一下，然后到百度资源平台的<code>数据监控</code>-&gt;<code>Robots</code>点击<code>检测并更新</code> 看能不能检测到。</p><h2 id="配置-Nofollow">配置 Nofollow</h2><ul><li>nofollow 是HTML页面中 <code>a标签</code> 的 属性值。</li><li>这个属性的作用是：告诉搜索引擎的爬虫不要追踪该链接，为了对抗博客垃圾留言信息</li></ul><h2 id="URL优化">URL优化</h2><p>一般来说，SEO搜索引擎优化认为，网站的最佳结构是 <strong>用户从首页点击三次就可以到达任何一个页面</strong>，但是我们使用<code>Hexo</code>编译的站点结构的<code>URL</code>是：<code>域名/年/月/日/文章标题</code>四层的结构，这样的<code>URL</code>结构很不利于<code>SEO</code>，爬虫就会经常爬不到我们的文章，于是，我们需要优化一下网站文章的<code>URL</code></p><p><strong>方案一</strong>：</p><p>直接改成<code>域名/文章标题</code>的形式，在<code>Hexo配置文件</code>中修改<code>permalink</code>如下：</p><figure><div class="code-area"><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"># URL
## If your site is put in a subdirectory, set url as 'http://yoursite.com/child' and root as '/child/'
url: https://blog.sky03.cn
root: /
permalink: :title.html
permalink_defaults:</code></pre></div></figure><p><strong>这个方式有个不好的地方：</strong></p><p>直接以<code>文章的标题</code>作为URL，而我们所写的文章的标题一般都是中文，但是URL只能用字母数字和标点符号表示，所以中文的URL只能被转义成一堆符号，而且还特别长。</p><p><strong>方案二</strong>：</p><p>安装固定链接插件：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/rozbo/hexo-abbrlink">hexo-abbrlink</a></p><p>插件作用：自动为每篇文章生成一串数字作每篇文章的URI地址。每篇文章的<code>Front-matter</code>中会自动增加一个配置项：<code>abbrlink: xxxxx</code>，该项的值就是当前文章的URI地址。</p><ol><li><p>Hexo根目录执行：</p><figure><div class="code-area"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">npm install hexo-abbrlink --save</code></pre></div></figure></li><li><p><code>Hexo配置文件</code>末尾加入以下配置：</p><figure><div class="code-area"><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"># hexo-abbrlink config 、固定文章地址插件
abbrlink:
  alg: crc16  #算法选项：crc16、crc32，区别见之前的文章，这里默认为crc16丨crc32比crc16复杂一点，长一点
  rep: dec    #输出进制：十进制和十六进制，默认为10进制。丨dec为十进制，hex为十六进制</code></pre></div></figure></li><li><p><code>Hexo配置文件</code>中修改<code>permalink</code>如下：</p><figure><div class="code-area"><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"># URL
## If your site is put in a subdirectory, set url as 'http://yoursite.com/child' and root as '/child/'
url: https://blog.17lai.site
root: /
permalink: posts/:abbrlink.html
permalink_defaults:</code></pre></div></figure></li></ol><p>这样站点结构就变成了：<code>域名/posts/xxx.html</code></p><h2 id="Analytics-优化">Analytics 优化</h2><blockquote><p>强烈推荐自建 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://umami.is/">Umami</a> 统计服务，所有公用的访问统计服务都被浏览器插件拦截工具拦截！</p></blockquote><h3 id="Google">Google</h3><blockquote><p>Google Analytics 是一个 gzip 以后都还有 45KB 大小的 analytics.js、Cache-Control 还只有 7200 秒；Google 国内的数据中心会被抽风不说，<a target="_blank" rel="noopener external nofollow noreferrer" href="http://www.google-analytics.com">www.google-analytics.com</a> 域名早就上了各个广告屏蔽软件的黑名单!所以要么自建其它私有统计，要么想办法优化加载了。</p></blockquote><div class="github-card-container" style="position:relative;min-height:150px"><div class="github-card" data-user="17lai" data-repo="ga-proxy"></div><noscript><div class="github-card-error">JavaScript is required to load GitHub Cards</div></noscript></div><blockquote><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.giuem.com/blog/google-analytics-loading-optimize">Google Analytics 加载优化</a></p></blockquote><div class="github-card-container" style="position:relative;min-height:150px"><div class="github-card" data-user="17lai" data-repo="cloudflare-workers-async-google-analytics"></div><noscript><div class="github-card-error">JavaScript is required to load GitHub Cards</div></noscript></div><blockquote><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.skk.moe/post/cloudflare-workers-cfga/">使用 Cloudflare Workers 加速 Google Analytics</a></p></blockquote><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://bluest.xyz/google-analytics-optimize-with-wordpress.html">Google Analytics 优化 @ WordPress</a></p><h3 id="umami">umami</h3><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://umami.is/docs/running-on-vercel">Running on Vercel</a></p><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://umami.is/docs">Umami官方文档</a></p><figure><div class="code-area"><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">version: '3'
services:
  umami:
    image: ghcr.io/umami-software/umami:postgresql-latest
    ports:
      - "3000:3000"
    environment:
      DATABASE_URL: postgresql://umami:umami@db:5432/umami
      DATABASE_TYPE: postgresql
      APP_SECRET: replace-me-with-a-random-string
    depends_on:
      db:
        condition: service_healthy
    restart: always
  db:
    image: postgres:15-alpine
    environment:
      POSTGRES_DB: umami
      POSTGRES_USER: umami
      POSTGRES_PASSWORD: umami
    volumes:
      - umami-db-data:/var/lib/postgresql/data
    restart: always
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U $${POSTGRES_USER} -d $${POSTGRES_DB}"]
      interval: 5s
      timeout: 5s
      retries: 5
volumes:
  umami-db-data:</code></pre></div></figure><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/umami-software/umami/blob/master/docker-compose.yml">https://github.com/umami-software/umami/blob/master/docker-compose.yml</a></p><p>umami支持MySQL和Postgres，并可以在 Vercel Netlify 上面部署。</p><h2 id="Umami-UV-PV-统计显示">Umami UV / PV 统计显示</h2><blockquote><p>Umami 统计了 UV PV 等各种访问数据，比不蒜子详细得多，自建服务也比不蒜子稳定。那么怎么用 Umami 代替不蒜子了？ 下文将介绍详细方法</p></blockquote><h3 id="新建-View-only-权限的用户">新建 <code>View only</code> 权限的用户</h3><figure><div class="code-area"><pre class="line-numbers language-none"><code class="language-none">Settings` -&gt; `Users` -&gt; `Create user` -&gt; 填写账号密码，`Role` 选择 `View only` -&gt; `Save</code></pre></div></figure><p><img src="https://cimg1.17lai.site/data/2024/03/28/20240328054222.webp" width="651" height="859" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload alt="新建用户"></p><blockquote><p>Q: 为什么不直接调用 Umami 的 API 获取数据，而是要额外创建一个账户？</p><p>A: 博客是 <strong>静态开源无服务器</strong> 的，所有代码都展示在前端，包括 API 调用。而 Umami 的 <code>admin</code> API 权限太大了，如果使用 <code>admin</code> 权限的 API Token，那么这个 token 可以获取、修改、删除所有网站的数据，会有严重的安全隐患。</p><p>所以我们需要创建一个 <code>View only</code> 权限的用户，使用这个 <code>低权限的用户</code>的 API Token 来访问我们的浏览量等数据。</p></blockquote><h3 id="新建-Team-并添加用户和网站">新建 <code>Team</code> 并添加用户和网站</h3><p><code>Settings</code> -&gt; <code>Teams</code> -&gt; <code>Create team</code> -&gt; 填写名称 -&gt; <code>Save</code> -&gt; 找到刚刚创建的 <code>Team</code> -&gt; <code>Edit</code> -&gt; 复制 <code>Access code</code>，点击 <code>Websites</code> 中点击 <code>Add website</code> 选中你想共享的网站</p><p>换一个浏览器登录 Umami（使用<code>View only</code> 权限的用户） -&gt; <code>Settings</code> -&gt; <code>Teams</code> -&gt; <code>Join team</code> -&gt; 输入 <code>Access code</code> -&gt; <code>Join</code> -&gt; 如果没有出错的话，点击 <code>Dashboard</code> 就可以看到你刚刚添加的网站了</p><h3 id="获取-View-only-用户的-API-Token">获取 <code>View only</code> 用户的 API Token</h3><p>根据 Umami 的文档，我们可以通过以下方式获取 API Token：</p><figure><div class="code-area"><pre class="line-numbers language-awk" data-language="awk"><code class="language-awk">POST /api/auth/login</code></pre></div></figure><p>例如 你的网站地址为 <code>example.com</code>，那么你需要使用 <code>View only</code> 的账户密码向 <code>https://example.com/api/auth/login</code> 发送一个 POST 请求，请求体为：</p><figure><div class="code-area"><pre class="line-numbers language-json" data-language="json"><code class="language-json">{
  "username": "your-username",
  "password": "your-password"
}</code></pre></div></figure><p>如果成功，你应该会得到以下的结果：</p><figure><div class="code-area"><pre class="line-numbers language-json" data-language="json"><code class="language-json">{
  "token": "eyTMjU2IiwiY...4Q0JDLUhWxnIjoiUE_A",
  "user": {
    "id": "cd33a605-d785-42a1-9365-d6cad3b7befd",
    "username": "your-username",
    "createdAt": "2020-04-20 01:00:00"
  }
}</code></pre></div></figure><p>保存 token 值，并在所有请求中发送带 <code>Bearer &lt;token&gt;</code> 值的 <code>Authorization</code> 标头。请求标头应该如下所示：</p><figure><div class="code-area"><pre class="line-numbers language-nginx" data-language="nginx"><code class="language-nginx">Authorization: Bearer eyTMjU2IiwiY...4Q0JDLUhWxnIjoiUE_A</code></pre></div></figure><h3 id="发送请求获取数据">发送请求获取数据</h3><p>这里要用到类似于 <code>postman</code> 的 API 测试工具，可以使用的是开源的 <code>hoppscotch</code>，你也可以使用 <code>curl</code> 或者其他工具。</p><p>先分析一下官方文档的 API 接口：<br><code>GET /api/websites/{websiteId}/stats</code><br><img src="https://cimg1.17lai.site/data/2024/03/28/20240328054222-1.webp" width="1491" height="1160" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload alt="API"></p><p>有两个必填的 查询参数：<code>startAt</code> 和 <code>endAt</code>，都是 Unix 毫秒时间戳，表示开始时间和结束时间</p><p><code>websiteId</code> 和 <code>startAt</code> 需要我们自己获取</p><p><code>websiteId</code> 可以在 <code>Dashboard</code> -&gt; <code>View details</code> -&gt; 看浏览器栏的地址 <code>https://example.com/websites/{websiteId}</code> 中找到</p><p><code>startAt</code> 可发送 <code>GET</code> 请求到 <code>https://example.com/api/websites/{websiteId}</code>，请求头为</p><figure><div class="code-area"><pre class="line-numbers language-nginx" data-language="nginx"><code class="language-nginx">Authorization: Bearer eyTMjU2IiwiY...4Q0JDLUhWxnIjoiUE_A</code></pre></div></figure><p>在返回结果中找到 <code>createdAt</code> 字段，这个字段就是 <code>startAt</code> 的值，也就是你的网站创建时间，数据的开始时间<br><img src="https://cimg1.17lai.site/data/2024/03/28/20240328054222-2.webp" width="1578" height="1086" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload alt="createdAt"></p><h3 id="编写页面">编写页面</h3><p><img src="https://cimg1.17lai.site/data/2024/03/28/20240328054222-3.webp" width="561" height="257" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload alt="页面展示"></p><p>代码如下，修改你对应的参数即可运行：</p><figure><div class="code-area"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;

&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;title&gt;Document&lt;/title&gt;
&lt;/head&gt;

&lt;body&gt;
    &lt;div style="text-align:center;"&gt;
        &lt;h1&gt;Umami 网站统计&lt;/h1&gt;
        &lt;span&gt;总访问量 &lt;span id="umami-site-pv"&gt;&lt;/span&gt; 次&lt;/span&gt;

        &lt;span&gt;总访客数 &lt;span id="umami-site-uv"&gt;&lt;/span&gt; 人&lt;/span&gt;
    &lt;/div&gt;

    &lt;script&gt;
        // 从配置文件中获取 umami 的配置
        const website_id = 'xxx';

        // 拼接请求地址
        const request_url = 'https://xxx.com' + '/api/websites/' + website_id + '/stats';

        const start_time = new Date('2024-01-01').getTime();
        const end_time = new Date().getTime();

        const token = 'xxxxxx';

        // 检查配置是否为空
        if (!website_id) {
            throw new Error("Umami website_id is empty");
        }
        if (!request_url) {
            throw new Error("Umami request_url is empty");
        }
        if (!start_time) {
            throw new Error("Umami start_time is empty");
        }
        if (!token) {
            throw new Error("Umami token is empty");
        }

        const params = new URLSearchParams({
            startAt: start_time,
            endAt: end_time,
        });

        const request_header = {
            method: "GET",
            headers: {
                "Content-Type": "application/json",
                "Authorization": "Bearer " + token,
            },
        };

        async function allStats() {
            try {
                const response = await fetch(`${request_url}?${params}`, request_header);
                const data = await response.json();
                const uniqueVisitors = data.pageviews.value; // 获取独立访客数
                const pageViews = data.pageviews.value; // 获取页面浏览量

                let ele1 = document.querySelector("#umami-site-pv")
                if (ele1) {
                    ele1.textContent = pageViews; // 设置页面浏览量
                }

                let ele2 = document.querySelector("#umami-site-uv")
                if (ele2) {
                    ele2.textContent = uniqueVisitors;
                }

                console.log(uniqueVisitors, pageViews);
                console.log(data);
            } catch (error) {
                console.error(error);
                return "-1";
            }
        }
        allStats();
    &lt;/script&gt;
&lt;/body&gt;

&lt;/html&gt;</code></pre></div></figure><h2 id="异步加载JS">异步加载JS</h2><p><strong>方法</strong>：将JS文件的引入，放到HTML的body结束标签的上方</p><p><strong>例</strong>：</p><figure><div class="code-area"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;Hello World!&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        xxxxx....
        &lt;script src="xx/xx.js"&gt;&lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre></div></figure><p><strong>原理</strong>：首先要明白，HTML的加载是从上往下一行一行解释执行的，把js文件的引入放到下面，这样就会先把HTML页面展示出来，然后再加载js。这样看起来的效果就是，大体的页面先出来，而js让它慢慢加载执行，如果你把js放到网页的上方，效果就是必须要加载完js才能继续展示网页，体验极差。</p><p><strong>注意</strong>：原主题的js文件尽量不要动，我们只需将自己增加的一些js按照异步加载的方式做即可，比如一些音乐js插件、实时在线聊天js插件等放到最后即可！因为这些文件要加载的东西很多。</p><h2 id="字蛛压缩字体">字蛛压缩字体</h2><blockquote><p>在上面我们介绍了如何在网站上引用自己喜欢的字体，但是这样会出现一个问题：字体文件太大！（尤其是中文，有时候为了几个字引入一个数十兆的字体文件，得不偿失），所有需要字体压缩！</p></blockquote><p><a target="_blank" rel="noopener external nofollow noreferrer" href="http://font-spider.org/">官网</a> <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/aui/font-spider">GitHub</a></p><h3 id="使用场景">使用场景</h3><p>你的网站中需要自定义字体（额外添加一些普通电脑中没有的字体），但是一般字体是包含很多字符的，这就导致字体文件的体积很大</p><h3 id="字蛛作用">字蛛作用</h3><p>字蛛就是自动检测网站的 CSS 与 HTML 文件中的自定义字体（额外加的字体），并将网站中<strong>用到的文字</strong>重新打包成一个新的字体文件，并自动引入；</p><p>而<strong>没用到的文字</strong>就会删除，从而达到压缩字体文件体积的作用。</p><h4 id="安装">安装</h4><figure><div class="code-area"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">npm install font-spider -g</code></pre></div></figure><h3 id="在-CSS-中使用-WebFont：">在 CSS 中使用 WebFont：</h3><figure><div class="code-area"><pre class="line-numbers language-css" data-language="css"><code class="language-css">/*声明 WebFont*/
@font-face {
  font-family: 'pinghei';
  src: url('../font/pinghei.eot');
  src:
    url('../font/pinghei.eot?#font-spider') format('embedded-opentype'),
    url('../font/pinghei.woff') format('woff'),
    url('../font/pinghei.ttf') format('truetype'),
    url('../font/pinghei.svg') format('svg');
  font-weight: normal;
  font-style: normal;
}

/*使用选择器指定字体*/
.home h1, .demo &gt; .test {
    font-family: 'pinghei';
}</code></pre></div></figure><blockquote><ol><li>@font-face 中的 src 定义的 .ttf 文件必须存在，其余的格式将由工具自动生成</li><li>开发阶段请使用相对路径的 CSS 与 WebFont</li></ol></blockquote><h3 id="运行-font-spider-命令：">运行 font-spider 命令：</h3><figure><div class="code-area"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">font-spider ./demo/*.html</code></pre></div></figure><blockquote><p>页面依赖的字体将会自动压缩好，原 .ttf 字体会备份</p></blockquote><h2 id="使用-FontForge-压缩-Font-awesome">使用 FontForge 压缩 Font awesome</h2><blockquote><p>曾经尝试过各种方案来压缩字体，最后还是这种方法最适合</p></blockquote><h3 id="下载安装-FontForge">下载安装 FontForge</h3><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://fontforge.org/en-US/downloads/windows/">Windows</a>, <a target="_blank" rel="noopener external nofollow noreferrer" href="https://fontforge.org/en-US/downloads/mac/">Mac</a> and <a target="_blank" rel="noopener external nofollow noreferrer" href="https://fontforge.org/en-US/downloads/gnulinux/">GNU+Linux</a>.</p><h3 id="准备python-环境">准备python 环境</h3><p><code>minify.py</code> 文件</p><figure><div class="code-area"><pre class="line-numbers language-python" data-language="python"><code class="language-python">import glob
import re
import fontforge


extensions = [".html", ".js"]
pattern = re.compile("(fa-[-\w]+)")


# 获取使用到的图标
def get_used_icons(path):
    icon_dict = {}
    for filename in glob.glob(path, recursive=True):
        for extension in extensions:
            if extension in filename:
                for line in open(filename, encoding='utf-8'):
                    for match in re.finditer(pattern, line):
                        icon_dict[match.group()[3:]] = True
    return icon_dict


# 去除除了传入的字典的图标
def minify(path, used_dict):
    font = fontforge.open(path)
    assert isinstance(font, fontforge.font)
    selection = font.selection
    assert isinstance(selection, fontforge.selection)
    selection.all()
    for i in selection.byGlyphs:
        assert isinstance(i, fontforge.glyph)
        if i.glyphname not in used_dict:
            font.removeGlyph(i)
    font.generate(path)


if __name__ == '__main__':
    web_path = "V:/hexo/blog/public/**"
    font_path = "V:/hexo/blog/themes/matery/source/libs/awesome/webfonts/"
    font_list = ["fa-brands-400.woff2", "fa-regular-400.woff2", "fa-solid-900.woff2"]
    used_icon_dict = get_used_icons(web_path)
    for font_name in font_list:
        minify(font_path + font_name, used_icon_dict)</code></pre></div></figure><figure><div class="code-area"><pre class="line-numbers language-python" data-language="python"><code class="language-python">import glob
import re
import fontforge
import os

extensions = [".html", ".js"]
pattern = re.compile(r"(fa-[-\w]+)")
user_defined_icons = ["fa-github", "fa-pencil", "fa-cog", "fa-cloud-upload", "fa-compress-arrows-alt"]

# 获取使用到的图标
def get_used_icons(path):
    icon_dict = {}
    for filename in glob.glob(path, recursive=True):
        for extension in extensions:
            if extension in filename:
                with open(filename, encoding="utf-8") as file:
                    for line in file:
                        for match in re.finditer(pattern, line):
                            icon_dict[match.group()[3:]] = True
    return icon_dict

# 去除除了传入的字典的图标
def minify(source_path, target_path, used_dict):
    font = fontforge.open(source_path)
    assert isinstance(font, fontforge.font)
    selection = font.selection
    assert isinstance(selection, fontforge.selection)
    selection.all()
    for i in selection.byGlyphs:
        assert isinstance(i, fontforge.glyph)
        if i.glyphname not in used_dict:
            font.removeGlyph(i)
    font.generate(target_path)
    font.close()

if __name__ == '__main__':
    web_path = "V:/hexo/blog/public/**/*"
    font_source_dir = "V:/hexo/blog/themes/matery/source/libs/awesome5/webfonts/"
    font_target_dir = "V:/hexo/blog/themes/matery/source/libs/awesome/webfonts/"
    font_list = ["fa-brands-400.woff2", "fa-regular-400.woff2", "fa-solid-900.woff2"]
    used_icon_dict = get_used_icons(web_path)

    # Add user-defined icons to the used icons dictionary
    for icon in user_defined_icons:
        used_icon_dict[icon] = True

    print("Used Icons:")
    for icon in used_icon_dict.keys():
        print(icon)

    for font_name in font_list:
        source_path = os.path.join(font_source_dir, font_name)
        target_path = os.path.join(font_target_dir, font_name)
        minify(source_path, target_path, used_icon_dict)
</code></pre></div></figure><p>下面是一个增强版本</p><figure><div class="code-area"><pre class="line-numbers language-python" data-language="python"><code class="language-python">import glob
import re
import fontforge
import os

extensions = [".html", ".js"]
pattern = re.compile(r"(fa-[-\w]+)")
user_defined_icons = ["fa-github", "fa-pencil", "fa-cog", "fa-cloud-upload"]

# 获取使用到的图标
def get_used_icons(path):
    icon_dict = {}
    for filename in glob.glob(path, recursive=True):
        for extension in extensions:
            if extension in filename:
                with open(filename, encoding="utf-8") as file:
                    for line in file:
                        for match in re.finditer(pattern, line):
                            icon_dict[match.group()[3:]] = True
    return icon_dict

# 去除除了传入的字典的图标
def minify(source_path, target_path, used_dict):
    font = fontforge.open(source_path)
    assert isinstance(font, fontforge.font)
    selection = font.selection
    assert isinstance(selection, fontforge.selection)
    selection.all()
    for i in selection.byGlyphs:
        assert isinstance(i, fontforge.glyph)
        if i.glyphname not in used_dict:
            font.removeGlyph(i)
    font.generate(target_path)
    font.close()

if __name__ == '__main__':
    web_path = "V:/hexo/blog/public/**/*"
    font_source_dir = "V:/hexo/blog/themes/matery/source/libs/awesome5/webfonts/"
    font_target_dir = "V:/hexo/blog/themes/matery/source/libs/awesome/webfonts/"
    font_list = ["fa-brands-400.woff2", "fa-regular-400.woff2", "fa-solid-900.woff2"]
    used_icon_dict = get_used_icons(web_path)

    # Add user-defined icons to the used icons dictionary
    for icon in user_defined_icons:
        used_icon_dict[icon] = True

    print("Used Icons:")
    for icon in used_icon_dict.keys():
        print(icon)

    for font_name in font_list:
        source_path = os.path.join(font_source_dir, font_name)
        target_path = os.path.join(font_target_dir, font_name)
        minify(source_path, target_path, used_icon_dict)
</code></pre></div></figure><h3 id="运行压缩">运行压缩</h3><p>Windows下只能通过font forge自带的解释器了，打开这个FontForge interactive console。<br><img src="https://cimg1.17lai.site/data/2023/02/24/20230224203938.webp" width="255" height="183" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload alt="开始菜单中的FontForge interactive console"></p><figure><div class="code-area"><pre class="line-numbers language-none"><code class="language-none">D:\Program Files (x86)\FontForgeBuilds&gt;bin\ffpython.exe d:\Work\Dev\minifyFont\minify.py</code></pre></div></figure><p><img src="https://cimg1.17lai.site/data/2023/02/24/20230224204419.webp" width="1226" height="318" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload alt="压缩运行结果"></p><blockquote><p>只在 font awesome v5 上面测试成功！ V6 运行失败</p></blockquote><h2 id="使用webp图像格式来优化大小">使用webp图像格式来优化大小</h2><blockquote><p>把所有图像都转换为webp格式，可以极大减小图片体积，加快加载速度。</p></blockquote><h2 id="图片懒加载-2">图片懒加载</h2><blockquote><p>图片懒加载是提升网站性能和用户体验的一个非常很好方式，并且几乎所有的大型网站都使用到了，比如微博，仅把用户可见的部分显示图片，其余的都暂时不加载，做法就是：让所有图片元素src指向一个小的站位图片比如loading，并新增一个属性(如data-original)存放真实图片地址。每当页面加载（或者滚动条滚动），使用JS脚本将可视区域内的图片src替换回真实地址，并做请求重新加载。</p><ul><li>Don’t worry about lazyload SEO problem, because Google supports it already.</li></ul></blockquote><p>那么，赶快用起来吧！</p><p>在站点根目录执行下面的命令：</p><figure><div class="code-area"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">npm install hexo-lazyload-image --save
#或者使用yarn
yarn add hexo-lazyload-image</code></pre></div></figure><p>之后在站点配置文件下添加下面的代码</p><figure><div class="code-area"><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">lazyload:
  enable: true  # 是否开启图片懒加载
  onlypost: false  # 是否只对文章的图片做懒加载
  loadingImg: # eg ./images/loading.gif
  isSPA: false # optional. For performance considering, isSPA is added. If your theme is a SPA page, please set it as true
  preloadRatio: 3 # optional, default is 1</code></pre></div></figure><p>最后执行 <code>hexo clean &amp;&amp; hexo g &amp;&amp; hexo s</code> 就可以看到效果了。</p><p>存在问题：</p><p>查看大图，发现全部为 loading 加载图，原因是因为懒加载插件与 lightgallery 插件冲突，解决办法如下：</p><p>修改主题文件下的 matery.js，在 108 行左右添加以下代码：</p><figure><div class="code-area"><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">$(document).find('img[data-original]').each(function(){
        $(this).parent().attr("href", $(this).attr("data-original"));
});</code></pre></div></figure><blockquote><h3 id="specify-no-lazy-for-specify-image">specify <strong>no-lazy</strong> for specify image</h3><p>we can also disable the lazy process if specify a attribute on img tag in both markdown or html</p><figure><div class="code-area"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">&lt;img no-lazy src="abc.png" /&gt;</code></pre></div></figure></blockquote><h3 id="Hexo-lazy-image-实现原理">Hexo-lazy-image 实现原理</h3><p>因为文章都是使用markdown来编写的，所以不可能要求我们在markdown里将所有图片路径都指向站位图片，并附加另一个属性，所以，这个工作必须留给hexo的generate部分来做。</p><p>最终可分为两步：</p><ol><li>在hexo <em>after_post_render</em>事件或者<em>after_render:html</em>事件里将生产出来的文章html代码中所有img元素都加上 data-original 属性，并把src值付给他， 然后在将src值致为loading图片</li><li>注入simple-lazyload脚本在每个页面最后面，当页面加载过后负责判定当前需要重新加载的图片。</li></ol><p>这里重点提提正则表达式，在对第一步替换的时候，只是使用了简单的正则表达式去匹配查找所有的img节点，后来发现不仅如此，正则表达式结合string.replace更是如此强大。</p><figure><div class="code-area"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">return htmlContent.replace(/&lt;img(\s*?)src="(.*?)"(.*?)&gt;/gi, function (str, p1, p2) {
        return str.replace(p2, loadingImage + '" data-original="' + p2);
    })</code></pre></div></figure><blockquote><p>另一种懒加载，需要自定义修改的比较多 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/verlok/vanilla-lazyload">vanilla-lazyload</a></p></blockquote><h2 id="博客写作工具">博客写作工具</h2><h3 id="FFMpeg">FFMpeg</h3><h4 id="将小视频转换成GIF动图">将小视频转换成GIF动图</h4><p>那么，如何能够将一个完整小视频，或一个长视频的某一部分转化成GIF动图呢？这里要使用一种多媒体工具：ffmpeg.</p><p>想将整个视频转换成GIF，你可以使用下面的命令：</p><figure><div class="code-area"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ffmpeg -i small.mp4 small.gif</code></pre></div></figure><p>想将一个视频里的指定的时间段转换成GIF，你可以使用下面的命令：</p><figure><div class="code-area"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ffmpeg -t 3 -ss 00:00:02 -i small.webm small-clip.gif</code></pre></div></figure><p>上面的命令是利用ffmpeg将从视频第二秒开始、时长为3秒的片段提取出、并转化成GIF动图。</p><p>如果各种参数保持缺省值，则转换后的图像的清晰度、分辨率并不是特别高，但这些参数你可以任意设置：</p><figure><div class="code-area"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ffmpeg -i small.mp4 -b 2048k small.gif</code></pre></div></figure><h4 id="将GIF动图转换成视频">将GIF动图转换成视频</h4><p>命令行的写法非常相似而简单：</p><figure><div class="code-area"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ffmpeg -f gif -i animation.gif animation.mp4</code></pre></div></figure><p>这个命令还可以让你选择性的将GIF图转换成各种视频格式：</p><figure><div class="code-area"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ffmpeg -f gif -i animation.gif animation.mpeg

ffmpeg -f gif -i animation.gif animation.webm</code></pre></div></figure><h4 id="将MP4、MPEG、MOV等格式的视频转换成WEBM格式的方法">将MP4、MPEG、MOV等格式的视频转换成WEBM格式的方法</h4><figure><div class="code-area"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ffmpeg -i trailer.mov -c:v libvpx -crf 10 -b:v 1M -c:a libvorbis trailer.webm</code></pre></div></figure><p><strong>让Apache Servers支持WEBM格式</strong></p><p>因为WEBM是一种新的文件格式，你需要让Apache服务器认识这种后缀。下面就是通过修改.htaccess来让Apache支持它：</p><figure><div class="code-area"><pre class="line-numbers language-nginx" data-language="nginx"><code class="language-nginx">AddType video/webm webm</code></pre></div></figure><h4 id="用gifsicle优化GIF动图">用gifsicle优化GIF动图</h4><p>大部分的GIF动图都是要放在网页上，最终下载到用户的浏览器里，所以，优化这些GIF图片的体积是十分必要的，这里我们就需要用到另外一个非常有用的GIF图片修改工具：<a target="_blank" rel="noopener external nofollow noreferrer" href="http://www.lcdf.org/gifsicle/">gifsicle</a>，它有一个内置的方法能够优化GIF动图的体积。</p><p><em>在开始介绍对GIF图片的优化方法前，你需要知道的一点是，gifsicle不仅仅是GIF图片优化工具。gifsicle还可以调整GIF图片的大小，合并多个GIF动图等等任何你能想到的对GIF图片的操作。</em></p><p>gifsicle 对GIF图片有三种优化选项：</p><ul><li><code>-O1</code> 只保存每张图像上变化的部分。这是缺省模式。</li><li><code>-O2</code> 进一步用透明度压缩图片。</li><li><code>-O3</code> 尝试各种优化方法(通常速度会慢一些，有时会产生更好的效果)。</li></ul><p>优化GIF动图的命令行写法是这样的：</p><figure><div class="code-area"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">gifsicle -O3 animation.gif -o animation-optimized.gif</code></pre></div></figure><p>如果你有耐心和时间，推荐你尝试一下<code>-O3</code>，它有可能会给你输出体积更小的GIF动图。</p><h2 id="hexo插件hexo-minify">hexo插件hexo-minify</h2><blockquote><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/Lete114/Hexo-minify">Hexo-minify</a></p></blockquote><p>Hexo-minify 是一款 Hexo 压缩插件，它可以压缩 HTML、CSS、JS</p><h3 id="安装-2">安装</h3><figure><div class="code-area"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">npm install hexo-minify --save</code></pre></div></figure><h3 id="说明">说明</h3><blockquote><p>如需修改，可在Hexo配置文件内编辑覆盖 如果仅安装插件，并未填写相关配置，则使用默认配置信息</p></blockquote><p>默认配置信息</p><figure><div class="code-area"><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">## Hexo-minify Default Config Options
minify:
  js:
    enable: true
    ## 详细配置: https://github.com/mishoo/UglifyJS
    options:
  css:
    enable: true
    ## 详细配置: https://github.com/clean-css/clean-css#compatibility-modes
    options:
  html:
    enable: true
    ## 详细配置: https://github.com/kangax/html-minifier#options-quick-reference
    options: 
      minifyJS: true # Compressed JavaScript
      minifyCSS: true # CSS Compressed
      removeComments: true # Remove the comments
      collapseWhitespace: true # Delete any extra space
      removeAttributeQuotes: true # Delete attribute quotes
  # + 1.2.0 版本新增
  postcss:
    enable: true
    ## 详细配置: https://github.com/postcss/autoprefixer#options
    ## 注意Hexo-minify仅内置了autoprefixer插件
    ## 受Hexo限制，目前无法实现自定义postcss插件
    options: 
      # JavaScript 数组写法
      # overrideBrowserslist: ['&gt; 1%', 'last 2 versions', 'not dead']
      # YAML 数组写法
      overrideBrowserslist: 
        - '&gt; 1%' # 特殊符号需要使用'或"
        - last 2 versions
        - not dead</code></pre></div></figure><h2 id="hexo插件hexo-filter-lqip">hexo插件hexo-filter-lqip</h2><blockquote><ul><li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/hexojs/hexo-filter-lqip">hexo-filter-lqip</a></li><li>A Hexo plugins which helps to introduce low quality image placeholders to the theme</li><li>不支持hexo5.x以上版本，可以强制安装 <code>-f</code>，实现方法可以借鉴</li></ul></blockquote><h3 id="Installation">Installation</h3><figure><div class="code-area"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">npm i hexo-filter-lqip --save</code></pre></div></figure><h3 id="Usage">Usage</h3><p>Install this plugin for the theme and use the view helper to render a placeholder.</p><h3 id="lqipFor-view-helper">lqipFor view helper</h3><figure><div class="code-area"><pre class="line-numbers language-none"><code class="language-none">lqipFor(path_to_asset, options)</code></pre></div></figure><ul><li><p><strong>String</strong> *path_to_asset - a path to the image</p></li><li><p>Object</p><p>options</p><ul><li><strong>String</strong> <em>[type]</em> - a type of placeholder, see the list of <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/hexojs/hexo-filter-lqip#available-types">available types</a>, defaults to the <code>default_type</code> as configured</li></ul></li></ul><p>Returns a CSS value for <code>background-image</code> property, which is a simplified version of the original image.</p><p>Example for EJS</p><figure><div class="code-area"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">&lt;div
  style="background-image: &lt;%- lqip_for('/content/my-photo.jpg') %&gt;"
&gt;&lt;/div&gt;</code></pre></div></figure><h2 id="iframe-Lazy-Loading">iframe Lazy Loading</h2><h3 id="现代浏览器">现代浏览器</h3><p>支持 loading 参数，让浏览器滚动到 iframe 附近再价值啊 iframe</p><figure><div class="code-area"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">&lt;iframe src="https://blog.17lai.site" loading="lazy" /&gt;</code></pre></div></figure><p>loading 参数：</p><ul><li><code>lazy</code>: good candidate for lazy-loading</li><li><code>eager</code>: not a good candidate for lazy-loading, loads right away</li><li><code>auto</code>: the browser determines whether or not to lazily load</li></ul><h3 id="老旧浏览器兼容">老旧浏览器兼容</h3><p>检查 HTMLIFrameElement 是否有 loading 属性</p><figure><div class="code-area"><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">if ('loading' in HTMLIFrameElement.prototype) {
  // Native image lazy-loading is available
} else {
  // Use polyfill or a 3rd-party library
}</code></pre></div></figure><h4 id="完整代码">完整代码</h4><figure><div class="code-area"><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">&lt;iframe class="lazyload" data-src="https://blog.17lai.site"&gt;
&lt;/iframe&gt;</code></pre></div></figure><figure><div class="code-area"><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">if ('loading' in HTMLIFrameElement.prototype) {
  const iframes = document.querySelectorAll('iframe[loading="lazy"]');
  iframes.forEach(iframe =&gt; {
    iframe.src = iframe.dataset.src;
  });
} else {
  // Dynamically import the LazySizes library
  const script = document.createElement('script');
  script.src =
    'https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.2.2/lazysizes.min.js';
  document.body.appendChild(script);
}</code></pre></div></figure><h3 id="jquery-lazyloading">jquery lazyloading</h3><blockquote><p>Jquery 实现的按键加载 iframe</p></blockquote><figure><div class="code-area"><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">var iframes = $('iframe');

$('button').click(function() {
    iframes.attr('src', function() {
        return $(this).data('src');
    });
});

iframes.attr('data-src', function() {
    var src = $(this).attr('src');
    $(this).removeAttr('src');
    return src;
});</code></pre></div></figure><h2 id="gulp-体积压缩">gulp 体积压缩</h2><blockquote><ul><li>减小体积，加快加载速度</li><li>因为 hexo 生成的 html、css、js 等都有很多的空格或者换行，而空格和换行也是占用字节的，所以需要将空格换行去掉也就是我要进行的 “压缩”。</li></ul></blockquote><figure><div class="code-area"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">npm install gulp -g
# 安装各种小功能模块  执行这步的时候，可能会提示权限的问题，最好以管理员模式执行
npm install gulp gulp-htmlclean gulp-htmlmin gulp-minify-css gulp-uglify gulp-imagemin --save
# 额外的功能模块
npm install gulp-debug gulp-clean-css gulp-changed gulp-if gulp-plumber gulp-babel babel-preset-es2015 del @babel/core --save
 
或者使用yarn 
 
yarn global add gulp
yarn add gulp gulp-htmlclean gulp-htmlmin gulp-minify-css gulp-uglify gulp-imagemin
yarn add gulp-debug gulp-clean-css gulp-changed gulp-if gulp-plumber gulp-babel babel-preset-es2015 del @babel/core</code></pre></div></figure><blockquote><ul><li>npm下载太慢怎么办？ 修改国内淘宝源加速，<a href="/posts/40300608/#npm%E4%B8%8B%E8%BD%BD%E5%8A%A0%E9%80%9F">戳</a></li></ul></blockquote><p>然后，在根目录新增 <code>gulpfile.js</code> :</p><figure><div class="code-area"><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">var gulp = require("gulp");
var debug = require("gulp-debug");
var cleancss = require("gulp-clean-css"); //css压缩组件
var uglify = require("gulp-uglify"); //js压缩组件
var htmlmin = require("gulp-htmlmin"); //html压缩组件
var htmlclean = require("gulp-htmlclean"); //html清理组件
var imagemin = require("gulp-imagemin"); //图片压缩组件
var changed = require("gulp-changed"); //文件更改校验组件
var gulpif = require("gulp-if"); //任务 帮助调用组件
var plumber = require("gulp-plumber"); //容错组件（发生错误不跳出任务，并报出错误内容）
var isScriptAll = true; //是否处理所有文件，(true|处理所有文件)(false|只处理有更改的文件)
var isDebug = true; //是否调试显示 编译通过的文件
var gulpBabel = require("gulp-babel");
var es2015Preset = require("babel-preset-es2015");
var del = require("del");
var Hexo = require("hexo");
var hexo = new Hexo(process.cwd(), {}); // 初始化一个hexo对象

// 清除public文件夹
gulp.task("clean", function () {
    return del(["public/**/*"]);
});

// 下面几个跟hexo有关的操作，主要通过hexo.call()去执行，注意return
// 创建静态页面 （等同 hexo generate）
gulp.task("generate", function () {
    return hexo.init().then(function () {
        return hexo
            .call("generate", {
                watch: false
            })
            .then(function () {
                return hexo.exit();
            })
            .catch(function (err) {
                return hexo.exit(err);
            });
    });
});

// 启动Hexo服务器
gulp.task("server", function () {
    return hexo
        .init()
        .then(function () {
            return hexo.call("server", {});
        })
        .catch(function (err) {
            console.log(err);
        });
});

// 部署到服务器
gulp.task("deploy", function () {
    return hexo.init().then(function () {
        return hexo
            .call("deploy", {
                watch: false
            })
            .then(function () {
                return hexo.exit();
            })
            .catch(function (err) {
                return hexo.exit(err);
            });
    });
});

// 压缩public目录下的js文件
gulp.task("compressJs", function () {
    return gulp
        .src(["./public/**/*.js", "!./public/libs/**"]) //排除的js
        .pipe(gulpif(!isScriptAll, changed("./public")))
        .pipe(gulpif(isDebug, debug({ title: "Compress JS:" })))
        .pipe(plumber())
        .pipe(
            gulpBabel({
                presets: [es2015Preset] // es5检查机制
            })
        )
        .pipe(uglify()) //调用压缩组件方法uglify(),对合并的文件进行压缩
        .pipe(gulp.dest("./public")); //输出到目标目录
});

// 压缩public目录下的css文件
gulp.task("compressCss", function () {
    var option = {
        rebase: false,
        //advanced: true, //类型：Boolean 默认：true [是否开启高级优化（合并选择器等）]
        compatibility: "ie7" //保留ie7及以下兼容写法 类型：String 默认：''or'*' [启用兼容模式； 'ie7'：IE7兼容模式，'ie8'：IE8兼容模式，'*'：IE9+兼容模式]
        //keepBreaks: true, //类型：Boolean 默认：false [是否保留换行]
        //keepSpecialComments: '*' //保留所有特殊前缀 当你用autoprefixer生成的浏览器前缀，如果不加这个参数，有可能将会删除你的部分前缀
    };
    return gulp
        .src(["./public/**/*.css", "!./public/**/*.min.css"]) //排除的css
        .pipe(gulpif(!isScriptAll, changed("./public")))
        .pipe(gulpif(isDebug, debug({ title: "Compress CSS:" })))
        .pipe(plumber())
        .pipe(cleancss(option))
        .pipe(gulp.dest("./public"));
});

// 压缩public目录下的html文件
gulp.task("compressHtml", function () {
    var cleanOptions = {
        protect: /&lt;\!--%fooTemplate\b.*?%--&gt;/g, //忽略处理
        unprotect: /&lt;script [^&gt;]*\btype="text\/x-handlebars-template"[\s\S]+?&lt;\/script&gt;/gi //特殊处理
    };
    var minOption = {
        collapseWhitespace: true, //压缩HTML
        collapseBooleanAttributes: true, //省略布尔属性的值 &lt;input checked="true"/&gt; ==&gt; &lt;input /&gt;
        removeEmptyAttributes: true, //删除所有空格作属性值 &lt;input id="" /&gt; ==&gt; &lt;input /&gt;
        removeScriptTypeAttributes: true, //删除&lt;script&gt;的type="text/javascript"
        removeStyleLinkTypeAttributes: true, //删除&lt;style&gt;和&lt;link&gt;的type="text/css"
        removeComments: true, //清除HTML注释
        minifyJS: true, //压缩页面JS
        minifyCSS: true, //压缩页面CSS
        minifyURLs: true //替换页面URL
    };
    return gulp
        .src("./public/**/*.html")
        .pipe(gulpif(isDebug, debug({ title: "Compress HTML:" })))
        .pipe(plumber())
        .pipe(htmlclean(cleanOptions))
        .pipe(htmlmin(minOption))
        .pipe(gulp.dest("./public"));
});

// 压缩 public/medias 目录内图片
gulp.task("compressImage", function () {
    var option = {
        optimizationLevel: 5, //类型：Number 默认：3 取值范围：0-7（优化等级）
        progressive: true, //类型：Boolean 默认：false 无损压缩jpg图片
        interlaced: false, //类型：Boolean 默认：false 隔行扫描gif进行渲染
        multipass: false //类型：Boolean 默认：false 多次优化svg直到完全优化
    };
    return gulp
        .src("./public/medias/**/*.*")
        .pipe(gulpif(!isScriptAll, changed("./public/medias")))
        .pipe(gulpif(isDebug, debug({ title: "Compress Images:" })))
        .pipe(plumber())
        .pipe(imagemin(option))
        .pipe(gulp.dest("./public"));
});
// 执行顺序： 清除public目录 -&gt; 产生原始博客内容 -&gt; 执行压缩混淆 -&gt; 部署到服务器
gulp.task(
    "cicd",
    gulp.series(
        "clean",
        "generate",
        "compressHtml",
        "compressCss",
        "compressJs",
        "compressImage",
        gulp.parallel("deploy")
    )
);
gulp.task(
    "ci",
    gulp.series(
        "clean",
        "generate",
        gulp.parallel("compressHtml", "compressCss", "compressJs","compressImage")
    )
);
// 默认任务
gulp.task(
    "default",
    gulp.series(
        gulp.parallel("compressHtml", "compressCss", "compressJs","compressImage")
    )
);
//Gulp4最大的一个改变就是gulp.task函数现在只支持两个参数，分别是任务名和运行任务的函数</code></pre></div></figure><p>运行：</p><figure><div class="code-area"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hexo clean &amp;&amp; hexo g &amp;&amp; gulp &amp;&amp;  hexo g</code></pre></div></figure><p>直接在 <code>Hexo</code> 根目录执行 <code>gulp ci</code>，这个命令相当于 hexo cl&amp;&amp;hexo g 并且再把代码和图片压缩。 在 Hexo 根目录执行 gulp cicd ，这个命令与 <code>gulp ci</code>相比是：在最后又加了个 hexo d ，等于说生成、压缩文件后又帮你自动部署了</p><p>如果不想用图片压缩可以把"compressImage" 去掉即可</p><h2 id="Docker版Imagin"><code>Docker</code>版<code>Imagin</code></h2><blockquote><p>使用Docker版本的imagemin来压缩图片！一行命令搞定！</p><p>gulp-imagemin相关的依赖，以及配置太TMD复杂了，博主新的Docker里面配置很久没搞定，虽然以前搞定过，囧rz! 如是去找了一下Docker镜像，立马搞定！</p><p><code>docker run -v `pwd`:/work mitakeck/imagemin</code></p><p>源代码 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/mitakeck/docker-imagemin">mitakeck/docker-imagemin</a></p></blockquote><h2 id="Python图片无损压缩">Python图片<strong>无损压缩</strong></h2><blockquote><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/xinlin-z/smally">xinlin-z/smally</a></p><p>jpg,png.webp图片无损压缩工具！说明去项目主页看。有中文说明。</p><p>最近作者更新了新版本，以前bug都解决了，使用完美！</p></blockquote><p>使用教程O(∩_∩)O</p><figure><div class="code-area"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">git clone https://github.com/xinlin-z/smally.git
cd smally
git checkout newstart
sudo bash install_tools.sh
# Run Test
bash test.sh
# Usage
find &lt;path/to/image_folder&gt; -type f -exec bash smally.sh {} \;</code></pre></div></figure><h2 id="本地搜索优化">本地搜索优化</h2><p>html、css和js都压缩了，很开心。但是，还有一个大文件没有压缩，就是本地搜索的DB文件search.xml。这个search.xml文件的大小为7.5M，很大。<br>打开search.xml文件，发现里面不止包含文章内容，还包含html标签。参考hexo-generator-searchdb，发现可以设置不生成标签。</p><ul><li>修改hexo/_config.yml的localsearch配置为：</li></ul><figure><div class="code-area"><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"># local search
search:
  path: search.xml
  field: post
  format: striptags
  limit: 10000</code></pre></div></figure><ul><li>重新生成search.xml文件</li><li>还可以给search.xml添加上jsdelivr cdn 加速！</li></ul><blockquote><p>本教程还有其它五大部分，更多内容请见<a href="/posts/9b056c86/#Hexo%E7%B3%BB%E5%88%97">Hexo系列教程</a></p></blockquote><h2 id="系列教程"><strong>系列教程</strong></h2><p><a href="/atom.xml"><i class="fas fa-rss"></i>全部文章RSS订阅</a></p><h3 id="Hexo系列"><strong>Hexo系列</strong></h3><p><a href="/categories/hexo/atom.xml"><i class="fas fa-rss"></i><strong>HexoRSS分类订阅</strong></a></p><p>[十万字图文教程]基于Hexo的matery主题搭建博客并深度优化完全一站式教程</p><ul><li><a href="/posts/40300608/">Hexo Docker环境与Hexo基础配置篇</a></li><li><a href="/posts/4d8a0b22/">hexo博客自定义修改篇</a></li><li><a href="/posts/9b056c86/">hexo博客网络优化篇</a></li><li><a href="/posts/5311b619/">hexo博客增强部署篇</a></li><li><a href="/posts/4a2050e2/">hexo博客个性定制篇</a></li><li><a href="/posts/84b4059a/">hexo博客常见问题篇</a></li><li><a href="/posts/253706ff/">hexo博客博文撰写篇之完美笔记大攻略终极完全版</a></li><li><a href="/posts/cf0f47fd/">Hexo Markdown以及各种插件功能测试</a></li></ul><blockquote><ul><li>markdown 各种其它语法插件，latex公式支持，mermaid图表，plant uml图表，URL卡片，bilibili卡片，github卡片，豆瓣卡片，插入音乐和视频，插入脑图，插入PDF，嵌入iframe</li></ul></blockquote><ul><li><a href="/posts/217ccdc1/">在 Hexo 博客中插入 ECharts 动态图表</a></li><li><a href="/posts/546887ac/">使用nodeppt给hexo博客嵌入PPT演示</a></li><li><a href="/posts/a3c81cc3/">GithubProfile美化与自动获取RSS文章教程</a></li><li><a href="/posts/e922fac8/">Vercel部署高级用法教程</a></li><li><a href="/posts/eb731135/">webhook部署Hexo静态博客指南</a></li><li><a href="/posts/8f9792ab/">在宝塔VPS上面采用docker部署waline全流程图解教程</a></li><li><a href="/posts/843eb2k9/">自建Umami访问统计服务并统计静态博客UV/PV</a></li></ul><h3 id="笔记系列"><strong>笔记系列</strong></h3><p><a href="/categories/note/atom.xml"><i class="fas fa-rss"></i><strong>Note分类RSS订阅</strong></a></p><ul><li><a href="/posts/a8535f26/">完美笔记进化论</a></li><li><a href="/posts/253706ff/">hexo博客博文撰写篇之完美笔记大攻略终极完全版</a></li><li><a href="/posts/e6086437/">Joplin入门指南&amp;实践方案</a></li><li><a href="/posts/45f878cd/">替代Evernote免费开源笔记Joplin-网盘同步笔记历史版本Markdown可视化</a></li><li><a href="/posts/92d347d6/">Joplin 插件以及其Markdown语法。All in One!</a></li><li><a href="/posts/e3ee7f8b/">Joplin 插件使用推荐</a></li><li><a href="/posts/1802a8a7/">为知笔记私有化Docker部署</a></li></ul><h3 id="Gitbook使用系列"><strong>Gitbook使用系列</strong></h3><p><a href="/categories/gitbook/atom.xml"><i class="fas fa-rss"></i>Gitbook分类RSS订阅</a></p><ul><li><a href="/posts/7fe86002/">GitBook+GitLab撰写发布技术文档-Part1:GitBook篇</a></li><li><a href="/posts/7790e989/">GitBook+GitLab撰写发布技术文档-Part2:GitLab篇</a></li><li><a href="/posts/d6bad1e5/">自己动手制作电子书的最佳方式（支持PDF、ePub、mobi等格式）</a></li></ul><h3 id="Gitlab-使用系列"><strong>Gitlab 使用系列</strong></h3><p><a href="/categories/gitlab/atom.xml"><i class="fas fa-rss"></i><strong>Gitlab RSS 分类订阅</strong></a></p><ul><li><a href="/posts/acc13b70/"><strong>Gitlab的安装及使用教程完全版</strong></a></li><li><a href="/posts/29a820b3/">破解Gitlab EE</a></li><li><a href="/posts/d08eb7b/">Gitlab的安装及使用</a></li><li><a href="/posts/1879721e/">CI/CD与Git Flow与GitLab</a></li></ul></div><hr><div class="reprint" id="reprint-statement"><div class="reprint__author"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-user">作者: </i></span><span class="reprint-info"><a href="https://blog.17lai.site" rel="external nofollow noreferrer">夜法之书</a></span></div><div class="reprint__type"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-link">文章链接: </i></span><span class="reprint-info"><a href="https://blog.17lai.site/posts/9b056c86/">https://blog.17lai.site/posts/9b056c86/</a></span></div><div class="reprint__notice"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-copyright">版权声明: </i></span><span class="reprint-info">本博客所有文章除特別声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://blog.17lai.site" target="_blank">夜法之书</a> !</span></div></div><div class="tag_share" style="display:block"><div class="post-meta__tag-list" style="display:inline-block"><div class="article-tag"><a href="/tags/github/"><span class="chip bg-color">github</span> </a><a href="/tags/hexo/"><span class="chip bg-color">hexo</span> </a><a href="/tags/matery/"><span class="chip bg-color">matery</span> </a><a href="/tags/cdn/"><span class="chip bg-color">cdn</span> </a><a href="/tags/seo/"><span class="chip bg-color">seo</span></a></div></div><div class="post_share" style="zoom:80%;width:fit-content;display:inline-block;float:right;margin:-.15rem 0"><div id="article-share"><div class="social-share" data-sites="twitter,facebook,qq,qzone,wechat,weibo,douban" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div></div></div></div><div id="reward"><a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a><div id="rewardModal" class="modal"><div class="modal-content"><a class="close modal-close" href="javascript:;" rel="external nofollow noreferrer" aria-label="打赏作者"><i class="fa fa-times-circle"></i></a><p class="reward-title">码字辛苦，打赏作者！</p><div class="reward-content"><div class="reward-tabs"><ul class="tabs row"><li class="tab col s6 alipay-tab"><a href="#alipay">支付宝</a></li><li class="tab col s6 wechat-tab"><a href="#wechat">微 信</a></li></ul><div id="alipay"><img src="/medias_webp/reward/alipay.webp" width="511" height="511" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload loading="lazy" class="reward-img" alt="支付宝打赏二维码"></div><div id="wechat"><img src="/medias_webp/reward/wechat.webp" width="595" height="580" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload loading="lazy" class="reward-img" alt="微信打赏二维码"></div></div></div></div></div></div><div class="webpush-dingyue" style="margin:10px 0;text-align:center"><div id="webpushr-subscription-button" data-size="small" data-button-text="订阅博文" data-subscriber-count-text="个用户已订阅" data-background-color="#6295d0"></div></div></div></div><article id="comments" lazyload><div class="card waline-card" data-aos="fade-up"><div class="comment_headling" style="font-size:20px;font-weight:700;position:relative;padding-left:20px;top:15px;padding-bottom:5px"><i class="fas fa-comments fa-fw" aria-hidden="true"></i> <span>评论</span></div><div class="center hvcenter" id="loading_data"><i class="fas fa-spinner fa-pulse"></i> <span>数据加载中 ...</span></div><div id="waline" class="card-content" style="display:grid"></div></div><div id="to_comment" data-umami-event-commentbtn="comment btn click" class="comment-scroll"><a class="btn-floating btn-large waves-effect waves-light" href="javascript:;" rel="external nofollow noreferrer" title="直达评论"><i class="fas fa-comments"></i></a></div></article><article id="prenext-posts" class="prev-next articles"><div class="row article-row"><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge left-badge text-color"><i class="fas fa-chevron-left"></i>&nbsp;上一篇</div><div class="card"><a href="/posts/5311b619/"><div class="card-image card-image-V"><div class="box-content"><p class="title">阅读全文</p><span class="post" style="width:180px">基于Hexo的matery主题搭建博客增强部署篇4</span></div><img src="/medias_webp/cover/hexo.webp" width="1064" height="560" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload class="responsive-img" alt="基于Hexo的matery主题搭建博客增强部署篇4"> <span class="card-title title-V">基于Hexo的matery主题搭建博客增强部署篇4</span></div></a><div class="card-content article-content"><div class="summary block-with-text">如果你想自动化部署怎么办？同时部署到多个空间怎么办？如何多种方法同时使用，多线路负载均衡访问了？本篇文章帮助你一一实现！</div><div class="publish-info"><span class="publish-date"><i class="far fa-clock fa-fw icon-date"></i>2022-03-27 </span><span class="publish-author"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="/categories/hexo/" class="post-category">hexo</a></span></div></div><div class="card-action article-tags"><a href="/tags/github/"><span class="chip bg-color">github</span> </a><a href="/tags/hexo/"><span class="chip bg-color">hexo</span> </a><a href="/tags/matery/"><span class="chip bg-color">matery</span> </a><a href="/tags/cdn/"><span class="chip bg-color">cdn</span> </a><a href="/tags/seo/"><span class="chip bg-color">seo</span></a></div></div></div><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge right-badge text-color">下一篇&nbsp;<i class="fas fa-chevron-right"></i></div><div class="card"><a href="/posts/4d8a0b22/"><div class="card-image card-image-V"><div class="box-content"><p class="title">阅读全文</p><span class="post" style="width:180px">基于Hexo的matery主题搭建博客自定义修改篇2</span></div><img src="/medias_webp/cover/hexo.webp" width="1064" height="560" srcset="/medias_webp/loading2.svg" loading="lazy" lazyload class="responsive-img" alt="基于Hexo的matery主题搭建博客自定义修改篇2"> <span class="card-title title-V">基于Hexo的matery主题搭建博客自定义修改篇2</span></div></a><div class="card-content article-content"><div class="summary block-with-text">通过第一篇你已经有一个基本完整的博客了，现在可以进行各种各样自定义修改，添加音视频支持，字体修改，图形美化等等，让你的博客功能更加强大，界面更美观。</div><div class="publish-info"><span class="publish-date"><i class="far fa-clock fa-fw icon-date"></i>2022-03-27 </span><span class="publish-author"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="/categories/hexo/" class="post-category">hexo</a></span></div></div><div class="card-action article-tags"><a href="/tags/github/"><span class="chip bg-color">github</span> </a><a href="/tags/hexo/"><span class="chip bg-color">hexo</span> </a><a href="/tags/matery/"><span class="chip bg-color">matery</span> </a><a href="/tags/cdn/"><span class="chip bg-color">cdn</span> </a><a href="/tags/seo/"><span class="chip bg-color">seo</span></a></div></div></div></div></article></div></div><div id="toc-aside" class="col l3 hide-on-med-and-down isTocHide" style="display:none"><div id="aside-container" style="display:flex;flex-direction:column"><div class="toc-widget card"><div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div><div id="toc-content"></div></div></div></div></div><div id="floating-toc-btn" data-umami-event-tocbtn="toc btn click" class="hide-on-med-and-down"><a class="btn-floating btn-large bg-color" href="javascript:;" rel="external nofollow noreferrer" title="显示/隐藏目录"><i class="fas fa-list-ul"></i></a></div></main><footer class="page-footer bg-color"><div class="container row center-align" style="margin-bottom:15px!important"><div class="col s12 m8 l8 copy-right">Copyright&nbsp;&copy; <span id="year">2020-2025</span> <a href="/about" target="_blank">夜法之书</a> |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" rel="external nofollow noreferrer" target="_blank">Hexo</a> |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" rel="external nofollow noreferrer" target="_blank">Matery</a> <span id="translate">|&nbsp;繁/简：</span><a id="translateLink" role="button" aria-label="切换简繁体">繁</a><br>&nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span class="white-color">821.5k</span> <span id="busuanzi_container_site_pv" style="display:none">&nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp; <span id="busuanzi_value_site_pv" class="white-color"></span><i id="busuanzi_loading_icon_site_pv" class="fas fa-sync fa-spin"></i> </span><span id="busuanzi_container_site_uv" style="display:none">&nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp; <span id="busuanzi_value_site_uv" class="white-color"></span><i id="busuanzi_loading_icon_site_uv" class="fas fa-sync fa-spin"></i></span><br><span id="sitetime">Loading ...</span><script>var calcSiteTime=function(){var e=new Date,t=e.getFullYear(),n=e.getMonth()+1,i=e.getDate(),a=e.getHours(),r=e.getMinutes(),s=e.getSeconds(),o=Date.UTC("2020","6","28","0","0","0"),g=Date.UTC(t,n,i,a,r,s)-o,d=Math.floor(g/31536e6),m=Math.floor(g/864e5-365*d);if("2020"===String(t)){document.getElementById("year").innerHTML=t;var l="This site has been running for "+m+" days";l="本站已运行 "+m+" 天",document.getElementById("sitetime").innerHTML=l}else{document.getElementById("year").innerHTML="2020 - "+t;var c="This site has been running for "+d+" years and "+m+" days";c="本站已运行 "+d+" 年 "+m+" 天",document.getElementById("sitetime").innerHTML=c}};calcSiteTime()</script><br></div><div class="col s12 m4 l4 social-link social-statis"><a href="https://github.com/appotry" rel="external nofollow noreferrer" class="tooltipped" target="_blank" aria-label="访问我的GitHub" data-tooltip="访问我的GitHub" data-position="top" data-delay="50"><i class="fab fa-github fa-fw"></i> </a><a href="https://hub.docker.com/u/bloodstar" rel="external nofollow noreferrer" class="tooltipped" target="_blank" aria-label="访问我的DockerHub" data-tooltip="访问我的DockerHub" data-position="top" data-delay="50"><i class="fab fa-docker fa-fw"></i> </a><a href="mailto:admin@17lai.fun" rel="external nofollow noreferrer" class="tooltipped" target="_blank" aria-label="邮件联系我" data-tooltip="邮件联系我" data-position="top" data-delay="50"><i class="fas fa-envelope-open fa-fw"></i> </a><a href="/atom.xml" class="tooltipped" target="_blank" aria-label="RSS 订阅" data-tooltip="RSS 订阅" data-position="top" data-delay="50"><i class="fas fa-rss fa-fw"></i></a></div></div></footer><div class="progress-bar"></div><div id="searchModal" class="modal"><div class="modal-content"><div class="search-header center"><span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span> <a class="close modal-close" href="javascript:;" rel="external nofollow noreferrer" title="关闭搜索"><span class="popup-btn-close" role="button"><i class="fas fa-times"></i></span></a></div><div class="center hvcenter" id="loading_search_data"><i class="fas fa-spinner fa-pulse"></i> <span>数据加载中 ...</span></div><div id="searchWrap" class="search-wrap" style="display:none"><div class="search-input-container"><input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字" class="search-input"></div><div id="searchResult"></div></div></div></div><div id="backTop" data-umami-event-backtop="backtop click" class="top-scroll"><a class="btn-floating btn-large waves-effect waves-light" href="#" title="回到顶部"><i class="fas fa-arrow-up"></i></a></div><script src="/js/ana.js?v=1.1.1" async></script><script type="module" async>import{commentCount}from"/libs/waline/comment.js?v=3.6.0";function upDateComment(){const e=commentCount({serverURL:"https://waline.17lai.site",path:"/posts/9b056c86/"});setTimeout(()=>e(),3e3);try{var n="waline_comments_count",t=document.getElementById(n);t?(t.style.display="inline-block",document.getElementById("waline_commentcount_loading_icon").style.display="none",console.log("[waline] Comment count updated successfully!")):console.log("[waline] Element with id '"+n+"' not found.")}catch(e){console.log("[waline-count][Error] err")}console.log("[waline]update comment count!")}function delayUpDateComment(){setTimeout((function(){upDateComment()}),3e3),console.log("[waline]delay update comment count!")}delayUpDateComment()</script><script>$(document).ready((function(){let e,n=$(".carousel"),c=!1;n.carousel({duration:Number("180"),fullWidth:!0,indicators:!0,onCycleTo(){var e;c||(e=this,setInterval(()=>{(e.pressed||e.dragged)&&r()},1e3),c=!0)}});let t=function(){e=setInterval((function(){n.carousel("next")}),8e3)};function r(){clearInterval(e),t()}t(),$("#prev-cover").click((function(){n.carousel("prev"),r()})),$("#next-cover").click((function(){n.carousel("next"),r()}))}))</script><script type="text/javascript">function handleSearchClick(){document.getElementById("searchModal");var e=document.getElementById("searchInput"),t=document.getElementById("searchResult");e.value="",t.innerHTML="",downXmlData("https://cfblog.17lai.site/search.xml").then(n=>{searchFunc(n,e,t)}).catch(e=>{console.error("Error downloading XML data:",e)})}var downXmlData=function(e){"use strict";return new Promise((t,n)=>{$.ajax({url:e,dataType:"xml",success:function(e){console.log("SUCCESS 下载玩搜索数据库文件"),document.getElementById("loading_search_data").style.display="none",document.getElementById("searchWrap").style.display="inline",document.getElementById("searchInput").focus(),t(e)},error:function(e,t,r){n(r)}})})},searchFunc=function(e,t,n){"use strict";var r=$("entry",e).map((function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}})).get();t.addEventListener("input",(function(){var e='<ul class="search-result-list">';if(n.innerHTML="",!(this.value.trim().length<=0)){var t=this.value.trim().toLowerCase().split(/[\s\-]+/),a=[];r.forEach((function(e){var n=!0,r=e.title.trim().toLowerCase(),c=e.content.trim().replace(/<[^>]+>/g,"").toLowerCase(),l=e.url;l=0===l.indexOf("/")?e.url:"/"+l;var s=-1,i=-1,o=[];""!==r&&""!==c&&t.forEach((function(e){s=r.indexOf(e),i=c.indexOf(e),s<0&&i<0?n=!1:(i<0&&(i=0),o.push(i))})),n&&a.push({title:e.title,content:e.content,url:e.url,first_occurs:o})}));var c=a.length;a.forEach((function(n,r){var a=n.title;t.forEach((function(e){var t=new RegExp(e,"gi");a=a.replace(t,'<em class="search-keyword">'+e+"</em>")})),e+="<li><a href='"+n.url+"' class='search-result-title'>"+(r+1)+"/"+c+" "+a+"</a>";var l=n.content.trim().replace(/<[^>]+>/g,""),s=[];n.first_occurs.forEach((function(e,n){if(e>=0){var r=e-20,a=e+80;r<0&&(r=0),0===r&&(a=100),a>l.length&&(a=l.length);var c=l.substr(r,a),i=t[n],o=new RegExp(i,"gi");c=c.replace(o,'<em class="search-keyword">'+i+"</em>"),s.push('<p class="search-result">'+c+"...</p>")}})),e+=s.join(""),e+="</li>"})),e+="</ul>",n.innerHTML=e}}))}</script><script>$((function(){$(".modal-trigger").click((function(){$(".modal").modal()})),$(".tabs").tabs()}))</script><div class="waifu"><div class="waifu-tips"></div><canvas id="live2d" class="live2d"></canvas><div class="waifu-tool"><span class="fa fa-lg fa-home"></span> <span class="fa fa-lg fa-comment"></span> <span class="fa fa-lg fa-user-circle"></span> <span class="fa fa-lg fa-street-view"></span> <span class="fa fa-lg fa-camera-retro"></span> <span class="fa fa-lg fa-info-circle"></span> <span class="fa fa-lg fa-times-circle"></span></div></div><script src="/libs/materialize/materialize.min.js?v=1.2.2"></script><script src="/libs/masonry/masonry.pkgd.min.js?v=4.2.2"></script><script src="/libs/aos/aos.min.js?v=2.3.4"></script><script src="/js/events.js?v=1.0.0"></script><script src="/js/plugins.js?v=1.1.2"></script><script>document.addEventListener("DOMContentLoaded",()=>Matery.plugins.githubCardsLoader.init()),document.addEventListener("pjax:complete",()=>Matery.plugins.githubCardsLoader.init())</script><script src="/libs/typed/typed.umd.js?v=2.1.0"></script><script>jQuery(document).ready((function(){Matery.plugins.postTyped()}))</script><script>jQuery(document).ready((function(){Matery.plugins.subTitleTyped()}))</script><script type="text/javascript">inPageScroll()</script><script>var tocSchemaStorageKey=window.location.pathname.replace(/\/$/,"")+"/toc";Matery.utils.getLS(tocSchemaStorageKey)||Matery.utils.setLS(tocSchemaStorageKey,"hide")</script><script src="/libs/tocbot/tocbot.min.js?v=4.36.4"></script><script>$((function(){if(windowWidth<800)return!0;document.documentElement;var e=jQuery("#toc-aside .toc-widget");if(0===e.length||!window.tocbot)return;var t=jQuery("#headNav").height()+10,o=window.location.pathname.replace(/\/$/,"")+"/toc",s=Matery.utils.getLS(o);let l=$("#toc-aside"),i=$("#main-content");var n=e[0].getElementsByClassName("is-active-li");e[0].getElementsByClassName("toc-title");function a(){tocbot.init({tocSelector:"#toc-content",contentSelector:"#articleContent",headingsOffset:-t,scrollSmoothOffset:-t,collapseDepth:Number("0"),scrollSmooth:!0,headingSelector:"h1,h2,h3,h4,h5,h6"}),e.find(".toc-list-item").length>0&&e.css("visibility","visible")}window.onscroll=()=>{e.length>0&&(n.length>0&&n[0].offsetTop>e[0].offsetHeight&&(e[0].scrollTop=n[0].offsetTop-e[0].offsetHeight/2),n.length>0&&e[0].offsetHeight>n[0].offsetHeight&&(e[0].scrollTop=0),n.length>0&&n[0].offsetTop>e[0].offsetHeight&&(e[0].scrollTop=n[0].offsetTop-e[0].offsetHeight/2))},Matery.utils.getLS(o),("show"===s?(console.log("Current page toc: show"),l.addClass("expanded").show(),i.addClass("l9"),1):"hide"===s?(console.log("Current page toc: hide"),l.removeClass("expanded").hide(),i.removeClass("l9"),0):void console.log("Current page toc: unknow, use default"))&&a();let d=parseInt(.75*$(window).height()-64),r=$("#aside-container");$(window).scroll((function(){$(window).scrollTop()>d?r.addClass("toc-fixed"):r.removeClass("toc-fixed")})),fixPostCardWidth("artDetail","prenext-posts"),$("#floating-toc-btn .btn-floating").click((function(){l.hasClass("expanded")?(l.removeClass("expanded").hide(),i.removeClass("l9"),tocbot.destroy(),Matery.utils.setLS(o,"hide")):(a(),Matery.utils.setLS(o,"show"),l.addClass("expanded").show(),i.addClass("l9")),fixPostCardWidth("artDetail","prenext-posts"),AOS.refresh(),progressBarInit()}))}))</script><script>$("#articleContent").on("copy",(function(e){if(void 0!==window.getSelection){var n=window.getSelection();if(!((""+n).length<Number.parseInt("120"))){var t=document.getElementsByTagName("body")[0],o=document.createElement("div");o.style.position="absolute",o.style.left="-99999px",t.appendChild(o),o.appendChild(n.getRangeAt(0).cloneContents()),"PRE"!==n.getRangeAt(0).commonAncestorContainer.nodeName&&"CODE"!==n.getRangeAt(0).commonAncestorContainer.nodeName||(o.innerHTML="<pre>"+o.innerHTML+"</pre>");var i=document.location.href;o.innerHTML+='<br />来源: 夜法之书<br />作者: 夜法之书<br />文章链接: <a href="'+i+'">'+i+"</a><br />本文章著作权归作者所有，任何形式的转载都请注明出处。",n.selectAllChildren(o),window.setTimeout((function(){t.removeChild(o)}),200)}}}))</script><script>function navToReprintStatement(){$("html, body").animate({scrollTop:$("#reprint-statement").offset().top-80},800)}document.addEventListener("copy",(function(t){M.toast({html:'<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>'})}))</script><script>Matery.plugins.imgLazyload()</script><script src="/libs/scrollprogress/scrollProgress.min.js?v=3.0.2"></script><script src="/libs/lightGallery/js/lightgallery-all.min.js?v=1.10.0" defer importance="low"></script><script>Matery.plugins.languageToggle()</script><script type="text/javascript">localStorage.getItem("viewCount")?(localStorage.viewCount=Number(localStorage.viewCount)+1,console.log("[Matery]Welcome to visited again!")):(localStorage.setItem("viewCount","1"),console.log("[Matery]Welcome! New Reader!"))</script><script type="text/javascript">var themeStorage=window.localStorage;window.localStorage?(console.log("设定waline count title"),themeStorage.setItem("title","夜法之书")):console.log("浏览器不支持localstorage")</script><script type="text/javascript">if(windowWidth>minFunWidth&&Number(localStorage.viewCount)>2)try{$.ajax({url:"/libs/jquery/jquery-ui.min.js?v=1.14.0",dataType:"script",cache:!0,success:function(){$.ajax({url:"/libs/live2d/waifu-tips.js",dataType:"script",cache:!0,success:function(){$.ajax({url:"/libs/live2d/live2d.js",dataType:"script",cache:!0,success:function(){live2d_settings.modelId=2,live2d_settings.modelTexturesId=17,live2d_settings.modelStorage=!0,live2d_settings.canCloseLive2d=!0,live2d_settings.canTurnToHomePage=!1,live2d_settings.waifuDraggable="axis-x",live2d_settings.waifuDraggableRevert=!0,initModel("/libs/live2d/waifu-tips.json?v=1.0.1")}})}})}})}catch(e){console.log("[Live2d][Error] JQuery is not defined.")}</script><script src="/libs/tag-common/index.js" async></script><script type="module">import{init,commentCount}from"/libs/waline/waline.min.js?v=3.6.0";const locale={lang:"zh-cn",nick:"🧊 昵称",nickError:"昵称不能少于3个字符",mail:"📧 邮箱",mailError:"请填写正确的邮件地址",link:"🔗 网址",optional:"可选",placeholder:"🤣一起来玩，留下你的足迹吧~。评论支持邮箱回复通知！📧\r\n 🚀支持注册登录，并支持weibo QQ Github 社交登录(⊙o⊙)！💖\r\n 💣请文明评论哦禁止恶意评论🈲\r\n ⚠️公开网络空间，请不要发表任何包含个人或其他人的隐私信息⛔",sofa:"🌌 来发评论吧~",submit:"发送留言",like:"喜欢",cancelLike:"取消喜欢",reply:"回复",cancelReply:"取消回复",comment:"评论",refresh:"刷新",more:"加载更多评论...",preview:"预览",emoji:"表情",uploadImage:"上传图片",seconds:"秒前",minutes:"分钟前",hours:"小时前",days:"天前",now:"刚刚",uploading:"正在上传",login:"登录",logout:"退出",admin:"博主",sticky:"置顶",word:"个字",wordHint:"评论字数应在 $0 到 $1 字之间！\n当前字数：$2",anonymous:"匿名",level0:"潜水",level1:"冒泡",level2:"吐槽",level3:"活跃",level4:"话痨",level5:"传说",gif:"表情包",gifSearchPlaceholder:"搜索表情包",profile:"个人资料",approved:"通过",waiting:"待审核",spam:"垃圾",unsticky:"取消置顶",oldest:"按倒序",latest:"按正序",hottest:"按热度",reactionTitle:"雁过留声！人过留名！",reaction0:"赞一个",reaction1:"踩一下",reaction2:"有点酷",reaction3:"看不懂",reaction4:"啥玩意",reaction5:"想睡觉"};function initWaline(){console.log("[WALINE]init waline"),init({el:"#waline",locale:locale,serverURL:"https://waline.17lai.site",path:"/posts/9b056c86/",avatar:"mp",emoji:["//fastly.jsdelivr.net/gh/walinejs/emojis@latest/weibo"],lang:"zh-CN",dark:'html[data-user-color-scheme="dark"]',login:"enable",wordLimit:"1000",pageSize:"10",highlighter:(e,n)=>(window.Prism.languages[n]||window.Prism.plugins.autoloader.loadLanguages(n),window.Prism.highlight(e,window.Prism.languages[n]||window.Prism.languages.text,n)),pageview:!1,comment:!0,reaction:["https://testingcf.jsdelivr.net/npm/@waline/emojis/tieba/tieba_agree.png","https://testingcf.jsdelivr.net/npm/@waline/emojis/tieba/tieba_look_down.png","https://testingcf.jsdelivr.net/npm/@waline/emojis/tieba/tieba_sunglasses.png","https://testingcf.jsdelivr.net/npm/@waline/emojis/tieba/tieba_pick_nose.png","https://testingcf.jsdelivr.net/npm/@waline/emojis/tieba/tieba_awkward.png","https://testingcf.jsdelivr.net/npm/@waline/emojis/tieba/tieba_sleep.png"],search:!1,imageUploader:!1,meta:["nick","mail","link"],recaptchaV3Key:"6LeUY0MiAAAAABNBvi6m4PcCtKkv_W6x-_YhTb6n",requiredMeta:["nick","mail"]}),document.getElementById("loading_data").style.display="none";{function e(){const e=commentCount({serverURL:"https://waline.17lai.site",path:"/posts/9b056c86/"});setTimeout(()=>e(),2e3);try{wa_ccc="waline_comments_count",document.getElementById(wa_ccc).style.display="inline-block"}catch(e){console.log("[waline-count][Error] err")}console.log("[waline]update comment count!")}function n(){setTimeout((function(){e()}),5e3),console.log("[waline]delay update comment count!")}try{var i=document.body.getElementsByClassName("wl-btn primary");void 0!==i[0]?(void 0!==window.addEventListener?i[0].addEventListener("click",n,!1):i[0].attachEvent("onclick",n),e()):console.log("[waline]没有登录waline!")}catch(e){console.error("An error occurred while handling the element:",e)}}AOS.refresh(),progressBarInit()}function loadWaline(){try{const e=document.createElement("link");e.rel="stylesheet",e.href="/libs/waline/waline.min.css?v=3.6.0",document.head.appendChild(e);import("/libs/waline/waline.min.js?v=3.6.0").then(()=>{initWaline()}).catch(e=>{console.error("Failed to load waline script:",e)})}catch(e){console.log("[SHARE][Error] Failed to load Waline:",e)}}var runningOnBrowser="undefined"!=typeof window,isBot=runningOnBrowser&&!("onscroll"in window)||"undefined"!=typeof navigator&&/(gle|ing|ro|msn)bot|crawl|spider|yand|duckgo/i.test(navigator.userAgent),supportsIntersectionObserver=runningOnBrowser&&"IntersectionObserver"in window;setTimeout((function(){if(!isBot&&supportsIntersectionObserver){var e=new IntersectionObserver((function(n){n[0].isIntersecting&&(loadWaline(),e.disconnect())}),{threshold:[0]});e.observe(document.getElementById("comments"))}else loadWaline()}),1)</script><script defer>AOS.refresh(),progressBarInit()</script><script>function loadShare(){try{jQuery.ajax({url:"/libs/share/js/social-share.min.js?v=1.0.16",dataType:"script",cache:!0,success:function(){}})}catch(e){console.log("[SHARE][Error] JQuery is not defined.")}}var runningOnBrowser="undefined"!=typeof window,isBot=runningOnBrowser&&!("onscroll"in window)||"undefined"!=typeof navigator&&/(gle|ing|ro|msn)bot|crawl|spider|yand|duckgo/i.test(navigator.userAgent),supportsIntersectionObserver=runningOnBrowser&&"IntersectionObserver"in window;setTimeout((function(){if(!isBot&&supportsIntersectionObserver){var e=new IntersectionObserver((function(n){n[0].isIntersecting&&(loadShare(),e.disconnect())}),{threshold:[0]});e.observe(document.getElementById("article-share"))}else loadShare()}),1)</script><script type="text/javascript" defer>progressBarInit()</script><script type="text/javascript" size="150" alpha="0.6" zindex="-1" src="/libs/background/ribbon.min.js" async></script><script defer src="/libs/prism/components/prism-core.min.js"></script><script defer src="/libs/prism/plugins/autoloader/prism-autoloader.min.js"></script><script defer src="/libs/prism/plugins/line-numbers/prism-line-numbers.min.js"></script><script defer src="/libs/prism/plugins/autolinker/prism-autolinker.min.js"></script><script>Matery.plugins.codeWidget()</script><script defer src="/libs/instantpage/instantpage.min.js" type="module" importance="low"></script><script src="/js/boot.js?v=1.0.0"></script><noscript><div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div></noscript><script src="/assets/mmedia/mmedia-loader.js"></script><script src="/js/markmap.js"></script><script defer>if (localStorage.viewCount > 1) {
            (function (w, d, s, id) {
            if (typeof (w.webpushr) !== 'undefined' || isBot) return; 
            w.webpushr = w.webpushr || function () { (w.webpushr.q = w.webpushr.q || []).push(arguments) }; 
            var js, fjs = d.getElementsByTagName(s)[0]; 
            js = d.createElement(s); 
            js.id = id; 
            js.async = true; 
            js.src = "https://cdn.webpushr.com/app.min.js";
            fjs.parentNode.appendChild(js);
            }(window, document, 'script', 'webpushr-jssdk'));
            webpushr('setup', { 'key': 'BDHamjevXR9yPJrttxl80MjCYEwm3CKzwsi3rwMXxq4Lnbzhr2fNQARqXJVhfBn_ucmy9QHixa3qps8eEFXBwmw' });
        }</script></body></html>