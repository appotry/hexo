{
    "version": "https://jsonfeed.org/version/1",
    "title": "å¤œæ³•ä¹‹ä¹¦ â€¢ All posts by \"sql\" category",
    "description": "~è½¯ä»¶é©±åŠ¨ä¸–ç•Œ~ä¸ªäººç‹¬ç«‹æŠ€æœ¯åšå®¢ï¼Œå…³äºLinux,å¼€æºï¼ŒNasï¼ŒDockerï¼ŒåµŒå…¥å¼ï¼Œç†è´¢ï¼Œå¥èº«ç­‰ä¸»é¢˜ï¼",
    "home_page_url": "https://blog.17lai.site",
    "items": [
        {
            "id": "https://blog.17lai.site/posts/a416ccaa/",
            "url": "https://blog.17lai.site/posts/a416ccaa/",
            "title": "PostgreSQL å®ç°åŸç†æ·±åº¦å‰–æï¼šé«˜æ€§èƒ½æ•°æ®åº“å¼•æ“çš„æ ¸å¿ƒæœºåˆ¶",
            "date_published": "2025-11-22T07:57:38.000Z",
            "content_html": "<blockquote>\n<p>PostgreSQL ä½œä¸º<strong>æœ€å…ˆè¿›çš„å¼€æºå…³ç³»æ•°æ®åº“ç³»ç»Ÿ</strong>ï¼Œå…¶å†…éƒ¨å®ç°åŸç†ä½“ç°äº†æ•°æ®åº“é¢†åŸŸçš„å‰æ²¿è®¾è®¡ä¸å·¥ç¨‹æ™ºæ…§ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨ PostgreSQL çš„æ¶æ„è®¾è®¡ã€å­˜å‚¨æœºåˆ¶ã€å¹¶å‘æ§åˆ¶å’Œä¼˜åŒ–å™¨åŸç†ï¼Œå¹¶é€šè¿‡ä¸ MySQL çš„å¯¹æ¯”å±•ç¤ºå…¶<strong>ç‹¬ç‰¹ä¼˜åŠ¿</strong>ã€‚</p>\n</blockquote>\n<blockquote>\n<p><strong>è§†é¢‘</strong>ï¼š<a href=\"https://alist.17lai.site/%E5%A4%9A%E5%AA%92%E4%BD%93/Video/%E6%95%99%E7%A8%8B/%E5%85%BB%E6%B4%BB%E5%9B%BD%E5%86%85%E5%A4%A7%E5%8D%8A%E8%87%AA%E7%A0%94%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9B%A2%E9%98%9F%E7%9A%84PostgreSQL%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F.mp4\">å…»æ´»å›½å†…å¤§åŠè‡ªç ”æ•°æ®åº“å›¢é˜Ÿçš„PostgreSQLæ˜¯ä»€ä¹ˆï¼Ÿ</a></p>\n</blockquote>\n<span id=\"more\"></span>\n<h2 id=\"I-PostgreSQL-æ•´ä½“æ¶æ„\">I. PostgreSQL æ•´ä½“æ¶æ„</h2>\n<p>PostgreSQL é‡‡ç”¨<strong>å¤šè¿›ç¨‹æ¶æ„ (Process-based)</strong>ï¼Œæ¯ä¸ªå®¢æˆ·ç«¯è¿æ¥å¯¹åº”ä¸€ä¸ªç‹¬ç«‹çš„æœåŠ¡è¿›ç¨‹ã€‚è¿™ç§è®¾è®¡è™½ç„¶æ¯”çº¿ç¨‹æ¨¡å‹æ¶ˆè€—æ›´å¤šå†…å­˜ï¼Œä½†æä¾›äº†æé«˜çš„éš”ç¦»æ€§å’Œç¨³å®šæ€§â€”â€”ä¸€ä¸ªæŸ¥è¯¢çš„å´©æºƒç»ä¸ä¼šæ‹–å®æ•´ä¸ªæ•°æ®åº“ã€‚</p>\n<pre><code class=\"mermaid\">graph TD\n    Client[å®¢æˆ·ç«¯åº”ç”¨] --&gt;|TCP&#x2F;IP| Postmaster[Postmaster ä¸»å®ˆæŠ¤è¿›ç¨‹]\n    \n    subgraph &quot;è¿›ç¨‹æ¨¡å‹&quot;\n        Postmaster --&gt;|fork| Backend1[æœåŠ¡è¿›ç¨‹ 1: Backend]\n        Postmaster --&gt;|fork| Backend2[æœåŠ¡è¿›ç¨‹ 2: Backend]\n        Postmaster --&gt;|fork| Backend3[æœåŠ¡è¿›ç¨‹ 3: Backend]\n    end\n\n    subgraph &quot;å…±äº«å†…å­˜åŒºåŸŸ&quot;\n        SharedBuffer[Shared Buffer&lt;br&#x2F;&gt;å…±äº«ç¼“å†²åŒº]\n        WALBuffer[WAL Buffer&lt;br&#x2F;&gt;æ—¥å¿—ç¼“å†²åŒº]\n        \n        Backend1 &lt;--&gt; SharedBuffer\n        Backend2 &lt;--&gt; SharedBuffer\n        Backend3 &lt;--&gt; SharedBuffer\n        SharedBuffer &lt;--&gt; WALBuffer\n    end\n    \n    subgraph &quot;å…³é”®åå°è¿›ç¨‹&quot;\n        BgWriter[BgWriter&lt;br&#x2F;&gt;åå°å†™å…¥å™¨]\n        Checkpointer[Checkpointer&lt;br&#x2F;&gt;æ£€æŸ¥ç‚¹è¿›ç¨‹]\n        WALWriter[WAL Writer&lt;br&#x2F;&gt;æ—¥å¿—å†™å…¥å™¨]\n        Autovacuum[Autovacuum&lt;br&#x2F;&gt;è‡ªåŠ¨æ¸…ç†è¿›ç¨‹]\n    end\n    \n    SharedBuffer --&gt; BgWriter\n    WALBuffer --&gt; WALWriter\n    SharedBuffer --&gt; Checkpointer\n    SharedBuffer --&gt; Autovacuum\n    \n    BgWriter --&gt;|å†™å…¥è„é¡µ| Storage[æŒä¹…åŒ–å­˜å‚¨&lt;br&#x2F;&gt;æ•°æ®æ–‡ä»¶]\n    WALWriter --&gt;|å†™å…¥WAL| WALStorage[WALæ–‡ä»¶]\n    Checkpointer --&gt;|æ£€æŸ¥ç‚¹| Storage\n    Autovacuum --&gt;|æ¸…ç†| Storage\n</code></pre>\n<p><strong>æ ¸å¿ƒç»„ä»¶äº¤äº’æµç¨‹</strong>:</p>\n<ol>\n<li><strong>Postmaster</strong>ï¼šä¸»å®ˆæŠ¤è¿›ç¨‹ (PID 1 of PG)ï¼Œè´Ÿè´£ç›‘å¬ç«¯å£ (5432)ã€ç®¡ç†è¿æ¥è¯·æ±‚ã€æ¢å¤ç³»ç»Ÿã€‚</li>\n<li><strong>Server Process (Backend)</strong>ï¼šæ¯ä¸ªå®¢æˆ·ç«¯è¿æ¥å¯¹åº”ä¸€ä¸ª <code>postgres</code> å­è¿›ç¨‹ï¼Œè´Ÿè´£æ‰§è¡Œ SQLã€æ’åºã€è®¡ç®—ã€‚</li>\n<li><strong>Shared Buffer</strong>ï¼šæ‰€æœ‰è¿›ç¨‹å…±äº«çš„å†…å­˜æ± ï¼Œç”¨äºç¼“å­˜æ•°æ®é¡µ (Page)ã€‚Postgres ä¾èµ– OS Cache å½¢æˆåŒé‡ç¼“å­˜æ¶æ„ã€‚</li>\n<li><strong>åå°è¿›ç¨‹ (Background Processes)</strong>ï¼š\n<ul>\n<li><strong>BgWriter</strong>ï¼šå°†è„é¡µ (Dirty Pages) ç¼“æ…¢åˆ·ç›˜ï¼Œå‡è½» Checkpoint å‹åŠ›ã€‚</li>\n<li><strong>Checkpointer</strong>ï¼šå®šæœŸæ‰§è¡Œæ£€æŸ¥ç‚¹ï¼Œç¡®ä¿æ•°æ®è½ç›˜ï¼Œç¼©çŸ­æ¢å¤æ—¶é—´ã€‚</li>\n<li><strong>WAL Writer</strong>ï¼šå°† WAL Buffer ä¸­çš„æ—¥å¿—æ¡ç›®åˆ·å…¥ç£ç›˜ã€‚</li>\n<li><strong>Autovacuum</strong>ï¼šè‡ªåŠ¨å‘ç°å¹¶æ¸…ç†æ­»å…ƒç»„ï¼Œæ›´æ–°ç»Ÿè®¡ä¿¡æ¯ã€‚</li>\n</ul>\n</li>\n</ol>\n<h2 id=\"II-å­˜å‚¨å¼•æ“ä¸æ•°æ®ç»„ç»‡\">II. å­˜å‚¨å¼•æ“ä¸æ•°æ®ç»„ç»‡</h2>\n<p>PostgreSQL çš„å­˜å‚¨å±‚è®¾è®¡ç²¾å¦™ï¼Œé‡‡ç”¨ <strong>å †è¡¨ (Heap Table)</strong> ç»“æ„ï¼Œå¹¶è¾…ä»¥å¤šç§è¾…åŠ©æ–‡ä»¶ã€‚</p>\n<h3 id=\"2-1-é¡µé¢ä¸å…ƒç»„ç»“æ„-Page-Tuple\">2.1 é¡µé¢ä¸å…ƒç»„ç»“æ„ (Page &amp; Tuple)</h3>\n<p>Postgres çš„æ ‡å‡†é¡µé¢å¤§å°ä¸º <strong>8KB</strong>ã€‚</p>\n<pre><code class=\"mermaid\">classDiagram\n    class PageHeaderData &#123;\n        +uint16 pd_lower (ç©ºé—²ç©ºé—´èµ·å§‹)\n        +uint16 pd_upper (ç©ºé—²ç©ºé—´ç»“æŸ)\n        +uint16 pd_special (ç‰¹æ®Šç©ºé—´èµ·å§‹)\n    &#125;\n\n    class LinePointer &#123;\n        +uint32 IpId (è¡ŒæŒ‡é’ˆ: åç§»é‡+é•¿åº¦)\n    &#125;\n\n    class HeapTupleData &#123;\n        +uint32 t_xmin (åˆ›å»ºäº‹åŠ¡ID)\n        +uint32 t_xmax (åˆ é™¤äº‹åŠ¡ID)\n        +ItemPointerData t_ctid (ç‰©ç†ä½ç½®)\n        +uint16 t_infomask (æ ‡å¿—ä½&#x2F;Hint Bits)\n        +data fields[] (å®é™…æ•°æ®)\n    &#125;\n\n    class TablePage &#123;\n        PageHeaderData header\n        LinePointer[] pointers\n        FreeSpace ç©ºé—²ç©ºé—´\n        HeapTupleData[] tuples\n    &#125;\n\n    TablePage &quot;1&quot; *-- &quot;1&quot; PageHeaderData : åŒ…å«\n    TablePage &quot;1&quot; *-- &quot;n&quot; LinePointer : ä»å‰å‘åç”Ÿé•¿\n    TablePage &quot;1&quot; *-- &quot;n&quot; HeapTupleData : ä»åå‘å‰ç”Ÿé•¿</code></pre>\n<p><strong>å…³é”®æœºåˆ¶</strong>ï¼š</p>\n<ul>\n<li><strong>è¡ŒæŒ‡é’ˆ (ItemPointer)</strong>ï¼šç´¢å¼•ä¸ç›´æ¥æŒ‡å‘æ•°æ®è¡Œï¼Œè€Œæ˜¯æŒ‡å‘ Page é‡Œçš„è¡ŒæŒ‡é’ˆã€‚è¿™ä½¿å¾— Page å†…éƒ¨è¿›è¡Œç¢ç‰‡æ•´ç†ï¼ˆç§»åŠ¨ Tupleï¼‰æ—¶ï¼Œæ— éœ€ä¿®æ”¹å¤–éƒ¨ç´¢å¼•ï¼Œåªéœ€æ›´æ–°è¡ŒæŒ‡é’ˆå³å¯ã€‚</li>\n<li><strong>TOAST æœºåˆ¶</strong>ï¼šå½“è¡Œå¤§å°è¶…è¿‡é¡µé¢çš„ 1/4 (çº¦ 2KB) æ—¶ï¼Œè¶…é•¿å­—æ®µï¼ˆå¦‚ JSONB, Textï¼‰ä¼šè¢«å‹ç¼©å¹¶åˆ‡ç‰‡å­˜å‚¨åˆ°ä¸“é—¨çš„ TOAST è¡¨ä¸­ï¼Œä¸»è¡¨åªç•™ä¸€ä¸ªæŒ‡é’ˆã€‚</li>\n</ul>\n<h3 id=\"2-2-å…³é”®è¾…åŠ©æ–‡ä»¶\">2.2 å…³é”®è¾…åŠ©æ–‡ä»¶</h3>\n<p>Postgres é™¤äº†ä¸»æ•°æ®æ–‡ä»¶ï¼Œè¿˜ç»´æŠ¤ç€ä¸¤ä¸ªè‡³å…³é‡è¦çš„ä½å›¾æ–‡ä»¶ï¼š</p>\n<ol>\n<li><strong>FSM (Free Space Map)</strong>:\n<ul>\n<li><strong>ä½œç”¨</strong>: å¿«é€Ÿå®šä½å“ªä¸ªé¡µé¢æœ‰è¶³å¤Ÿçš„ç©ºé—²ç©ºé—´æ¥æ’å…¥æ–°æ•°æ®ï¼Œé¿å…å…¨è¡¨æ‰«æå¯»æ‰¾ç©ºä½ã€‚</li>\n</ul>\n</li>\n<li><strong>VM (Visibility Map)</strong>:\n<ul>\n<li><strong>ä½œç”¨</strong>: æ ‡è®°æŸä¸ªé¡µé¢ä¸Šçš„æ‰€æœ‰å…ƒç»„æ˜¯å¦å¯¹â€œæ‰€æœ‰æ´»è·ƒäº‹åŠ¡â€å¯è§ã€‚</li>\n<li><strong>æ ¸å¿ƒä¼˜åŒ–</strong>: <strong>Index-Only Scan</strong>ã€‚å¦‚æœ VM æ˜¾ç¤ºé¡µé¢å…¨å¯è§ï¼Œç´¢å¼•æ‰«æå¯ä»¥ç›´æ¥è¿”å›æ•°æ®ï¼Œ<strong>æ— éœ€å›è¡¨</strong> (Heap Fetch)ã€‚</li>\n</ul>\n</li>\n</ol>\n<h2 id=\"III-å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶-MVCC\">III. å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ (MVCC)</h2>\n<p>PostgreSQL çš„ MVCC é€šè¿‡<strong>ä¿ç•™æ•°æ®æ—§ç‰ˆæœ¬</strong>æ¥å®ç°ï¼Œè€Œä¸æ˜¯åƒ MySQL (InnoDB) é‚£æ ·ä½¿ç”¨ Undo Log å›æ»šæ®µã€‚</p>\n<h3 id=\"3-1-å…ƒç»„ç”Ÿå‘½å‘¨æœŸ\">3.1 å…ƒç»„ç”Ÿå‘½å‘¨æœŸ</h3>\n<pre><code class=\"mermaid\">stateDiagram-v2\n    [*] --&gt; Active : INSERT (åˆ›å»ºæ–°è¡Œ)\n    Active --&gt; Committed : COMMIT (äº‹åŠ¡æäº¤)\n    Active --&gt; Aborted : ROLLBACK (äº‹åŠ¡å›æ»š)\n    \n    Committed --&gt; Updating : UPDATE (è¢«æ–°äº‹åŠ¡æ›´æ–°)\n    Updating --&gt; Dead : COMMIT (æ›´æ–°æäº¤ï¼Œæ—§è¡Œå¤±æ•ˆ)\n    \n    Committed --&gt; Deleting : DELETE (è¢«æ–°äº‹åŠ¡åˆ é™¤)\n    Deleting --&gt; Dead : COMMIT (åˆ é™¤æäº¤)\n    \n    Dead --&gt; Reusable : VACUUM (æ¸…ç†æ­»å…ƒç»„)\n    Reusable --&gt; [*] : ç©ºé—´é‡ç”¨</code></pre>\n<h3 id=\"3-2-ç‰ˆæœ¬é“¾ä¸å¯è§æ€§\">3.2 ç‰ˆæœ¬é“¾ä¸å¯è§æ€§</h3>\n<p>å½“ä¸€è¡Œæ•°æ®è¢«æ›´æ–°æ—¶ï¼Œæ–°æ—§ç‰ˆæœ¬é€šè¿‡ <code>ctid</code> æŒ‡é’ˆè¿æ¥å½¢æˆç‰ˆæœ¬é“¾ã€‚</p>\n<pre><code class=\"mermaid\">graph TB\n    Query[æŸ¥è¯¢äº‹åŠ¡ Snapshot&lt;br&#x2F;&gt;Xmin&#x3D;250]\n    \n    subgraph VersionChain [å…ƒç»„ç‰ˆæœ¬é“¾]\n        V1[&quot;&lt;b&gt;ç‰ˆæœ¬ 1&lt;&#x2F;b&gt;&lt;br&#x2F;&gt;xmin&#x3D;100 (Committed)&lt;br&#x2F;&gt;xmax&#x3D;200 (Committed)&quot;]\n        V2[&quot;&lt;b&gt;ç‰ˆæœ¬ 2&lt;&#x2F;b&gt;&lt;br&#x2F;&gt;xmin&#x3D;200 (Committed)&lt;br&#x2F;&gt;xmax&#x3D;300 (Running)&quot;]\n        V3[&quot;&lt;b&gt;ç‰ˆæœ¬ 3&lt;&#x2F;b&gt;&lt;br&#x2F;&gt;xmin&#x3D;300 (Running)&lt;br&#x2F;&gt;xmax&#x3D;0&quot;]\n    end\n\n    Query --&gt; V1\n    Query --&gt; V2\n    Query --&gt; V3\n    \n    V1 --&gt;|ctid| V2\n    V2 --&gt;|ctid| V3\n    \n    %% æ·»åŠ å¯è§æ€§æ ‡ç­¾\n    V1_Label[ä¸å¯è§: xmaxå·²æäº¤]\n    V2_Label[&quot;&lt;b&gt;å¯è§&lt;&#x2F;b&gt;: xminå·²æäº¤ &amp; xmaxæœªæäº¤&quot;]\n    V3_Label[ä¸å¯è§: xminæœªæäº¤]\n    \n    V1 -.-&gt; V1_Label\n    V2 -.-&gt; V2_Label  \n    V3 -.-&gt; V3_Label\n    \n    class V2 highlight\n    classDef highlight fill:#d5f5e3,stroke:#2ecc71,stroke-width:2px\n</code></pre>\n<p><strong>å¯è§æ€§è§„åˆ™çš„æ ¸å¿ƒ</strong>ï¼š</p>\n<ul>\n<li><code>xmin</code> &lt; å½“å‰å¿«ç…§ &amp;&amp; (<code>xmax</code> == 0 || <code>xmax</code> &gt; å½“å‰å¿«ç…§)</li>\n<li>ç®€è€Œè¨€ä¹‹ï¼š<strong>æˆ‘åªèƒ½çœ‹åˆ°åœ¨æˆ‘å¼€å§‹ä¹‹å‰å·²ç»æäº¤çš„æ•°æ®ï¼Œä¸”è¿™äº›æ•°æ®åœ¨æˆ‘å¼€å§‹ä¹‹å‰æ²¡æœ‰è¢«åˆ é™¤ã€‚</strong></li>\n</ul>\n<h2 id=\"IV-æŸ¥è¯¢å¤„ç†ä¸ä¼˜åŒ–å™¨\">IV. æŸ¥è¯¢å¤„ç†ä¸ä¼˜åŒ–å™¨</h2>\n<p>PostgreSQL æ‹¥æœ‰æå…¶å¼ºå¤§çš„æŸ¥è¯¢ä¼˜åŒ–å™¨ï¼Œæ”¯æŒé—ä¼ ç®—æ³• (GEQO) å’Œå¤æ‚ä»£ä»·æ¨¡å‹ã€‚</p>\n<h3 id=\"4-1-æŸ¥è¯¢æ‰§è¡Œæµæ°´çº¿\">4.1 æŸ¥è¯¢æ‰§è¡Œæµæ°´çº¿</h3>\n<pre><code class=\"mermaid\">sequenceDiagram\n    participant Client\n    participant Parser as è§£æå™¨ (Parser)\n    participant Analyzer as åˆ†æå™¨ (Analyzer)\n    participant Rewriter as é‡å†™å™¨ (Rewriter)\n    participant Planner as è§„åˆ’å™¨ (Planner)\n    participant Executor as æ‰§è¡Œå™¨ (Executor)\n    \n    Client-&gt;&gt;Parser: å‘é€ SQL æŸ¥è¯¢\n    Parser-&gt;&gt;Analyzer: ç”ŸæˆåŸå§‹è§£ææ ‘ (Parse Tree)\n    Analyzer-&gt;&gt;Rewriter: è¯­ä¹‰åˆ†æ &amp; ç”ŸæˆæŸ¥è¯¢æ ‘ (Query Tree)\n    Rewriter-&gt;&gt;Planner: åº”ç”¨è§„åˆ™ (å¦‚è§†å›¾å±•å¼€)\n    Planner-&gt;&gt;Planner: é€»è¾‘ä¼˜åŒ– &amp; ç‰©ç†ä¼˜åŒ–\n    Note right of Planner: æˆæœ¬ä¼°ç®— (CBO)&lt;br&#x2F;&gt;é—ä¼ ç®—æ³• (GEQO)&lt;br&#x2F;&gt;è¿æ¥é¡ºåºé€‰æ‹©\n    Planner-&gt;&gt;Executor: ç”Ÿæˆæœ€ä¼˜æ‰§è¡Œè®¡åˆ’ (Plan Tree)\n    Executor-&gt;&gt;Executor: é€’å½’æ‰§è¡ŒèŠ‚ç‚¹ (Scan&#x2F;Join&#x2F;Sort)\n    Executor--&gt;&gt;Client: è¿”å›ç»“æœé›†</code></pre>\n<h3 id=\"4-2-ä¼˜åŒ–å™¨é»‘ç§‘æŠ€\">4.2 ä¼˜åŒ–å™¨é»‘ç§‘æŠ€</h3>\n<ol>\n<li><strong>é—ä¼ æŸ¥è¯¢ä¼˜åŒ– (GEQO)</strong>: å½“è¿æ¥çš„è¡¨æ•°é‡éå¸¸å¤šï¼ˆé»˜è®¤ &gt;= 12ï¼‰æ—¶ï¼Œç©·ä¸¾æ‰€æœ‰è¿æ¥é¡ºåºå¤ªæ…¢ï¼ŒPG ä¼šè‡ªåŠ¨åˆ‡æ¢åˆ°é—ä¼ ç®—æ³•æ¥æœç´¢è¿‘ä¼¼æœ€ä¼˜è§£ã€‚</li>\n<li><strong>JIT (å³æ—¶ç¼–è¯‘)</strong>: å¯¹äºå¤æ‚çš„å¤§å‹ OLAP æŸ¥è¯¢ï¼ŒPG å¯ä»¥åˆ©ç”¨ LLVM å°† SQL è¡¨è¾¾å¼åŠ¨æ€ç¼–è¯‘ä¸ºæœºå™¨ç ï¼ŒåŠ é€Ÿæ‰§è¡Œã€‚</li>\n<li><strong>å¹¶è¡ŒæŸ¥è¯¢</strong>: è‡ªåŠ¨åˆ©ç”¨å¤šæ ¸ CPU å¹¶è¡Œæ‰§è¡Œæ‰«æã€è¿æ¥å’Œèšåˆæ“ä½œã€‚</li>\n</ol>\n<h2 id=\"V-ç´¢å¼•æœºåˆ¶è¯¦è§£\">V. ç´¢å¼•æœºåˆ¶è¯¦è§£</h2>\n<p>PG çš„ç´¢å¼•æ˜¯å¼€æ”¾æ¥å£çš„ï¼Œæ”¯æŒæå…¶ä¸°å¯Œçš„æ•°æ®ç»“æ„ã€‚</p>\n<h3 id=\"5-1-B-tree-ç´¢å¼•ç»“æ„-Lehman-Yao-ç®—æ³•\">5.1 B-tree ç´¢å¼•ç»“æ„ (Lehman &amp; Yao ç®—æ³•)</h3>\n<pre><code class=\"mermaid\">graph TD\n    Root[Root Node] --&gt; I1[Internal Node]\n    Root --&gt; I2[Internal Node]\n    I1 --&gt; L1[Leaf Node 1&lt;br&#x2F;&gt;Data: 1..10]\n    I1 --&gt; L2[Leaf Node 2&lt;br&#x2F;&gt;Data: 11..20]\n    I2 --&gt; L3[Leaf Node 3&lt;br&#x2F;&gt;Data: 21..30]\n    \n    L1 -.-&gt;|Right Link| L2\n    L2 -.-&gt;|Right Link| L3\n    \n    classDef leaf fill:#e8f8f5,stroke:#1abc9c\n    class L1,L2,L3 leaf</code></pre>\n<ul>\n<li><strong>Right-Link æœºåˆ¶</strong>: å…è®¸è¯»æ“ä½œåœ¨èŠ‚ç‚¹åˆ†è£‚ (Split) æ—¶æ— éœ€åŠ é”ï¼Œæå¤§æå‡å¹¶å‘æ€§èƒ½ã€‚</li>\n</ul>\n<h3 id=\"5-2-ç´¢å¼•ç±»å‹å…¨æ™¯\">5.2 ç´¢å¼•ç±»å‹å…¨æ™¯</h3>\n<table>\n<thead>\n<tr>\n<th><strong>ç´¢å¼•ç±»å‹</strong></th>\n<th><strong>åŸç†</strong></th>\n<th><strong>æ€æ‰‹çº§åº”ç”¨åœºæ™¯</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>B-tree</strong></td>\n<td>å¹³è¡¡æ ‘</td>\n<td>ç»å¤§å¤šæ•°å¸¸è§„æŸ¥è¯¢ (=, &gt;, &lt;, BETWEEN)</td>\n</tr>\n<tr>\n<td><strong>GIN</strong></td>\n<td>å€’æ’ç´¢å¼• (Inverted)</td>\n<td><strong>JSONB</strong> åŒ…å«æŸ¥è¯¢ã€æ•°ç»„æœç´¢ã€å…¨æ–‡æ£€ç´¢</td>\n</tr>\n<tr>\n<td><strong>GiST</strong></td>\n<td>é€šç”¨æœç´¢æ ‘</td>\n<td><strong>GIS åœ°ç†æ•°æ®</strong> (PostGIS)ã€å‡ ä½•å›¾å½¢é‡å åˆ¤æ–­</td>\n</tr>\n<tr>\n<td><strong>SP-GiST</strong></td>\n<td>ç©ºé—´åˆ†åŒºæ ‘</td>\n<td>éå¹³è¡¡æ•°æ®é›†ï¼Œå¦‚ URL è·¯ç”±ã€åˆ†åŒºæ•°æ®</td>\n</tr>\n<tr>\n<td><strong>BRIN</strong></td>\n<td>å—èŒƒå›´ç´¢å¼•</td>\n<td><strong>æ—¶åºæ•°æ®</strong>ã€è¶…å¤§æ•°æ®é›†çš„æ—¥å¿—è¡¨ (æçœç©ºé—´)</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"VI-äº‹åŠ¡ç®¡ç†ä¸-WAL\">VI. äº‹åŠ¡ç®¡ç†ä¸ WAL</h2>\n<h3 id=\"6-1-ACID-çš„åŸºçŸ³ï¼šWAL\">6.1 ACID çš„åŸºçŸ³ï¼šWAL</h3>\n<pre><code class=\"mermaid\">sequenceDiagram\n    participant Tx as äº‹åŠ¡\n    participant WALBuf as WAL Buffer\n    participant WALFile as ç£ç›˜ WAL æ–‡ä»¶\n    participant SharedBuf as Shared Buffer\n    participant DataFile as ç£ç›˜æ•°æ®æ–‡ä»¶\n\n    Note over Tx, WALFile: é¢„å†™æ—¥å¿—åŸåˆ™ (Write-Ahead Logging)\n\n    Tx-&gt;&gt;WALBuf: 1. å†™å…¥å˜æ›´æ—¥å¿— (XLogRecord)\n    Tx-&gt;&gt;SharedBuf: 2. ä¿®æ”¹å†…å­˜ä¸­çš„æ•°æ®é¡µ (Dirty Page)\n    \n    Tx-&gt;&gt;Tx: 3. æäº¤äº‹åŠ¡ (COMMIT)\n    Tx-&gt;&gt;WALBuf: 4. å†™å…¥ Commit Record\n    WALBuf-&gt;&gt;WALFile: 5. åˆ·ç›˜ (fsync&#x2F;fdatasync)\n    WALFile--&gt;&gt;Tx: 6. æäº¤æˆåŠŸç¡®è®¤\n\n    Note over SharedBuf, DataFile: æ­¤æ—¶æ•°æ®é¡µå¯èƒ½è¿˜æ²¡å†™å…¥ç£ç›˜ï¼\n    \n    loop Checkpoint &#x2F; BgWriter\n        SharedBuf-&gt;&gt;DataFile: 7. å¼‚æ­¥å°†è„é¡µå†™å…¥æ•°æ®æ–‡ä»¶\n    end</code></pre>\n<ul>\n<li><strong>Full Page Write (å…¨é¡µå†™å…¥)</strong>: åœ¨ Checkpoint åï¼Œç¬¬ä¸€æ¬¡ä¿®æ”¹é¡µé¢ä¼šè®°å½•æ•´ä¸ªé¡µé¢å†…å®¹ï¼Œé˜²æ­¢ OS å´©æºƒå¯¼è‡´çš„â€œåŠé¡µå†™å…¥â€æŸåã€‚</li>\n</ul>\n<h2 id=\"VII-æ‰©å±•æ€§ä¸é«˜çº§ç‰¹æ€§\">VII. æ‰©å±•æ€§ä¸é«˜çº§ç‰¹æ€§</h2>\n<h3 id=\"7-1-å¼ºå¤§çš„åˆ†åŒºè¡¨\">7.1 å¼ºå¤§çš„åˆ†åŒºè¡¨</h3>\n<pre><code class=\"mermaid\">graph TD\n    Parent[ä¸»è¡¨: Sales] --&gt;|Partition Key: Date| P1[åˆ†åŒº: Sales_Jan]\n    Parent --&gt; P2[åˆ†åŒº: Sales_Feb]\n    Parent --&gt; P3[åˆ†åŒº: Sales_Mar]\n    \n    Client[æŸ¥è¯¢: WHERE date&#x3D;&#39;Jan-01&#39;] -.-&gt;|Partition Pruning| P1\n    Client -.-&gt;|å¿½ç•¥| P2\n    Client -.-&gt;|å¿½ç•¥| P3</code></pre>\n<ul>\n<li><strong>Partition Pruning (åˆ†åŒºå‰ªæ)</strong>: æŸ¥è¯¢ä¼˜åŒ–å™¨èƒ½è‡ªåŠ¨è·³è¿‡ä¸éœ€è¦æ‰«æçš„åˆ†åŒºã€‚</li>\n</ul>\n<h3 id=\"7-2-ç‰©ç†å¤åˆ¶-vs-é€»è¾‘å¤åˆ¶\">7.2 ç‰©ç†å¤åˆ¶ vs é€»è¾‘å¤åˆ¶</h3>\n<pre><code class=\"mermaid\">graph TB\n    subgraph &quot;ç‰©ç†æµå¤åˆ¶ (HA)&quot;\n        P1[ä¸»åº“] --&gt;|WAL Stream| P2[å¤‡åº“]\n    end\n\n    subgraph &quot;é€»è¾‘å¤åˆ¶ (ETL&#x2F;å¾®æœåŠ¡)&quot; \n        L1[å‘å¸ƒç«¯] --&gt;|Logical Decoding| L2[è®¢é˜…ç«¯]\n    end\n\n    %% ä¸ºä¸¤ä¸ªå­å›¾æ·»åŠ æè¿°æ€§æ–‡æœ¬\n    P_Desc[æ•´å®ä¾‹å¤åˆ¶&lt;br&#x2F;&gt;åªè¯»å‰¯æœ¬&lt;br&#x2F;&gt;æ•…éšœåˆ‡æ¢] \n    L_Desc[è¡¨çº§ç²’åº¦&lt;br&#x2F;&gt;è·¨ç‰ˆæœ¬&#x2F;è·¨OS&lt;br&#x2F;&gt;æ•°æ®æ±‡èš]\n</code></pre>\n<h2 id=\"VIII-PostgreSQL-vs-MySQL-æ ¸å¿ƒå¯¹æ¯”\">VIII. PostgreSQL vs MySQL æ ¸å¿ƒå¯¹æ¯”</h2>\n<h3 id=\"8-1-åŠŸèƒ½ä¸ç†å¿µå¯¹æ¯”\">8.1 åŠŸèƒ½ä¸ç†å¿µå¯¹æ¯”</h3>\n<table>\n<thead>\n<tr>\n<th><strong>ç‰¹æ€§</strong></th>\n<th><strong>PostgreSQL</strong></th>\n<th><strong>MySQL (InnoDB)</strong></th>\n<th><strong>æ ¸å¿ƒå·®å¼‚ç‚¹</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>æ¶æ„</strong></td>\n<td>å¤šè¿›ç¨‹</td>\n<td>å¤šçº¿ç¨‹</td>\n<td>PG éš”ç¦»æ€§å¼ºï¼Œè¿æ¥å¼€é”€å¤§ (éœ€è¿æ¥æ± )ï¼›MySQL è¿æ¥è½»é‡ã€‚</td>\n</tr>\n<tr>\n<td><strong>MVCC</strong></td>\n<td>append-only (æ–°æ—§ç‰ˆæœ¬å…±å­˜)</td>\n<td>undo log (å›æ»šæ®µ)</td>\n<td>PG å†™ä¸é˜»å¡è¯»ï¼Œæ¸…ç†ä¾èµ– VACUUMï¼›MySQL ç©ºé—´å›æ”¶ç”± Purge çº¿ç¨‹è‡ªåŠ¨å¤„ç†ã€‚</td>\n</tr>\n<tr>\n<td><strong>Join ç®—æ³•</strong></td>\n<td>Nested Loop, Hash Join, Merge Join</td>\n<td>é•¿æœŸä»… Nested Loop (8.0+ åŠ å…¥ Hash Join)</td>\n<td>PG å¤„ç†å¤æ‚å¤šè¡¨å…³è”æ€§èƒ½æå¼º (OLAP èƒ½åŠ›æ›´ä¼˜)ã€‚</td>\n</tr>\n<tr>\n<td><strong>æ•°æ®ç±»å‹</strong></td>\n<td><strong>JSONB (äºŒè¿›åˆ¶+ç´¢å¼•)</strong>, GIS, æ•°ç»„</td>\n<td>JSON (æ–‡æœ¬), GIS è¾ƒå¼±</td>\n<td>PG æ˜¯ NoSQL + SQL çš„å®Œç¾ç»“åˆä½“ã€‚</td>\n</tr>\n<tr>\n<td><strong>è®¸å¯è¯</strong></td>\n<td>PostgreSQL (ç±» BSD)</td>\n<td>GPL</td>\n<td>PG å•†ä¸šåŒ–æ›´è‡ªç”±ã€‚</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"8-2-é€‰å‹å»ºè®®å›¾è°±\">8.2 é€‰å‹å»ºè®®å›¾è°±</h3>\n<pre><code class=\"mermaid\">journey\n    title æ•°æ®åº“é€‰å‹å†³ç­–è·¯å¾„\n    section ä¸šåŠ¡åœºæ™¯åˆ†æ\n      ç®€å• CRUD, äº’è”ç½‘é«˜å¹¶å‘: 5: MySQL\n      å¤æ‚ SQL, æ•°æ®åˆ†æ, æŠ¥è¡¨: 5: PostgreSQL\n      éœ€è¦ GIS åœ°ç†ä¿¡æ¯: 5: PostgreSQL (PostGIS)\n      éœ€è¦ JSON æ–‡æ¡£å­˜å‚¨: 4: PostgreSQL (JSONB)\n    section è¿ç»´è€ƒé‡\n      DBA äººæ‰å‚¨å¤‡å……è¶³: 5: MySQL\n      éœ€è¦æè‡´çš„æ•°æ®ä¸€è‡´æ€§: 5: PostgreSQL\n      éœ€è¦ Oracle è¿ç§»: 4: PostgreSQL</code></pre>\n<h2 id=\"æ€»ç»“\">æ€»ç»“</h2>\n<p>PostgreSQL èƒ½å¤Ÿæˆä¸ºå½“ä»Šæœ€æµè¡Œçš„æ•°æ®åº“ä¹‹ä¸€ï¼Œå½’åŠŸäºå…¶<strong>å­¦é™¢æ´¾çš„ä¸¥è°¨</strong>ä¸<strong>å·¥ç¨‹æ´¾çš„å®ç”¨</strong>çš„å®Œç¾ç»“åˆï¼š</p>\n<ol>\n<li><strong>çœŸæ­£çš„ MVCC å®ç°</strong>ï¼šæä¾›æ— é˜»å¡è¯»å–å’Œä¸¥æ ¼çš„å¿«ç…§éš”ç¦»ã€‚</li>\n<li><strong>å¯æ‰©å±•æ¶æ„</strong>ï¼šé€šè¿‡ Extension (å¦‚ PostGIS, TimescaleDB) è®©æ•°æ®åº“èƒ½åŠ›æ— é™å»¶ä¼¸ã€‚</li>\n<li><strong>å¼ºå¤§çš„ä¼˜åŒ–å™¨</strong>ï¼šèƒ½å¤Ÿé©¾é©­æå…¶å¤æ‚çš„æŸ¥è¯¢é€»è¾‘ï¼Œä¸ä»…ä»…æ˜¯ç®€å•çš„ Key-Value æŸ¥è¯¢ã€‚</li>\n</ol>\n<blockquote>\n<p><strong>ä¸“å®¶å»ºè®®</strong>ï¼šå¦‚æœä½ çš„ä¸šåŠ¡æ¶‰åŠå¤æ‚çš„æ•°æ®æ¨¡å‹ã€æ··åˆè´Ÿè½½ (HTAP) æˆ–åœ°ç†ç©ºé—´æ•°æ®ï¼ŒPostgreSQL æ˜¯ä¸äºŒä¹‹é€‰ï¼›å¦‚æœæ˜¯çº¯ç²¹çš„é«˜å¹¶å‘ç®€å•ç‚¹æŸ¥è¯¢ (Point Select)ï¼ŒMySQL ä¾ç„¶è¡¨ç°ä¼˜å¼‚ã€‚</p>\n</blockquote>\n<h2 id=\"å‚è€ƒ-è‡´è°¢\">å‚è€ƒ&amp;è‡´è°¢</h2>\n<h2 id=\"ç³»åˆ—æ•™ç¨‹\"><strong>ç³»åˆ—æ•™ç¨‹</strong></h2>\n<p><a href=\"/atom.xml\"><i class=\"fas fa-rss\"></i>å…¨éƒ¨æ–‡ç« RSSè®¢é˜…</a></p>\n\n<h3 id=\"æ•°æ®åº“ç³»åˆ—\"><strong>æ•°æ®åº“ç³»åˆ—</strong></h3>\n<ul>\n<li><a href=\"/posts/b2f7c564/\">SQLå‘½ä»¤ä½¿ç”¨æ•™ç¨‹ï¼šä»å…¥é—¨åˆ°ç²¾é€š</a></li>\n<li><a href=\"/posts/847851a6/\">SQLiteä½¿ç”¨å…¨é¢æ•™ç¨‹ï¼šè½»é‡çº§æ•°æ®åº“çš„ç»ˆææŒ‡å—</a></li>\n<li><a href=\"/posts/a460ae99/\">MySQLå‘½ä»¤è¡Œä½¿ç”¨å…¨é¢æ•™ç¨‹ï¼šä»å…¥é—¨åˆ°ç²¾é€š</a></li>\n<li><a href=\"/posts/622f0f0f/\">MySQL ä½¿ç”¨å…¨é¢æŒ‡å—ï¼šä»å…¥é—¨åˆ°é«˜çº§å®è·µ</a></li>\n<li><a href=\"/posts/16bffe88/\">PostgreSQL ä½¿ç”¨å…¨é¢æŒ‡å—ï¼šä»å…¥é—¨åˆ°ä¼ä¸šçº§åº”ç”¨</a></li>\n<li><a href=\"/posts/6c6f64dc/\">PostgreSQLå‘½ä»¤è¡Œä½¿ç”¨æ•™ç¨‹ï¼šæŒæ¡ psql å·¥å…·</a></li>\n<li><a href=\"/posts/a416ccaa/\">PostgreSQL å®ç°åŸç†æ·±åº¦å‰–æï¼šé«˜æ€§èƒ½æ•°æ®åº“å¼•æ“çš„æ ¸å¿ƒæœºåˆ¶</a></li>\n</ul>\n\n<link rel=\"stylesheet\" href=\"https://fastly.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/style.css\"><script src=\"https://fastly.jsdelivr.net/npm/d3@7\"></script><script src=\"https://fastly.jsdelivr.net/npm/markmap-view@0.18.10\"></script><script src=\"https://fastly.jsdelivr.net/npm/markmap-toolbar@0.18.10\"></script>\n<link rel=\"stylesheet\" href=\"/css/markmap.css\">\n\n<script src=\"/js/markmap.js\"></script>\n",
            "tags": [
                "sql",
                "postgresql"
            ]
        },
        {
            "id": "https://blog.17lai.site/posts/16bffe88/",
            "url": "https://blog.17lai.site/posts/16bffe88/",
            "title": "PostgreSQL ä½¿ç”¨å…¨é¢æŒ‡å—ï¼šä»å…¥é—¨åˆ°ä¼ä¸šçº§åº”ç”¨",
            "date_published": "2025-11-22T07:36:06.000Z",
            "content_html": "<blockquote>\n<p>PostgreSQL æ˜¯ä¸–ç•Œä¸Šæœ€å…ˆè¿›çš„å¼€æºå…³ç³»å‹æ•°æ®åº“ï¼Œä»¥å…¶<strong>å¼ºå¤§çš„åŠŸèƒ½</strong>ã€<strong>é«˜åº¦çš„æ‰©å±•æ€§</strong>å’Œ<strong>ä¸¥æ ¼çš„SQLæ ‡å‡†å…¼å®¹æ€§</strong>è‘—ç§°ã€‚æœ¬æ•™ç¨‹å°†å¸¦ä½ ä»åŸºç¡€åˆ°é«˜çº§å…¨é¢æŒæ¡PostgreSQLçš„ä½¿ç”¨æŠ€å·§ï¼Œæ¶µç›–å®‰è£…é…ç½®ã€æ ¸å¿ƒæ“ä½œã€é«˜çº§ç‰¹æ€§å’Œæ€§èƒ½ä¼˜åŒ–ç­‰å„ä¸ªæ–¹é¢ã€‚</p>\n</blockquote>\n<span id=\"more\"></span>\n<hr>\n<p><img src=\"https://cimg1.17lai.site/data/2025/11/22/20251122170322.webp\" alt=\"\"></p>\n<h2 id=\"ä¸€ã€PostgreSQLæ¦‚è¿°\">ä¸€ã€PostgreSQLæ¦‚è¿°</h2>\n<p>PostgreSQLï¼ˆå¸¸ç®€ç§°ä¸ºPostgresï¼‰æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„å¼€æºå¯¹è±¡å…³ç³»æ•°æ®åº“ç³»ç»Ÿï¼Œå…·æœ‰ä»¥ä¸‹æ ¸å¿ƒç‰¹ç‚¹ï¼š</p>\n<ul>\n<li><strong>é«˜åº¦ç¬¦åˆSQLæ ‡å‡†</strong>ï¼šæ”¯æŒSQL:2016æ ‡å‡†çš„ç»å¤§éƒ¨åˆ†åŠŸèƒ½</li>\n<li><strong>å¯æ‰©å±•æ€§</strong>ï¼šæ”¯æŒè‡ªå®šä¹‰æ•°æ®ç±»å‹ã€å‡½æ•°ã€æ“ä½œç¬¦å’Œç´¢å¼•æ–¹æ³•</li>\n<li><strong>ACIDå…¼å®¹</strong>ï¼šå®Œå…¨æ”¯æŒäº‹åŠ¡å¤„ç†</li>\n<li><strong>ä¸°å¯Œçš„ç‰¹æ€§</strong>ï¼š</li>\n<li>å¤æ‚æŸ¥è¯¢</li>\n<li>å¤–é”®</li>\n<li>è§¦å‘å™¨</li>\n<li>å¯æ›´æ–°çš„è§†å›¾</li>\n<li>äº‹åŠ¡å®Œæ•´æ€§</li>\n<li>å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶(MVCC)</li>\n<li><strong>å¤šè¯­è¨€æ”¯æŒ</strong>ï¼šPL/pgSQLã€PL/Pythonã€PL/Perlã€PL/Tclç­‰</li>\n<li><strong>å¼ºå¤§çš„æ‰©å±•</strong>ï¼šPostGISï¼ˆåœ°ç†ç©ºé—´ï¼‰ã€pgRoutingï¼ˆè·¯å¾„è§„åˆ’ï¼‰ã€TimescaleDBï¼ˆæ—¶åºæ•°æ®ï¼‰ç­‰</li>\n</ul>\n<pre><code class=\"mermaid\">graph TD\nPostgreSQL --&gt; æ ¸å¿ƒåŠŸèƒ½[æ ¸å¿ƒåŠŸèƒ½]\nPostgreSQL --&gt; æ‰©å±•æ¨¡å—[æ‰©å±•æ¨¡å—]\n\næ ¸å¿ƒåŠŸèƒ½ --&gt; SQLæ ‡å‡†\næ ¸å¿ƒåŠŸèƒ½ --&gt; ACIDäº‹åŠ¡\næ ¸å¿ƒåŠŸèƒ½ --&gt; MVCC\næ ¸å¿ƒåŠŸèƒ½ --&gt; å¤æ‚ç´¢å¼•\n\næ‰©å±•æ¨¡å— --&gt; PostGIS\næ‰©å±•æ¨¡å— --&gt; TimescaleDB\næ‰©å±•æ¨¡å— --&gt; pg_partman\næ‰©å±•æ¨¡å— --&gt; PL&#x2F;Python</code></pre>\n<h2 id=\"äºŒã€å®‰è£…ä¸é…ç½®\">äºŒã€å®‰è£…ä¸é…ç½®</h2>\n<h3 id=\"ä¸åŒå¹³å°å®‰è£…\">ä¸åŒå¹³å°å®‰è£…</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-bash\" data-language=\"bash\" data-start=\"1\"><code class=\"language-bash\"># Ubuntu&#x2F;Debian\nsudo apt update\nsudo apt install postgresql postgresql-contrib\n\n# CentOS&#x2F;RHEL\nsudo yum install postgresql-server postgresql-contrib\nsudo postgresql-setup --initdb\n\n# macOS (Homebrew)\nbrew install postgresql\nbrew services start postgresql\n\n# Windows\nä¸‹è½½å®‰è£…åŒ…ï¼šhttps:&#x2F;&#x2F;www.postgresql.org&#x2F;download&#x2F;windows&#x2F;</code></pre></div></figure>\n<h3 id=\"åŸºæœ¬é…ç½®\">åŸºæœ¬é…ç½®</h3>\n<ol>\n<li><strong>åˆå§‹åŒ–æ•°æ®åº“é›†ç¾¤</strong></li>\n</ol>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-bash\" data-language=\"bash\" data-start=\"1\"><code class=\"language-bash\">sudo -u postgres initdb -D &#x2F;var&#x2F;lib&#x2F;postgres&#x2F;data</code></pre></div></figure>\n<ol start=\"2\">\n<li><strong>å¯åŠ¨æœåŠ¡</strong></li>\n</ol>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-bash\" data-language=\"bash\" data-start=\"1\"><code class=\"language-bash\">sudo systemctl start postgresql\nsudo systemctl enable postgresql</code></pre></div></figure>\n<ol start=\"3\">\n<li><strong>é…ç½®è®¿é—®æƒé™</strong><br>\nç¼–è¾‘ <code>pg_hba.conf</code>ï¼š</li>\n</ol>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-ini\" data-language=\"ini\" data-start=\"1\"><code class=\"language-ini\"># å…è®¸æœ¬åœ°æ‰€æœ‰è¿æ¥\nlocalallalltrust\n# å…è®¸ç½‘ç»œè¿æ¥\nhostallall0.0.0.0&#x2F;0md5</code></pre></div></figure>\n<ol start=\"4\">\n<li><strong>ä¿®æ”¹ç›‘å¬åœ°å€</strong><br>\nç¼–è¾‘ <code>postgresql.conf</code>ï¼š</li>\n</ol>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-ini\" data-language=\"ini\" data-start=\"1\"><code class=\"language-ini\">listen_addresses &#x3D; &#39;*&#39;</code></pre></div></figure>\n<h3 id=\"åˆ›å»ºç”¨æˆ·å’Œæ•°æ®åº“\">åˆ›å»ºç”¨æˆ·å’Œæ•°æ®åº“</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- è¿æ¥PostgreSQL\nsudo -u postgres psql\n\n-- åˆ›å»ºç”¨æˆ·\nCREATE USER myuser WITH PASSWORD &#39;securepassword&#39;;\n\n-- åˆ›å»ºæ•°æ®åº“\nCREATE DATABASE mydb OWNER myuser;\n\n-- æˆäºˆæƒé™\nGRANT ALL PRIVILEGES ON DATABASE mydb TO myuser;</code></pre></div></figure>\n<h2 id=\"ä¸‰ã€æ•°æ®åº“åŸºç¡€æ“ä½œ\">ä¸‰ã€æ•°æ®åº“åŸºç¡€æ“ä½œ</h2>\n<h3 id=\"è¡¨æ“ä½œ\">è¡¨æ“ä½œ</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- åˆ›å»ºè¡¨\nCREATE TABLE employees (\nid SERIAL PRIMARY KEY,\nname VARCHAR(100) NOT NULL,\nemail VARCHAR(100) UNIQUE,\ndepartment VARCHAR(50),\nsalary NUMERIC(10,2),\nhire_date DATE DEFAULT CURRENT_DATE,\nskills TEXT[]\n);\n\n-- ä¿®æ”¹è¡¨\nALTER TABLE employees ADD COLUMN phone VARCHAR(15);\nALTER TABLE employees ALTER COLUMN department SET NOT NULL;\n\n-- åˆ é™¤è¡¨\nDROP TABLE IF EXISTS temp_employees;</code></pre></div></figure>\n<h3 id=\"æ•°æ®æ“ä½œï¼ˆCRUDï¼‰\">æ•°æ®æ“ä½œï¼ˆCRUDï¼‰</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- æ’å…¥æ•°æ®\nINSERT INTO employees (name, email, department, salary)\nVALUES\n(&#39;å¼ ä¼Ÿ&#39;, &#39;zhang@company.com&#39;, &#39;ç ”å‘éƒ¨&#39;, 15000),\n(&#39;æå¨œ&#39;, &#39;li@company.com&#39;, &#39;å¸‚åœºéƒ¨&#39;, 12000);\n\n-- æŸ¥è¯¢æ•°æ®\nSELECT * FROM employees WHERE department &#x3D; &#39;ç ”å‘éƒ¨&#39; AND salary &gt; 13000;\n\n-- æ›´æ–°æ•°æ®\nUPDATE employees SET salary &#x3D; salary * 1.1 WHERE department &#x3D; &#39;ç ”å‘éƒ¨&#39;;\n\n-- åˆ é™¤æ•°æ®\nDELETE FROM employees WHERE id &#x3D; 5;</code></pre></div></figure>\n<h3 id=\"äº‹åŠ¡ç®¡ç†\">äº‹åŠ¡ç®¡ç†</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">BEGIN;\n\nUPDATE accounts SET balance &#x3D; balance - 100 WHERE id &#x3D; 1;\nUPDATE accounts SET balance &#x3D; balance + 100 WHERE id &#x3D; 2;\n\n-- æäº¤äº‹åŠ¡\nCOMMIT;\n\n-- å‡ºé”™æ—¶å›æ»š\nROLLBACK;</code></pre></div></figure>\n<h2 id=\"å››ã€æ•°æ®ç±»å‹è¯¦è§£\">å››ã€æ•°æ®ç±»å‹è¯¦è§£</h2>\n<p>PostgreSQLæä¾›ä¸°å¯Œçš„æ•°æ®ç±»å‹ï¼š</p>\n<table>\n<thead>\n<tr>\n<th>ç±»åˆ«</th>\n<th>æ•°æ®ç±»å‹</th>\n<th>æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>æ•°å€¼</strong></td>\n<td><code>SMALLINT</code>, <code>INTEGER</code>, <code>BIGINT</code></td>\n<td>æ•´æ•°ç±»å‹</td>\n</tr>\n<tr>\n<td></td>\n<td><code>NUMERIC(precision, scale)</code></td>\n<td>ç²¾ç¡®å°æ•°</td>\n</tr>\n<tr>\n<td></td>\n<td><code>REAL</code>, <code>DOUBLE PRECISION</code></td>\n<td>æµ®ç‚¹æ•°</td>\n</tr>\n<tr>\n<td><strong>å­—ç¬¦</strong></td>\n<td><code>VARCHAR(n)</code>, <code>TEXT</code></td>\n<td>å˜é•¿å­—ç¬¦ä¸²</td>\n</tr>\n<tr>\n<td></td>\n<td><code>CHAR(n)</code></td>\n<td>å®šé•¿å­—ç¬¦ä¸²</td>\n</tr>\n<tr>\n<td><strong>æ—¥æœŸ/æ—¶é—´</strong></td>\n<td><code>DATE</code>, <code>TIME</code>, <code>TIMESTAMP</code></td>\n<td>æ—¥æœŸæ—¶é—´ç±»å‹</td>\n</tr>\n<tr>\n<td><strong>å¸ƒå°”</strong></td>\n<td><code>BOOLEAN</code></td>\n<td>true/false</td>\n</tr>\n<tr>\n<td><strong>äºŒè¿›åˆ¶</strong></td>\n<td><code>BYTEA</code></td>\n<td>äºŒè¿›åˆ¶æ•°æ®</td>\n</tr>\n<tr>\n<td><strong>å‡ ä½•</strong></td>\n<td><code>POINT</code>, <code>LINE</code>, <code>CIRCLE</code></td>\n<td>å‡ ä½•å›¾å½¢</td>\n</tr>\n<tr>\n<td><strong>ç½‘ç»œ</strong></td>\n<td><code>INET</code>, <code>CIDR</code>, <code>MACADDR</code></td>\n<td>ç½‘ç»œåœ°å€</td>\n</tr>\n<tr>\n<td><strong>JSON</strong></td>\n<td><code>JSON</code>, <code>JSONB</code></td>\n<td>JSONæ•°æ®</td>\n</tr>\n<tr>\n<td><strong>æ•°ç»„</strong></td>\n<td><code>INT[]</code>, <code>TEXT[]</code></td>\n<td>æ•°ç»„ç±»å‹</td>\n</tr>\n<tr>\n<td><strong>èŒƒå›´</strong></td>\n<td><code>INT4RANGE</code>, <code>TSRANGE</code></td>\n<td>èŒƒå›´ç±»å‹</td>\n</tr>\n</tbody>\n</table>\n<p><strong>JSONBç¤ºä¾‹</strong>ï¼š</p>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">CREATE TABLE products (\nid SERIAL PRIMARY KEY,\nname VARCHAR(100),\nattributes JSONB\n);\n\nINSERT INTO products (name, attributes)\nVALUES (&#39;Laptop&#39;, &#39;&#123;&quot;color&quot;: &quot;silver&quot;, &quot;memory&quot;: &quot;16GB&quot;, &quot;ports&quot;: [&quot;USB-C&quot;, &quot;HDMI&quot;]&#125;&#39;);\n\n-- æŸ¥è¯¢JSONå­—æ®µ\nSELECT name, attributes-&gt;&gt;&#39;color&#39; AS color\nFROM products\nWHERE attributes @&gt; &#39;&#123;&quot;memory&quot;: &quot;16GB&quot;&#125;&#39;;</code></pre></div></figure>\n<h2 id=\"äº”ã€é«˜çº§æŸ¥è¯¢æŠ€æœ¯\">äº”ã€é«˜çº§æŸ¥è¯¢æŠ€æœ¯</h2>\n<h3 id=\"çª—å£å‡½æ•°\">çª—å£å‡½æ•°</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">SELECT\nname,\ndepartment,\nsalary,\nAVG(salary) OVER (PARTITION BY department) AS avg_dept_salary,\nRANK() OVER (ORDER BY salary DESC) AS salary_rank\nFROM employees;</code></pre></div></figure>\n<h3 id=\"CTEï¼ˆå…¬å…±è¡¨è¡¨è¾¾å¼ï¼‰\">CTEï¼ˆå…¬å…±è¡¨è¡¨è¾¾å¼ï¼‰</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">WITH regional_sales AS (\nSELECT region, SUM(amount) AS total_sales\nFROM orders\nGROUP BY region\n),\ntop_regions AS (\nSELECT region\nFROM regional_sales\nWHERE total_sales &gt; (SELECT SUM(total_sales)&#x2F;10 FROM regional_sales)\n)\nSELECT region, product, SUM(quantity) AS product_units\nFROM orders\nWHERE region IN (SELECT region FROM top_regions)\nGROUP BY region, product;</code></pre></div></figure>\n<h3 id=\"å…¨æ–‡æœç´¢\">å…¨æ–‡æœç´¢</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- åˆ›å»ºå…¨æ–‡æœç´¢ç´¢å¼•\nCREATE TABLE documents (\nid SERIAL PRIMARY KEY,\ntitle TEXT,\nbody TEXT\n);\n\nCREATE INDEX idx_documents_search ON documents USING GIN (to_tsvector(&#39;english&#39;, body));\n\n-- æ‰§è¡Œæœç´¢\nSELECT title, ts_headline(body, q) AS highlight\nFROM documents, to_tsquery(&#39;english&#39;, &#39;database &amp; performance&#39;) q\nWHERE to_tsvector(&#39;english&#39;, body) @@ q;</code></pre></div></figure>\n<h2 id=\"å…­ã€ç´¢å¼•ä¸æ€§èƒ½ä¼˜åŒ–\">å…­ã€ç´¢å¼•ä¸æ€§èƒ½ä¼˜åŒ–</h2>\n<h3 id=\"ç´¢å¼•ç±»å‹\">ç´¢å¼•ç±»å‹</h3>\n<table>\n<thead>\n<tr>\n<th>ç´¢å¼•ç±»å‹</th>\n<th>é€‚ç”¨åœºæ™¯</th>\n<th>ç¤ºä¾‹</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>B-tree</strong></td>\n<td>é»˜è®¤ç´¢å¼•ï¼Œé€‚ç”¨äºç­‰å€¼æŸ¥è¯¢å’ŒèŒƒå›´æŸ¥è¯¢</td>\n<td><code>CREATE INDEX idx_name ON table (column)</code></td>\n</tr>\n<tr>\n<td><strong>Hash</strong></td>\n<td>ç­‰å€¼æŸ¥è¯¢ï¼ˆä»…å†…å­˜è¡¨ï¼‰</td>\n<td><code>CREATE INDEX idx_name ON table USING HASH (column)</code></td>\n</tr>\n<tr>\n<td><strong>GIN</strong></td>\n<td>JSONBã€æ•°ç»„ã€å…¨æ–‡æœç´¢</td>\n<td><code>CREATE INDEX idx_gin ON table USING GIN (jsonb_column)</code></td>\n</tr>\n<tr>\n<td><strong>GiST</strong></td>\n<td>å‡ ä½•æ•°æ®ã€å…¨æ–‡æœç´¢</td>\n<td><code>CREATE INDEX idx_gist ON table USING GiST (geom_column)</code></td>\n</tr>\n<tr>\n<td><strong>SP-GiST</strong></td>\n<td>ç©ºé—´åˆ†åŒºæ•°æ®</td>\n<td><code>CREATE INDEX idx_spgist ON table USING SP-GiST (phone)</code></td>\n</tr>\n<tr>\n<td><strong>BRIN</strong></td>\n<td>å¤§å‹è¡¨ï¼ŒæŒ‰ç‰©ç†é¡ºåºå­˜å‚¨</td>\n<td><code>CREATE INDEX idx_brin ON table USING BRIN (timestamp)</code></td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"æŸ¥è¯¢ä¼˜åŒ–æŠ€å·§\">æŸ¥è¯¢ä¼˜åŒ–æŠ€å·§</h3>\n<ol>\n<li><strong>ä½¿ç”¨EXPLAINåˆ†æ</strong></li>\n</ol>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">EXPLAIN ANALYZE SELECT * FROM large_table WHERE category_id &#x3D; 10;</code></pre></div></figure>\n<ol start=\"2\">\n<li>**é¿å…SELECT ***</li>\n</ol>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- ä¸æ¨è\nSELECT * FROM orders;\n\n-- æ¨è\nSELECT order_id, customer_id, order_date FROM orders;</code></pre></div></figure>\n<ol start=\"3\">\n<li><strong>æ‰¹é‡æ“ä½œä¼˜åŒ–</strong></li>\n</ol>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- ä½¿ç”¨COPYå¯¼å…¥æ•°æ®\nCOPY large_table FROM &#39;&#x2F;path&#x2F;to&#x2F;data.csv&#39; DELIMITER &#39;,&#39; CSV HEADER;</code></pre></div></figure>\n<ol start=\"4\">\n<li><strong>åˆ†åŒºè¡¨</strong></li>\n</ol>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- åˆ›å»ºåˆ†åŒºè¡¨\nCREATE TABLE sales (\nid SERIAL,\nsale_date DATE,\namount NUMERIC\n) PARTITION BY RANGE (sale_date);\n\n-- åˆ›å»ºå­åˆ†åŒº\nCREATE TABLE sales_2023 PARTITION OF sales\nFOR VALUES FROM (&#39;2023-01-01&#39;) TO (&#39;2024-01-01&#39;);</code></pre></div></figure>\n<h2 id=\"ä¸ƒã€äº‹åŠ¡ä¸å¹¶å‘æ§åˆ¶\">ä¸ƒã€äº‹åŠ¡ä¸å¹¶å‘æ§åˆ¶</h2>\n<h3 id=\"äº‹åŠ¡éš”ç¦»çº§åˆ«\">äº‹åŠ¡éš”ç¦»çº§åˆ«</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- æŸ¥çœ‹å½“å‰éš”ç¦»çº§åˆ«\nSHOW default_transaction_isolation;\n\n-- è®¾ç½®éš”ç¦»çº§åˆ«\nSET TRANSACTION ISOLATION LEVEL READ COMMITTED;</code></pre></div></figure>\n<h3 id=\"é”æœºåˆ¶\">é”æœºåˆ¶</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- æ˜¾å¼é”å®š\nBEGIN;\nLOCK TABLE accounts IN EXCLUSIVE MODE;\n-- æ‰§è¡Œæ“ä½œ\nCOMMIT;\n\n-- è¡Œçº§é”\nSELECT * FROM orders WHERE id &#x3D; 100 FOR UPDATE;</code></pre></div></figure>\n<h3 id=\"MVCCï¼ˆå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼‰\">MVCCï¼ˆå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼‰</h3>\n<p>PostgreSQLä½¿ç”¨MVCCå¤„ç†å¹¶å‘ï¼Œé¿å…è¯»å†™å†²çªï¼š</p>\n<pre><code class=\"mermaid\">stateDiagram-v2\n[*] --&gt; Active\nActive --&gt; Committed\nActive --&gt; Aborted\nCommitted --&gt; [*]\nAborted --&gt; [*]</code></pre>\n<h2 id=\"å…«ã€å­˜å‚¨è¿‡ç¨‹ä¸å‡½æ•°\">å…«ã€å­˜å‚¨è¿‡ç¨‹ä¸å‡½æ•°</h2>\n<h3 id=\"PL-pgSQLå‡½æ•°\">PL/pgSQLå‡½æ•°</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">CREATE OR REPLACE FUNCTION calculate_tax(amount NUMERIC)\nRETURNS NUMERIC AS $$\nDECLARE\ntax_rate NUMERIC :&#x3D; 0.1;\ntax_amount NUMERIC;\nBEGIN\ntax_amount :&#x3D; amount * tax_rate;\nRETURN tax_amount;\nEXCEPTION\nWHEN division_by_zero THEN\nRAISE NOTICE &#39;Division by zero occurred&#39;;\nRETURN 0;\nEND;\n$$ LANGUAGE plpgsql;\n\n-- è°ƒç”¨å‡½æ•°\nSELECT calculate_tax(1000);-- è¿”å›100.00</code></pre></div></figure>\n<h3 id=\"è¿”å›ç»“æœé›†\">è¿”å›ç»“æœé›†</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">CREATE OR REPLACE FUNCTION get_employees(dept_name VARCHAR)\nRETURNS TABLE (id INT, name VARCHAR, salary NUMERIC) AS $$\nBEGIN\nRETURN QUERY\nSELECT e.id, e.name, e.salary\nFROM employees e\nWHERE e.department &#x3D; dept_name;\nEND;\n$$ LANGUAGE plpgsql;\n\n-- è°ƒç”¨\nSELECT * FROM get_employees(&#39;ç ”å‘éƒ¨&#39;);</code></pre></div></figure>\n<h2 id=\"ä¹ã€è§¦å‘å™¨ä¸è§„åˆ™\">ä¹ã€è§¦å‘å™¨ä¸è§„åˆ™</h2>\n<h3 id=\"åˆ›å»ºè§¦å‘å™¨\">åˆ›å»ºè§¦å‘å™¨</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- å®¡è®¡æ—¥å¿—è¡¨\nCREATE TABLE audit_log (\nid SERIAL PRIMARY KEY,\ntable_name VARCHAR(100),\naction VARCHAR(10),\nold_data JSONB,\nnew_data JSONB,\nchange_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\n-- è§¦å‘å™¨å‡½æ•°\nCREATE OR REPLACE FUNCTION log_employee_changes()\nRETURNS TRIGGER AS $$\nBEGIN\nIF (TG_OP &#x3D; &#39;DELETE&#39;) THEN\nINSERT INTO audit_log (table_name, action, old_data)\nVALUES (TG_TABLE_NAME, &#39;DELETE&#39;, to_jsonb(OLD));\nELSIF (TG_OP &#x3D; &#39;UPDATE&#39;) THEN\nINSERT INTO audit_log (table_name, action, old_data, new_data)\nVALUES (TG_TABLE_NAME, &#39;UPDATE&#39;, to_jsonb(OLD), to_jsonb(NEW));\nELSIF (TG_OP &#x3D; &#39;INSERT&#39;) THEN\nINSERT INTO audit_log (table_name, action, new_data)\nVALUES (TG_TABLE_NAME, &#39;INSERT&#39;, to_jsonb(NEW));\nEND IF;\nRETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;\n\n-- åˆ›å»ºè§¦å‘å™¨\nCREATE TRIGGER employees_audit\nAFTER INSERT OR UPDATE OR DELETE ON employees\nFOR EACH ROW EXECUTE FUNCTION log_employee_changes();</code></pre></div></figure>\n<h2 id=\"åã€å¤‡ä»½ä¸æ¢å¤\">åã€å¤‡ä»½ä¸æ¢å¤</h2>\n<h3 id=\"é€»è¾‘å¤‡ä»½ï¼ˆpg-dumpï¼‰\">é€»è¾‘å¤‡ä»½ï¼ˆpg_dumpï¼‰</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-bash\" data-language=\"bash\" data-start=\"1\"><code class=\"language-bash\"># å¤‡ä»½å•ä¸ªæ•°æ®åº“\npg_dump -U username -d dbname -f backup.sql\n\n# å¤‡ä»½æ‰€æœ‰æ•°æ®åº“\npg_dumpall -U postgres -f alldb.sql\n\n# å‹ç¼©å¤‡ä»½\npg_dump -U username -d dbname | gzip &gt; backup.gz</code></pre></div></figure>\n<h3 id=\"ç‰©ç†å¤‡ä»½ï¼ˆPITRï¼‰\">ç‰©ç†å¤‡ä»½ï¼ˆPITRï¼‰</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-bash\" data-language=\"bash\" data-start=\"1\"><code class=\"language-bash\"># å¼€å¯WALå½’æ¡£\n# postgresql.confä¸­è®¾ç½®ï¼š\nwal_level &#x3D; replica\narchive_mode &#x3D; on\narchive_command &#x3D; &#39;cp %p &#x2F;path&#x2F;to&#x2F;wal_archive&#x2F;%f&#39;\n\n# åˆ›å»ºåŸºç¡€å¤‡ä»½\npg_basebackup -D &#x2F;path&#x2F;to&#x2F;backup -U replicator -P -Fp -Xs -R</code></pre></div></figure>\n<h3 id=\"æ¢å¤æ•°æ®åº“\">æ¢å¤æ•°æ®åº“</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-bash\" data-language=\"bash\" data-start=\"1\"><code class=\"language-bash\"># ä»é€»è¾‘å¤‡ä»½æ¢å¤\npsql -U postgres -d newdb -f backup.sql\n\n# æ—¶é—´ç‚¹æ¢å¤(PITR)\n1. æ¢å¤åŸºç¡€å¤‡ä»½\n2. åˆ›å»ºrecovery.confæ–‡ä»¶ï¼š\nrestore_command &#x3D; &#39;cp &#x2F;path&#x2F;to&#x2F;wal_archive&#x2F;%f %p&#39;\nrecovery_target_time &#x3D; &#39;2023-05-01 12:00:00&#39;\n3. å¯åŠ¨PostgreSQL</code></pre></div></figure>\n<h2 id=\"åä¸€ã€é«˜å¯ç”¨ä¸å¤åˆ¶\">åä¸€ã€é«˜å¯ç”¨ä¸å¤åˆ¶</h2>\n<h3 id=\"æµå¤åˆ¶é…ç½®\">æµå¤åˆ¶é…ç½®</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-bash\" data-language=\"bash\" data-start=\"1\"><code class=\"language-bash\"># ä¸»åº“é…ç½® (postgresql.conf)\nwal_level &#x3D; replica\nmax_wal_senders &#x3D; 10\nhot_standby &#x3D; on\n\n# åˆ›å»ºå¤åˆ¶ç”¨æˆ·\nCREATE USER replicator WITH REPLICATION ENCRYPTED PASSWORD &#39;replpass&#39;;\n\n# å¤‡åº“é…ç½®\npg_basebackup -h master-host -U replicator -D &#x2F;var&#x2F;lib&#x2F;postgres&#x2F;data -P -Xs -R\n\n# å¤‡åº“postgresql.auto.confä¸­è‡ªåŠ¨ç”Ÿæˆï¼š\nprimary_conninfo &#x3D; &#39;host&#x3D;master-host user&#x3D;replicator password&#x3D;replpass&#39;</code></pre></div></figure>\n<h3 id=\"ä½¿ç”¨pgPool-IIè´Ÿè½½å‡è¡¡\">ä½¿ç”¨pgPool-IIè´Ÿè½½å‡è¡¡</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-bash\" data-language=\"bash\" data-start=\"1\"><code class=\"language-bash\"># å®‰è£…pgpool-II\nsudo apt install pgpool2\n\n# é…ç½®&#x2F;etc&#x2F;pgpool2&#x2F;pgpool.conf\nbackend_hostname0 &#x3D; &#39;master-host&#39;\nbackend_port0 &#x3D; 5432\nbackend_weight0 &#x3D; 1\nbackend_hostname1 &#x3D; &#39;replica1-host&#39;\nbackend_port1 &#x3D; 5432\nbackend_weight1 &#x3D; 1\n\n# å¯åŠ¨pgpool\nsystemctl start pgpool</code></pre></div></figure>\n<h2 id=\"åäºŒã€Pythoné›†æˆ\">åäºŒã€Pythoné›†æˆ</h2>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-python\" data-language=\"python\" data-start=\"1\"><code class=\"language-python\">import psycopg2\nfrom psycopg2 import sql\n\n# è¿æ¥æ•°æ®åº“\nconn &#x3D; psycopg2.connect(\ndbname&#x3D;&quot;mydb&quot;,\nuser&#x3D;&quot;myuser&quot;,\npassword&#x3D;&quot;mypassword&quot;,\nhost&#x3D;&quot;localhost&quot;,\nport&#x3D;&quot;5432&quot;\n)\n\ntry:\n# åˆ›å»ºæ¸¸æ ‡\nwith conn.cursor() as cursor:\n# æ‰§è¡ŒæŸ¥è¯¢\ncursor.execute(&quot;SELECT * FROM employees WHERE department &#x3D; %s&quot;, (&#39;ç ”å‘éƒ¨&#39;,))\nfor record in cursor.fetchall():\nprint(f&quot;ID: &#123;record[0]&#125;, Name: &#123;record[1]&#125;, Salary: &#123;record[4]&#125;&quot;)\n\n# æ’å…¥æ•°æ®\ninsert_query &#x3D; sql.SQL(&quot;&quot;&quot;\nINSERT INTO employees (name, email, department, salary)\nVALUES (%s, %s, %s, %s)\nRETURNING id\n&quot;&quot;&quot;)\ncursor.execute(insert_query, (&#39;ç‹èŠ³&#39;, &#39;wang@company.com&#39;, &#39;å¸‚åœºéƒ¨&#39;, 13000))\nnew_id &#x3D; cursor.fetchone()[0]\nprint(f&quot;New employee ID: &#123;new_id&#125;&quot;)\n\n# æäº¤äº‹åŠ¡\nconn.commit()\n\nexcept Exception as e:\nprint(f&quot;Database error: &#123;e&#125;&quot;)\nconn.rollback()\n\nfinally:\n# å…³é—­è¿æ¥\nif conn:\nconn.close()</code></pre></div></figure>\n<h2 id=\"åä¸‰ã€å­¦ä¹ èµ„æº\">åä¸‰ã€å­¦ä¹ èµ„æº</h2>\n<ol>\n<li><a href=\"https://www.postgresql.org/docs/\">å®˜æ–¹æ–‡æ¡£</a> - æœ€æƒå¨çš„å‚è€ƒèµ„æ–™</li>\n<li><a href=\"https://pgexercises.com/\">PGExercises</a> - PostgreSQLäº¤äº’å¼ç»ƒä¹ å¹³å°</li>\n<li><a href=\"https://www.postgresqltutorial.com/\">PostgreSQL Tutorial</a> - å…è´¹æ•™ç¨‹ç½‘ç«™</li>\n<li><a href=\"https://www.pgadmin.org/\">pgAdmin</a> - å®˜æ–¹å›¾å½¢åŒ–ç®¡ç†å·¥å…·</li>\n<li><a href=\"https://postgresweekly.com/\">PostgreSQL Weekly</a> - æ¯å‘¨æ›´æ–°èµ„è®¯</li>\n</ol>\n<pre><code class=\"mermaid\">graph LR\nA[å­¦ä¹ åŸºç¡€SQL] --&gt; B[æŒæ¡PostgreSQLç‰¹æ€§]\nB --&gt; C[æ€§èƒ½ä¼˜åŒ–]\nC --&gt; D[é«˜å¯ç”¨æ¶æ„]\nD --&gt; E[æ‰©å±•å¼€å‘]\nE --&gt; F[æˆä¸ºPostgreSQLä¸“å®¶]</code></pre>\n<blockquote>\n<p>PostgreSQLä½œä¸ºåŠŸèƒ½æœ€å¼ºå¤§çš„å¼€æºæ•°æ®åº“ï¼Œé€‚ç”¨äºä»åµŒå…¥å¼ç³»ç»Ÿåˆ°ä¼ä¸šçº§åº”ç”¨çš„å„ç§åœºæ™¯ã€‚é€šè¿‡æœ¬æ•™ç¨‹ï¼Œä½ å·²ç»æŒæ¡äº†å…¶æ ¸å¿ƒåŠŸèƒ½å’Œé«˜çº§æŠ€å·§ï¼Œå»ºè®®ç»“åˆå®é™…é¡¹ç›®æ·±å…¥å®è·µã€‚è®°ä½ï¼š<strong>æ­£ç¡®çš„æ•°æ®åº“è®¾è®¡æ¯”åæœŸä¼˜åŒ–æ›´é‡è¦</strong>ï¼</p>\n</blockquote>\n<h2 id=\"å‚è€ƒ-è‡´è°¢\">å‚è€ƒ&amp;è‡´è°¢</h2>\n<link rel=\"stylesheet\" href=\"https://fastly.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/style.css\"><script src=\"https://fastly.jsdelivr.net/npm/d3@7\"></script><script src=\"https://fastly.jsdelivr.net/npm/markmap-view@0.18.10\"></script><script src=\"https://fastly.jsdelivr.net/npm/markmap-toolbar@0.18.10\"></script>\n<link rel=\"stylesheet\" href=\"/css/markmap.css\">\n\n<script src=\"/js/markmap.js\"></script>\n",
            "tags": [
                "sql",
                "postgresql"
            ]
        },
        {
            "id": "https://blog.17lai.site/posts/622f0f0f/",
            "url": "https://blog.17lai.site/posts/622f0f0f/",
            "title": "MySQL ä½¿ç”¨å…¨é¢æŒ‡å—ï¼šä»å…¥é—¨åˆ°é«˜çº§å®è·µ",
            "date_published": "2025-11-22T07:34:08.000Z",
            "content_html": "<blockquote>\n<p>MySQL æ˜¯å…¨çƒæœ€æµè¡Œçš„å¼€æºå…³ç³»å‹æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼Œå¹¿æ³›åº”ç”¨äº Web åº”ç”¨å¼€å‘ã€‚æœ¬æ•™ç¨‹å°†å…¨é¢ä»‹ç» MySQL çš„å®‰è£…é…ç½®ã€æ ¸å¿ƒæ“ä½œã€é«˜çº§åŠŸèƒ½åŠæœ€ä½³å®è·µã€‚</p>\n</blockquote>\n<span id=\"more\"></span>\n<h2 id=\"ğŸ“¦-ä¸€ã€MySQL-å®‰è£…ä¸é…ç½®\">ğŸ“¦ ä¸€ã€MySQL å®‰è£…ä¸é…ç½®</h2>\n<h3 id=\"å®‰è£…-MySQL\">å®‰è£… MySQL</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-bash\" data-language=\"bash\" data-start=\"1\"><code class=\"language-bash\"># Ubuntu&#x2F;Debian\nsudo apt update\nsudo apt install mysql-server\n\n# CentOS&#x2F;RHEL\nsudo yum install mysql-server\n\n# macOS (Homebrew)\nbrew install mysql\n\n# Windows\nä¸‹è½½å®˜æ–¹å®‰è£…åŒ…ï¼šhttps:&#x2F;&#x2F;dev.mysql.com&#x2F;downloads&#x2F;mysql&#x2F;</code></pre></div></figure>\n<h3 id=\"åˆå§‹é…ç½®\">åˆå§‹é…ç½®</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-bash\" data-language=\"bash\" data-start=\"1\"><code class=\"language-bash\"># å®‰å…¨é…ç½®å‘å¯¼ï¼ˆè®¾ç½®rootå¯†ç ç­‰ï¼‰\nsudo mysql_secure_installation\n\n# å¯åŠ¨&#x2F;åœæ­¢æœåŠ¡\nsudo systemctl start mysql\nsudo systemctl stop mysql\n\n# è®¾ç½®å¼€æœºå¯åŠ¨\nsudo systemctl enable mysql</code></pre></div></figure>\n<h3 id=\"é…ç½®æ–‡ä»¶è¯¦è§£ï¼ˆmy-cnfï¼‰\">é…ç½®æ–‡ä»¶è¯¦è§£ï¼ˆmy.cnfï¼‰</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-ini\" data-language=\"ini\" data-start=\"1\"><code class=\"language-ini\">[mysqld]\n# æ•°æ®å­˜å‚¨ç›®å½•\ndatadir&#x3D;&#x2F;var&#x2F;lib&#x2F;mysql\n\n# å…è®¸æœ€å¤§è¿æ¥æ•°\nmax_connections&#x3D;200\n\n# æŸ¥è¯¢ç¼“å­˜å¤§å°\nquery_cache_size&#x3D;128M\n\n# å­—ç¬¦é›†è®¾ç½®\ncharacter-set-server&#x3D;utf8mb4\ncollation-server&#x3D;utf8mb4_unicode_ci\n\n# InnoDB ç¼“å†²æ± å¤§å° (æ¨è70-80%å†…å­˜)\ninnodb_buffer_pool_size&#x3D;1G\n\n# é”™è¯¯æ—¥å¿—è·¯å¾„\nlog-error&#x3D;&#x2F;var&#x2F;log&#x2F;mysql&#x2F;error.log</code></pre></div></figure>\n<h2 id=\"ğŸ”Œ-äºŒã€MySQL-åŸºç¡€æ“ä½œ\">ğŸ”Œ äºŒã€MySQL åŸºç¡€æ“ä½œ</h2>\n<h3 id=\"è¿æ¥-MySQL\">è¿æ¥ MySQL</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-bash\" data-language=\"bash\" data-start=\"1\"><code class=\"language-bash\"># æœ¬åœ°è¿æ¥\nmysql -u root -p\n\n# è¿œç¨‹è¿æ¥\nmysql -h 192.168.1.100 -P 3306 -u username -p</code></pre></div></figure>\n<h3 id=\"æ•°æ®åº“æ“ä½œ\">æ•°æ®åº“æ“ä½œ</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- åˆ›å»ºæ•°æ®åº“\nCREATE DATABASE company_db;\n\n-- æŸ¥çœ‹æ‰€æœ‰æ•°æ®åº“\nSHOW DATABASES;\n\n-- é€‰æ‹©æ•°æ®åº“\nUSE company_db;\n\n-- åˆ é™¤æ•°æ®åº“\nDROP DATABASE legacy_db;</code></pre></div></figure>\n<h3 id=\"è¡¨æ“ä½œ\">è¡¨æ“ä½œ</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- åˆ›å»ºå‘˜å·¥è¡¨\nCREATE TABLE employees (\nid INT AUTO_INCREMENT PRIMARY KEY,\nname VARCHAR(50) NOT NULL,\nemail VARCHAR(100) UNIQUE,\ndepartment VARCHAR(50),\nsalary DECIMAL(10,2),\nhire_date DATE DEFAULT (CURRENT_DATE)\n);\n\n-- æŸ¥çœ‹è¡¨ç»“æ„\nDESCRIBE employees;\n\n-- ä¿®æ”¹è¡¨ç»“æ„\nALTER TABLE employees ADD COLUMN phone VARCHAR(15);\nALTER TABLE employees MODIFY COLUMN salary FLOAT;\n\n-- åˆ é™¤è¡¨\nDROP TABLE temp_table;</code></pre></div></figure>\n<h2 id=\"ğŸ“Š-ä¸‰ã€æ•°æ®æ“ä½œï¼ˆCRUDï¼‰\">ğŸ“Š ä¸‰ã€æ•°æ®æ“ä½œï¼ˆCRUDï¼‰</h2>\n<h3 id=\"æ’å…¥æ•°æ®\">æ’å…¥æ•°æ®</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- å•æ¡æ’å…¥\nINSERT INTO employees (name, email, department, salary)\nVALUES (&#39;å¼ ä¸‰&#39;, &#39;zhang@company.com&#39;, &#39;æŠ€æœ¯éƒ¨&#39;, 15000);\n\n-- æ‰¹é‡æ’å…¥\nINSERT INTO employees (name, email, department, salary) VALUES\n(&#39;æå››&#39;, &#39;li@company.com&#39;, &#39;å¸‚åœºéƒ¨&#39;, 12000),\n(&#39;ç‹äº”&#39;, &#39;wang@company.com&#39;, &#39;è´¢åŠ¡éƒ¨&#39;, 13000),\n(&#39;èµµå…­&#39;, &#39;zhao@company.com&#39;, &#39;æŠ€æœ¯éƒ¨&#39;, 16000);</code></pre></div></figure>\n<h3 id=\"æŸ¥è¯¢æ•°æ®\">æŸ¥è¯¢æ•°æ®</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- åŸºæœ¬æŸ¥è¯¢\nSELECT * FROM employees;\n\n-- æ¡ä»¶æŸ¥è¯¢\nSELECT name, salary\nFROM employees\nWHERE department &#x3D; &#39;æŠ€æœ¯éƒ¨&#39; AND salary &gt; 14000;\n\n-- æ’åºä¸åˆ†é¡µ\nSELECT * FROM employees\nORDER BY hire_date DESC\nLIMIT 5 OFFSET 0;\n\n-- æ¨¡ç³ŠæŸ¥è¯¢\nSELECT * FROM employees\nWHERE name LIKE &#39;å¼ %&#39; OR email LIKE &#39;%@company.com&#39;;</code></pre></div></figure>\n<h3 id=\"æ›´æ–°æ•°æ®\">æ›´æ–°æ•°æ®</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- æ›´æ–°å•æ¡è®°å½•\nUPDATE employees\nSET salary &#x3D; salary * 1.1\nWHERE id &#x3D; 1;\n\n-- æ‰¹é‡æ›´æ–°\nUPDATE employees\nSET department &#x3D; &#39;ç ”å‘éƒ¨&#39;\nWHERE department &#x3D; &#39;æŠ€æœ¯éƒ¨&#39;;</code></pre></div></figure>\n<h3 id=\"åˆ é™¤æ•°æ®\">åˆ é™¤æ•°æ®</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- åˆ é™¤å•æ¡è®°å½•\nDELETE FROM employees\nWHERE id &#x3D; 5;\n\n-- æ¸…ç©ºè¡¨æ•°æ®\nTRUNCATE TABLE temp_employees;</code></pre></div></figure>\n<h2 id=\"ğŸ”—-å››ã€é«˜çº§æŸ¥è¯¢æŠ€å·§\">ğŸ”— å››ã€é«˜çº§æŸ¥è¯¢æŠ€å·§</h2>\n<h3 id=\"å¤šè¡¨è¿æ¥\">å¤šè¡¨è¿æ¥</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- åˆ›å»ºéƒ¨é—¨è¡¨\nCREATE TABLE departments (\nid INT AUTO_INCREMENT PRIMARY KEY,\nname VARCHAR(50) NOT NULL,\nlocation VARCHAR(100)\n);\n\n-- å†…è¿æ¥\nSELECT e.name, e.salary, d.name AS dept_name\nFROM employees e\nINNER JOIN departments d ON e.department_id &#x3D; d.id;\n\n-- å·¦è¿æ¥\nSELECT e.name, d.name AS dept_name\nFROM employees e\nLEFT JOIN departments d ON e.department_id &#x3D; d.id;</code></pre></div></figure>\n<h3 id=\"èšåˆå‡½æ•°\">èšåˆå‡½æ•°</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- åŸºæœ¬èšåˆ\nSELECT\nCOUNT(*) AS total_employees,\nAVG(salary) AS avg_salary,\nMAX(salary) AS max_salary,\nMIN(hire_date) AS oldest_hire\nFROM employees;\n\n-- åˆ†ç»„ç»Ÿè®¡\nSELECT\ndepartment,\nCOUNT(*) AS employee_count,\nAVG(salary) AS avg_salary\nFROM employees\nGROUP BY department\nHAVING COUNT(*) &gt; 3;</code></pre></div></figure>\n<h3 id=\"å­æŸ¥è¯¢\">å­æŸ¥è¯¢</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- å•è¡Œå­æŸ¥è¯¢\nSELECT name, salary\nFROM employees\nWHERE salary &gt; (SELECT AVG(salary) FROM employees);\n\n-- INå­æŸ¥è¯¢\nSELECT name\nFROM employees\nWHERE department_id IN (\nSELECT id\nFROM departments\nWHERE location &#x3D; &#39;åŒ—äº¬&#39;\n);\n\n-- EXISTSå­æŸ¥è¯¢\nSELECT d.name\nFROM departments d\nWHERE EXISTS (\nSELECT 1\nFROM employees e\nWHERE e.department_id &#x3D; d.id\n);</code></pre></div></figure>\n<h2 id=\"âš¡-äº”ã€ç´¢å¼•ä¸æ€§èƒ½ä¼˜åŒ–\">âš¡ äº”ã€ç´¢å¼•ä¸æ€§èƒ½ä¼˜åŒ–</h2>\n<h3 id=\"ç´¢å¼•ç±»å‹\">ç´¢å¼•ç±»å‹</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- åˆ›å»ºæ™®é€šç´¢å¼•\nCREATE INDEX idx_email ON employees(email);\n\n-- åˆ›å»ºå”¯ä¸€ç´¢å¼•\nCREATE UNIQUE INDEX uidx_email ON employees(email);\n\n-- åˆ›å»ºå¤åˆç´¢å¼•\nCREATE INDEX idx_dept_salary ON employees(department, salary);\n\n-- æŸ¥çœ‹ç´¢å¼•\nSHOW INDEX FROM employees;\n\n-- åˆ é™¤ç´¢å¼•\nDROP INDEX idx_email ON employees;</code></pre></div></figure>\n<h3 id=\"æŸ¥è¯¢ä¼˜åŒ–æŠ€å·§\">æŸ¥è¯¢ä¼˜åŒ–æŠ€å·§</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- ä½¿ç”¨EXPLAINåˆ†ææŸ¥è¯¢\nEXPLAIN SELECT * FROM employees WHERE department &#x3D; &#39;æŠ€æœ¯éƒ¨&#39;;\n\n-- é¿å…SELECT *\nSELECT id, name, department FROM employees;\n\n-- åˆç†ä½¿ç”¨LIMIT\nSELECT * FROM large_table LIMIT 100;\n\n-- é¿å…åœ¨WHEREå­å¥ä¸­ä½¿ç”¨å‡½æ•°\n-- ä¸æ¨è\nSELECT * FROM employees WHERE YEAR(hire_date) &#x3D; 2023;\n-- æ¨è\nSELECT * FROM employees\nWHERE hire_date BETWEEN &#39;2023-01-01&#39; AND &#39;2023-12-31&#39;;</code></pre></div></figure>\n<h2 id=\"ğŸ‘¥-å…­ã€ç”¨æˆ·ä¸æƒé™ç®¡ç†\">ğŸ‘¥ å…­ã€ç”¨æˆ·ä¸æƒé™ç®¡ç†</h2>\n<h3 id=\"ç”¨æˆ·ç®¡ç†\">ç”¨æˆ·ç®¡ç†</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- åˆ›å»ºç”¨æˆ·\nCREATE USER &#39;dev_user&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;secure_password&#39;;\n\n-- ä¿®æ”¹å¯†ç \nALTER USER &#39;dev_user&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;new_password&#39;;\n\n-- åˆ é™¤ç”¨æˆ·\nDROP USER &#39;old_user&#39;@&#39;%&#39;;</code></pre></div></figure>\n<h3 id=\"æƒé™ç®¡ç†\">æƒé™ç®¡ç†</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- æˆäºˆæƒé™\nGRANT SELECT, INSERT, UPDATE ON company_db.* TO &#39;dev_user&#39;@&#39;localhost&#39;;\n\n-- æˆäºˆæ‰€æœ‰æƒé™\nGRANT ALL PRIVILEGES ON *.* TO &#39;admin&#39;@&#39;%&#39; WITH GRANT OPTION;\n\n-- æŸ¥çœ‹æƒé™\nSHOW GRANTS FOR &#39;dev_user&#39;@&#39;localhost&#39;;\n\n-- æ’¤é”€æƒé™\nREVOKE DELETE ON company_db.* FROM &#39;dev_user&#39;@&#39;localhost&#39;;\n\n-- åˆ·æ–°æƒé™\nFLUSH PRIVILEGES;</code></pre></div></figure>\n<h2 id=\"ğŸ’¾-ä¸ƒã€å¤‡ä»½ä¸æ¢å¤\">ğŸ’¾ ä¸ƒã€å¤‡ä»½ä¸æ¢å¤</h2>\n<h3 id=\"å¤‡ä»½æ•°æ®åº“\">å¤‡ä»½æ•°æ®åº“</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-bash\" data-language=\"bash\" data-start=\"1\"><code class=\"language-bash\"># å¤‡ä»½å•ä¸ªæ•°æ®åº“\nmysqldump -u root -p company_db &gt; company_db_backup.sql\n\n# å¤‡ä»½æ‰€æœ‰æ•°æ®åº“\nmysqldump -u root -p --all-databases &gt; all_dbs_backup.sql\n\n# å‹ç¼©å¤‡ä»½\nmysqldump -u root -p company_db | gzip &gt; company_db_backup.sql.gz</code></pre></div></figure>\n<h3 id=\"æ¢å¤æ•°æ®åº“\">æ¢å¤æ•°æ®åº“</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-bash\" data-language=\"bash\" data-start=\"1\"><code class=\"language-bash\"># æ¢å¤æ•°æ®åº“\nmysql -u root -p company_db &lt; company_db_backup.sql\n\n# ä»å‹ç¼©æ–‡ä»¶æ¢å¤\ngunzip &lt; company_db_backup.sql.gz | mysql -u root -p company_db\n\n# å•è¡¨æ¢å¤\nmysql -u root -p company_db employees &lt; employees_backup.sql</code></pre></div></figure>\n<h3 id=\"å®šæ—¶å¤‡ä»½ï¼ˆCron-Jobï¼‰\">å®šæ—¶å¤‡ä»½ï¼ˆCron Jobï¼‰</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-bash\" data-language=\"bash\" data-start=\"1\"><code class=\"language-bash\"># æ·»åŠ å®šæ—¶ä»»åŠ¡\ncrontab -e\n\n# æ¯å¤©å‡Œæ™¨2ç‚¹å¤‡ä»½\n0 2 * * * &#x2F;usr&#x2F;bin&#x2F;mysqldump -u root -pPASSWORD company_db | gzip &gt; &#x2F;backups&#x2F;company_db_$(date +\\%F).sql.gz</code></pre></div></figure>\n<h2 id=\"ğŸ”„-å…«ã€äº‹åŠ¡ä¸é”æœºåˆ¶\">ğŸ”„ å…«ã€äº‹åŠ¡ä¸é”æœºåˆ¶</h2>\n<h3 id=\"äº‹åŠ¡å¤„ç†\">äº‹åŠ¡å¤„ç†</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- å¼€å§‹äº‹åŠ¡\nSTART TRANSACTION;\n\n-- æ‰§è¡Œæ“ä½œ\nUPDATE accounts SET balance &#x3D; balance - 100 WHERE id &#x3D; 1;\nUPDATE accounts SET balance &#x3D; balance + 100 WHERE id &#x3D; 2;\n\n-- æäº¤äº‹åŠ¡\nCOMMIT;\n\n-- å›æ»šäº‹åŠ¡\nROLLBACK;</code></pre></div></figure>\n<h3 id=\"äº‹åŠ¡éš”ç¦»çº§åˆ«\">äº‹åŠ¡éš”ç¦»çº§åˆ«</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- æŸ¥çœ‹å½“å‰éš”ç¦»çº§åˆ«\nSELECT @@transaction_isolation;\n\n-- è®¾ç½®éš”ç¦»çº§åˆ«\nSET SESSION TRANSACTION ISOLATION LEVEL READ COMMITTED;</code></pre></div></figure>\n<h3 id=\"é”æœºåˆ¶\">é”æœºåˆ¶</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- æ‰‹åŠ¨åŠ é”\nSELECT * FROM orders WHERE id &#x3D; 100 FOR UPDATE;\n\n-- æŸ¥çœ‹å½“å‰é”\nSHOW OPEN TABLES WHERE In_use &gt; 0;</code></pre></div></figure>\n<h2 id=\"ğŸ§©-ä¹ã€å­˜å‚¨è¿‡ç¨‹ä¸å‡½æ•°\">ğŸ§© ä¹ã€å­˜å‚¨è¿‡ç¨‹ä¸å‡½æ•°</h2>\n<h3 id=\"åˆ›å»ºå­˜å‚¨è¿‡ç¨‹\">åˆ›å»ºå­˜å‚¨è¿‡ç¨‹</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">DELIMITER &#x2F;&#x2F;\n\nCREATE PROCEDURE IncreaseSalaries(IN dept_name VARCHAR(50), IN increase_percent FLOAT)\nBEGIN\nUPDATE employees\nSET salary &#x3D; salary * (1 + increase_percent&#x2F;100)\nWHERE department &#x3D; dept_name;\nEND &#x2F;&#x2F;\n\nDELIMITER ;\n\n-- è°ƒç”¨å­˜å‚¨è¿‡ç¨‹\nCALL IncreaseSalaries(&#39;æŠ€æœ¯éƒ¨&#39;, 10);</code></pre></div></figure>\n<h3 id=\"åˆ›å»ºå‡½æ•°\">åˆ›å»ºå‡½æ•°</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">DELIMITER &#x2F;&#x2F;\n\nCREATE FUNCTION GetEmployeeCount(dept_name VARCHAR(50))\nRETURNS INT\nDETERMINISTIC\nBEGIN\nDECLARE emp_count INT;\nSELECT COUNT(*) INTO emp_count\nFROM employees\nWHERE department &#x3D; dept_name;\nRETURN emp_count;\nEND &#x2F;&#x2F;\n\nDELIMITER ;\n\n-- ä½¿ç”¨å‡½æ•°\nSELECT GetEmployeeCount(&#39;å¸‚åœºéƒ¨&#39;);</code></pre></div></figure>\n<h2 id=\"â°-åã€è§¦å‘å™¨ä¸äº‹ä»¶è°ƒåº¦\">â° åã€è§¦å‘å™¨ä¸äº‹ä»¶è°ƒåº¦</h2>\n<h3 id=\"åˆ›å»ºè§¦å‘å™¨\">åˆ›å»ºè§¦å‘å™¨</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- å®¡è®¡æ—¥å¿—è¡¨\nCREATE TABLE audit_log (\nid INT AUTO_INCREMENT PRIMARY KEY,\naction VARCHAR(20),\ntable_name VARCHAR(50),\nrecord_id INT,\nchange_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\n-- åˆ›å»ºè§¦å‘å™¨\nDELIMITER &#x2F;&#x2F;\n\nCREATE TRIGGER after_employee_update\nAFTER UPDATE ON employees\nFOR EACH ROW\nBEGIN\nINSERT INTO audit_log (action, table_name, record_id)\nVALUES (&#39;UPDATE&#39;, &#39;employees&#39;, NEW.id);\nEND &#x2F;&#x2F;\n\nDELIMITER ;</code></pre></div></figure>\n<h3 id=\"äº‹ä»¶è°ƒåº¦\">äº‹ä»¶è°ƒåº¦</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- å¯ç”¨äº‹ä»¶è°ƒåº¦å™¨\nSET GLOBAL event_scheduler &#x3D; ON;\n\n-- åˆ›å»ºå®šæœŸæ¸…ç†äº‹ä»¶\nCREATE EVENT daily_audit_cleanup\nON SCHEDULE EVERY 1 DAY\nSTARTS CURRENT_TIMESTAMP\nDO\nDELETE FROM audit_log WHERE change_time &lt; NOW() - INTERVAL 30 DAY;</code></pre></div></figure>\n<h2 id=\"ğŸ-åä¸€ã€Python-ä¸­ä½¿ç”¨-MySQL\">ğŸ åä¸€ã€Python ä¸­ä½¿ç”¨ MySQL</h2>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-python\" data-language=\"python\" data-start=\"1\"><code class=\"language-python\">import mysql.connector\nfrom mysql.connector import Error\n\ntry:\n# åˆ›å»ºè¿æ¥\nconnection &#x3D; mysql.connector.connect(\nhost&#x3D;&#39;localhost&#39;,\nuser&#x3D;&#39;python_user&#39;,\npassword&#x3D;&#39;secure_pass&#39;,\ndatabase&#x3D;&#39;company_db&#39;\n)\n\nif connection.is_connected():\ncursor &#x3D; connection.cursor()\n\n# æ‰§è¡ŒæŸ¥è¯¢\ncursor.execute(&quot;SELECT * FROM employees&quot;)\nemployees &#x3D; cursor.fetchall()\n\n# æ’å…¥æ•°æ®\ninsert_query &#x3D; &quot;&quot;&quot;\nINSERT INTO employees (name, email, department, salary)\nVALUES (%s, %s, %s, %s)\n&quot;&quot;&quot;\nemployee_data &#x3D; (&#39;é’±ä¸ƒ&#39;, &#39;qian@company.com&#39;, &#39;äººäº‹éƒ¨&#39;, 11000)\ncursor.execute(insert_query, employee_data)\nconnection.commit()\n\n# æ›´æ–°æ•°æ®\nupdate_query &#x3D; &quot;UPDATE employees SET salary &#x3D; salary * 1.05 WHERE department &#x3D; %s&quot;\ncursor.execute(update_query, (&#39;æŠ€æœ¯éƒ¨&#39;,))\nconnection.commit()\n\nexcept Error as e:\nprint(&quot;æ•°æ®åº“é”™è¯¯:&quot;, e)\n\nfinally:\nif connection.is_connected():\ncursor.close()\nconnection.close()</code></pre></div></figure>\n<h2 id=\"ğŸš¨-åäºŒã€å¸¸è§é—®é¢˜è§£å†³\">ğŸš¨ åäºŒã€å¸¸è§é—®é¢˜è§£å†³</h2>\n<h3 id=\"å¿˜è®°-root-å¯†ç \">å¿˜è®° root å¯†ç </h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-bash\" data-language=\"bash\" data-start=\"1\"><code class=\"language-bash\"># åœæ­¢MySQLæœåŠ¡\nsudo systemctl stop mysql\n\n# å¯åŠ¨å®‰å…¨æ¨¡å¼\nsudo mysqld_safe --skip-grant-tables &amp;\n\n# ç™»å½•å¹¶ä¿®æ”¹å¯†ç \nmysql -u root\nFLUSH PRIVILEGES;\nALTER USER &#39;root&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;new_password&#39;;\nFLUSH PRIVILEGES;\nexit;\n\n# é‡å¯MySQL\nsudo systemctl restart mysql</code></pre></div></figure>\n<h3 id=\"æ€§èƒ½é—®é¢˜è¯Šæ–­\">æ€§èƒ½é—®é¢˜è¯Šæ–­</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- æŸ¥çœ‹æ…¢æŸ¥è¯¢\nSHOW VARIABLES LIKE &#39;slow_query_log&#39;;\nSHOW VARIABLES LIKE &#39;long_query_time&#39;;\n\n-- æŸ¥çœ‹è¿›ç¨‹åˆ—è¡¨\nSHOW PROCESSLIST;\n\n-- ä¼˜åŒ–è¡¨\nOPTIMIZE TABLE large_table;\n\n-- åˆ†æè¡¨\nANALYZE TABLE employees;</code></pre></div></figure>\n<h3 id=\"è¿æ¥é—®é¢˜æ’æŸ¥\">è¿æ¥é—®é¢˜æ’æŸ¥</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-bash\" data-language=\"bash\" data-start=\"1\"><code class=\"language-bash\"># é”™è¯¯ï¼šERROR 1045 (28000)\n# è§£å†³æ–¹æ¡ˆï¼šæ£€æŸ¥ç”¨æˆ·å&#x2F;å¯†ç ï¼Œç¡®ä¿ä¸»æœºæƒé™\n\n# é”™è¯¯ï¼šERROR 2002 (HY000)\n# è§£å†³æ–¹æ¡ˆï¼šç¡®è®¤MySQLæœåŠ¡è¿è¡Œä¸­ï¼Œæ£€æŸ¥socketè·¯å¾„\n\n# é”™è¯¯ï¼šERROR 2013 (HY000)\n# è§£å†³æ–¹æ¡ˆï¼šå¢åŠ è¿æ¥è¶…æ—¶æ—¶é—´ wait_timeout</code></pre></div></figure>\n<h2 id=\"ğŸ“š-å­¦ä¹ èµ„æºæ¨è\">ğŸ“š å­¦ä¹ èµ„æºæ¨è</h2>\n<ol>\n<li><a href=\"https://dev.mysql.com/doc/\">MySQL å®˜æ–¹æ–‡æ¡£</a> - æœ€æƒå¨çš„å‚è€ƒèµ„æ–™</li>\n<li><a href=\"https://www.mysqltutorial.org/\">MySQL Tutorial</a> - å…è´¹æ•™ç¨‹ç½‘ç«™</li>\n<li><a href=\"https://leetcode.com/problemset/database/\">LeetCode æ•°æ®åº“é¢˜åº“</a> - å®æˆ˜ç»ƒä¹ </li>\n<li><a href=\"https://www.mysql.com/products/workbench/\">MySQL Workbench</a> - å®˜æ–¹å›¾å½¢åŒ–ç®¡ç†å·¥å…·</li>\n<li><a href=\"https://www.percona.com/software/database-tools/percona-toolkit\">Percona Toolkit</a> - é«˜çº§ç®¡ç†å·¥å…·é›†</li>\n</ol>\n<pre><code class=\"mermaid\">graph TD\nA[å®‰è£…MySQL] --&gt; B[åˆ›å»ºæ•°æ®åº“]\nB --&gt; C[è®¾è®¡è¡¨ç»“æ„]\nC --&gt; D[æ•°æ®æ“ä½œCRUD]\nD --&gt; E[é«˜çº§æŸ¥è¯¢]\nE --&gt; F[æ€§èƒ½ä¼˜åŒ–]\nF --&gt; G[å¤‡ä»½æ¢å¤]\nG --&gt; H[äº‹åŠ¡ç®¡ç†]\nH --&gt; I[ç¨‹åºé›†æˆ]</code></pre>\n<blockquote>\n<p>MySQL ä½œä¸ºæœ€æµè¡Œçš„å…³ç³»å‹æ•°æ®åº“ä¹‹ä¸€ï¼ŒæŒæ¡å…¶æ ¸å¿ƒåŠŸèƒ½å¯¹å¼€å‘è€…å’ŒDBAè‡³å…³é‡è¦ã€‚æœ¬æ•™ç¨‹è¦†ç›–äº†ä»åŸºç¡€åˆ°é«˜çº§çš„å…¨é¢çŸ¥è¯†ä½“ç³»ï¼Œå»ºè®®ç»“åˆå®é™…é¡¹ç›®å®è·µåŠ æ·±ç†è§£ã€‚è®°ä½ï¼Œæ•°æ®åº“è®¾è®¡ä¼˜åŒ–å¾€å¾€æ¯”ç¡¬ä»¶å‡çº§æ›´èƒ½æå‡æ€§èƒ½ï¼</p>\n</blockquote>\n<h2 id=\"å‚è€ƒ-è‡´è°¢\">å‚è€ƒ&amp;è‡´è°¢</h2>\n<h2 id=\"ç³»åˆ—æ•™ç¨‹\"><strong>ç³»åˆ—æ•™ç¨‹</strong></h2>\n<p><a href=\"/atom.xml\"><i class=\"fas fa-rss\"></i>å…¨éƒ¨æ–‡ç« RSSè®¢é˜…</a></p>\n\n<h3 id=\"æ•°æ®åº“ç³»åˆ—\"><strong>æ•°æ®åº“ç³»åˆ—</strong></h3>\n<ul>\n<li><a href=\"/posts/b2f7c564/\">SQLå‘½ä»¤ä½¿ç”¨æ•™ç¨‹ï¼šä»å…¥é—¨åˆ°ç²¾é€š</a></li>\n<li><a href=\"/posts/847851a6/\">SQLiteä½¿ç”¨å…¨é¢æ•™ç¨‹ï¼šè½»é‡çº§æ•°æ®åº“çš„ç»ˆææŒ‡å—</a></li>\n<li><a href=\"/posts/a460ae99/\">MySQLå‘½ä»¤è¡Œä½¿ç”¨å…¨é¢æ•™ç¨‹ï¼šä»å…¥é—¨åˆ°ç²¾é€š</a></li>\n<li><a href=\"/posts/622f0f0f/\">MySQL ä½¿ç”¨å…¨é¢æŒ‡å—ï¼šä»å…¥é—¨åˆ°é«˜çº§å®è·µ</a></li>\n<li><a href=\"/posts/16bffe88/\">PostgreSQL ä½¿ç”¨å…¨é¢æŒ‡å—ï¼šä»å…¥é—¨åˆ°ä¼ä¸šçº§åº”ç”¨</a></li>\n<li><a href=\"/posts/6c6f64dc/\">PostgreSQLå‘½ä»¤è¡Œä½¿ç”¨æ•™ç¨‹ï¼šæŒæ¡ psql å·¥å…·</a></li>\n<li><a href=\"/posts/a416ccaa/\">PostgreSQL å®ç°åŸç†æ·±åº¦å‰–æï¼šé«˜æ€§èƒ½æ•°æ®åº“å¼•æ“çš„æ ¸å¿ƒæœºåˆ¶</a></li>\n</ul>\n\n<link rel=\"stylesheet\" href=\"https://fastly.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/style.css\"><script src=\"https://fastly.jsdelivr.net/npm/d3@7\"></script><script src=\"https://fastly.jsdelivr.net/npm/markmap-view@0.18.10\"></script><script src=\"https://fastly.jsdelivr.net/npm/markmap-toolbar@0.18.10\"></script>\n<link rel=\"stylesheet\" href=\"/css/markmap.css\">\n\n<script src=\"/js/markmap.js\"></script>\n",
            "tags": [
                "mysql",
                "sql"
            ]
        },
        {
            "id": "https://blog.17lai.site/posts/847851a6/",
            "url": "https://blog.17lai.site/posts/847851a6/",
            "title": "SQLiteä½¿ç”¨å…¨é¢æ•™ç¨‹ï¼šè½»é‡çº§æ•°æ®åº“çš„ç»ˆææŒ‡å—",
            "date_published": "2025-11-22T07:28:00.000Z",
            "content_html": "<blockquote>\n<p>SQLiteæ˜¯ä¸–ç•Œä¸Šæœ€å¹¿æ³›éƒ¨ç½²çš„æ•°æ®åº“å¼•æ“ï¼Œä»¥å…¶è½»é‡ã€é›¶é…ç½®å’ŒåµŒå…¥å¼ç‰¹æ€§è‘—ç§°ã€‚æœ¬æ•™ç¨‹å°†å¸¦ä½ ä»åŸºç¡€åˆ°é«˜çº§å…¨é¢æŒæ¡SQLiteçš„ä½¿ç”¨æŠ€å·§ï¼Œç‰¹åˆ«å¼ºåŒ–äº†æ•°æ®åº“è¿æ¥å’Œå‘½ä»¤è¡Œæ“ä½œéƒ¨åˆ†ã€‚</p>\n</blockquote>\n<span id=\"more\"></span>\n<p><img src=\"https://cimg1.17lai.site/data/2025/11/22/20251122171925.webp\" alt=\"\"></p>\n<h2 id=\"ä¸€ã€å®‰è£…ä¸é…ç½®\">ä¸€ã€å®‰è£…ä¸é…ç½®</h2>\n<h3 id=\"Windowså®‰è£…\">Windowså®‰è£…</h3>\n<ol>\n<li>è®¿é—® <a href=\"https://sqlite.org/download.html\">SQLiteå®˜ç½‘</a></li>\n<li>ä¸‹è½½ <code>sqlite-tools-win32-*.zip</code></li>\n<li>è§£å‹åæ·»åŠ ç›®å½•åˆ°ç³»ç»ŸPATH</li>\n<li>å‘½ä»¤è¡Œè¾“å…¥ <code>sqlite3</code> éªŒè¯å®‰è£…</li>\n</ol>\n<h3 id=\"Linux-macOSå®‰è£…\">Linux/macOSå®‰è£…</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-bash\" data-language=\"bash\" data-start=\"1\"><code class=\"language-bash\"># Debian&#x2F;Ubuntu\nsudo apt install sqlite3\n\n# macOS (éœ€å…ˆå®‰è£…Homebrew)\nbrew install sqlite</code></pre></div></figure>\n<h2 id=\"äºŒã€æ•°æ®åº“è¿æ¥ä¸åŸºæœ¬æ“ä½œ\">äºŒã€æ•°æ®åº“è¿æ¥ä¸åŸºæœ¬æ“ä½œ</h2>\n<h3 id=\"åˆ›å»ºå¹¶è¿æ¥æ•°æ®åº“\">åˆ›å»ºå¹¶è¿æ¥æ•°æ®åº“</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-bash\" data-language=\"bash\" data-start=\"1\"><code class=\"language-bash\"># åˆ›å»ºæˆ–æ‰“å¼€æ•°æ®åº“ï¼ˆä¸å­˜åœ¨åˆ™åˆ›å»ºï¼‰\nsqlite3 mydatabase.db</code></pre></div></figure>\n<p>æˆåŠŸè¿æ¥åï¼Œæç¤ºç¬¦å˜ä¸ºï¼š</p>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-bash\" data-language=\"bash\" data-start=\"1\"><code class=\"language-bash\">sqlite&gt;</code></pre></div></figure>\n<h3 id=\"å®æ—¶æ“ä½œç¤ºä¾‹\">å®æ—¶æ“ä½œç¤ºä¾‹</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- åˆ›å»ºç”¨æˆ·è¡¨\nCREATE TABLE users (\nid INTEGER PRIMARY KEY AUTOINCREMENT,\nname TEXT NOT NULL,\nemail TEXT UNIQUE,\ncreated_at DATETIME DEFAULT CURRENT_TIMESTAMP\n);\n\n-- æ’å…¥æ•°æ®\nINSERT INTO users (name, email) VALUES\n(&#39;å¼ ä¸‰&#39;, &#39;zhangsan@example.com&#39;),\n(&#39;æå››&#39;, &#39;lisi@example.com&#39;);\n\n-- æŸ¥è¯¢æ•°æ®\nSELECT * FROM users;\n\n-- é€€å‡ºSQLiteå‘½ä»¤è¡Œ\n.quit</code></pre></div></figure>\n<h3 id=\"è¿æ¥åˆ°ç°æœ‰æ•°æ®åº“\">è¿æ¥åˆ°ç°æœ‰æ•°æ®åº“</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-bash\" data-language=\"bash\" data-start=\"1\"><code class=\"language-bash\"># è¿æ¥åˆ°å·²å­˜åœ¨çš„æ•°æ®åº“\nsqlite3 existing_db.db</code></pre></div></figure>\n<h3 id=\"å†…å­˜æ•°æ®åº“ï¼ˆä¸´æ—¶æ•°æ®åº“ï¼‰\">å†…å­˜æ•°æ®åº“ï¼ˆä¸´æ—¶æ•°æ®åº“ï¼‰</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-bash\" data-language=\"bash\" data-start=\"1\"><code class=\"language-bash\"># åˆ›å»ºå†…å­˜ä¸­çš„ä¸´æ—¶æ•°æ®åº“ï¼ˆå…³é—­åæ¶ˆå¤±ï¼‰\nsqlite3 :memory:</code></pre></div></figure>\n<h2 id=\"ä¸‰ã€SQLiteå‘½ä»¤è¡Œå·¥å…·é«˜çº§ç”¨æ³•\">ä¸‰ã€SQLiteå‘½ä»¤è¡Œå·¥å…·é«˜çº§ç”¨æ³•</h2>\n<h3 id=\"å¸¸ç”¨ç‚¹å‘½ä»¤\">å¸¸ç”¨ç‚¹å‘½ä»¤</h3>\n<table>\n<thead>\n<tr>\n<th>å‘½ä»¤</th>\n<th>è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>.open test.db</code></td>\n<td>æ‰“å¼€/åˆ›å»ºæ•°æ®åº“</td>\n</tr>\n<tr>\n<td><code>.tables</code></td>\n<td>æ˜¾ç¤ºæ‰€æœ‰è¡¨</td>\n</tr>\n<tr>\n<td><code>.schema users</code></td>\n<td>æ˜¾ç¤ºè¡¨ç»“æ„</td>\n</tr>\n<tr>\n<td><code>.mode column</code></td>\n<td>åˆ—æ¨¡å¼æ˜¾ç¤º</td>\n</tr>\n<tr>\n<td><code>.headers on</code></td>\n<td>æ˜¾ç¤ºåˆ—å</td>\n</tr>\n<tr>\n<td><code>.show</code></td>\n<td>æ˜¾ç¤ºå½“å‰é…ç½®</td>\n</tr>\n<tr>\n<td><code>.quit</code></td>\n<td>é€€å‡ºå‘½ä»¤è¡Œ</td>\n</tr>\n<tr>\n<td><code>.help</code></td>\n<td>æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"æ•°æ®å¯¼å…¥å¯¼å‡ºå®æˆ˜\">æ•°æ®å¯¼å…¥å¯¼å‡ºå®æˆ˜</h3>\n<p><strong>å¯¼å‡ºæ•°æ®åˆ°CSVï¼š</strong></p>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-bash\" data-language=\"bash\" data-start=\"1\"><code class=\"language-bash\">sqlite3 mydatabase.db\n.headers on\n.mode csv\n.output users.csv\nSELECT * FROM users;\n.output stdout</code></pre></div></figure>\n<p><strong>ä»CSVå¯¼å…¥æ•°æ®ï¼š</strong></p>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- åˆ›å»ºä¸´æ—¶è¡¨\nCREATE TABLE temp_import(\nname TEXT,\nemail TEXT\n);\n\n-- å¯¼å…¥æ•°æ®\n.mode csv\n.import &#x2F;path&#x2F;to&#x2F;new_users.csv temp_import\n\n-- æ’å…¥åˆ°ä¸»è¡¨\nINSERT INTO users (name, email)\nSELECT name, email FROM temp_import;\n\n-- æ¸…ç†ä¸´æ—¶è¡¨\nDROP TABLE temp_import;</code></pre></div></figure>\n<h3 id=\"å¤‡ä»½ä¸æ¢å¤\">å¤‡ä»½ä¸æ¢å¤</h3>\n<p><strong>å®Œæ•´å¤‡ä»½ï¼š</strong></p>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-bash\" data-language=\"bash\" data-start=\"1\"><code class=\"language-bash\">sqlite3 mydatabase.db &quot;.backup &#39;backup.db&#39;&quot;</code></pre></div></figure>\n<p><strong>å¢é‡å¤‡ä»½ï¼ˆä½¿ç”¨WALæ¨¡å¼ï¼‰ï¼š</strong></p>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-bash\" data-language=\"bash\" data-start=\"1\"><code class=\"language-bash\"># å¯ç”¨WALæ¨¡å¼\nsqlite3 mydatabase.db &quot;PRAGMA journal_mode&#x3D;WAL;&quot;\n\n# åˆ›å»ºå¤‡ä»½\ncp mydatabase.db backup.db\ncp mydatabase.db-wal backup.db-wal\ncp mydatabase.db-shm backup.db-shm</code></pre></div></figure>\n<h2 id=\"å››ã€Pythoné›†æˆå®æˆ˜\">å››ã€Pythoné›†æˆå®æˆ˜</h2>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-python\" data-language=\"python\" data-start=\"1\"><code class=\"language-python\">import sqlite3\nfrom datetime import datetime\n\n# è¿æ¥æ•°æ®åº“ï¼ˆä¸å­˜åœ¨åˆ™åˆ›å»ºï¼‰\nconn &#x3D; sqlite3.connect(&#39;mydatabase.db&#39;)\ncursor &#x3D; conn.cursor()\n\n# åˆ›å»ºè¡¨\ncursor.execute(&#39;&#39;&#39;CREATE TABLE IF NOT EXISTS orders (\nid INTEGER PRIMARY KEY,\nuser_id INTEGER,\nproduct TEXT,\namount REAL,\norder_date TIMESTAMP,\nFOREIGN KEY(user_id) REFERENCES users(id))&#39;&#39;&#39;)\n\n# æ’å…¥è®¢å•æ•°æ®\nuser_id &#x3D; 1\norders &#x3D; [\n(user_id, &#39;Laptop&#39;, 1200.50, datetime.now()),\n(user_id, &#39;Mouse&#39;, 25.99, datetime.now())\n]\ncursor.executemany(&quot;INSERT INTO orders (user_id, product, amount, order_date) VALUES (?, ?, ?, ?)&quot;, orders)\n\n# å¤æ‚æŸ¥è¯¢ï¼šç”¨æˆ·åŠå…¶è®¢å•\ncursor.execute(&#39;&#39;&#39;SELECT users.name, orders.product, orders.amount\nFROM users\nJOIN orders ON users.id &#x3D; orders.user_id&#39;&#39;&#39;)\nfor row in cursor.fetchall():\nprint(f&quot;&#123;row&#125; purchased &#123;row&#125; for $&#123;row:.2f&#125;&quot;)\n\n# æäº¤å¹¶å…³é—­è¿æ¥\nconn.commit()\nconn.close()</code></pre></div></figure>\n<h2 id=\"äº”ã€é«˜çº§ç‰¹æ€§ä¸ä¼˜åŒ–\">äº”ã€é«˜çº§ç‰¹æ€§ä¸ä¼˜åŒ–</h2>\n<h3 id=\"äº‹åŠ¡å¤„ç†\">äº‹åŠ¡å¤„ç†</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">BEGIN TRANSACTION;\n\n-- è½¬è´¦æ“ä½œ\nUPDATE accounts SET balance &#x3D; balance - 100 WHERE id &#x3D; 1;\nUPDATE accounts SET balance &#x3D; balance + 100 WHERE id &#x3D; 2;\n\n-- æäº¤äº‹åŠ¡\nCOMMIT;\n\n-- å‡ºé”™æ—¶å›æ»š\n-- ROLLBACK;</code></pre></div></figure>\n<h3 id=\"æ€§èƒ½ä¼˜åŒ–æŠ€å·§\">æ€§èƒ½ä¼˜åŒ–æŠ€å·§</h3>\n<ol>\n<li><strong>ç´¢å¼•ä¼˜åŒ–</strong>ï¼š</li>\n</ol>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">CREATE INDEX idx_users_email ON users(email);\nCREATE INDEX idx_orders_date ON orders(order_date);</code></pre></div></figure>\n<ol start=\"2\">\n<li><strong>WALæ¨¡å¼</strong>ï¼š</li>\n</ol>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">PRAGMA journal_mode&#x3D;WAL;-- å¯ç”¨å†™å‰æ—¥å¿—</code></pre></div></figure>\n<ol start=\"3\">\n<li><strong>ç¼“å­˜è°ƒæ•´</strong>ï¼š</li>\n</ol>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">PRAGMA cache_size &#x3D; -2000;-- è®¾ç½®2000é¡µç¼“å­˜(çº¦3.2MB)</code></pre></div></figure>\n<ol start=\"4\">\n<li><strong>æŸ¥è¯¢ä¼˜åŒ–</strong>ï¼š</li>\n</ol>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">EXPLAIN QUERY PLAN SELECT * FROM users WHERE email &#x3D; &#39;test@example.com&#39;;</code></pre></div></figure>\n<h3 id=\"å…¨æ–‡æœç´¢\">å…¨æ–‡æœç´¢</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- åˆ›å»ºè™šæ‹Ÿè¡¨\nCREATE VIRTUAL TABLE docs USING fts5(title, content);\n\n-- æ’å…¥æ•°æ®\nINSERT INTO docs VALUES\n(&#39;SQLite Guide&#39;, &#39;Comprehensive guide to SQLite database&#39;),\n(&#39;Python Tutorial&#39;, &#39;Learn Python programming language&#39;);\n\n-- å…¨æ–‡æœç´¢\nSELECT * FROM docs WHERE docs MATCH &#39;guide database&#39;;</code></pre></div></figure>\n<h2 id=\"å…­ã€å›¾å½¢åŒ–ç®¡ç†å·¥å…·æ¨è\">å…­ã€å›¾å½¢åŒ–ç®¡ç†å·¥å…·æ¨è</h2>\n<ol>\n<li><strong>DB Browser for SQLite</strong>ï¼š</li>\n</ol>\n<ul>\n<li>å¼€æºå¯è§†åŒ–å·¥å…·</li>\n<li>ä¸‹è½½åœ°å€ï¼š<a href=\"https://sqlitebrowser.org/\">https://sqlitebrowser.org/</a></li>\n</ul>\n<ol start=\"2\">\n<li><strong>SQLiteStudio</strong>ï¼š</li>\n</ol>\n<ul>\n<li>è·¨å¹³å°å¤šåŠŸèƒ½ç®¡ç†å™¨</li>\n<li>ä¸‹è½½åœ°å€ï¼š<a href=\"https://sqlitestudio.pl/\">https://sqlitestudio.pl/</a></li>\n</ul>\n<h2 id=\"ä¸ƒã€å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ\">ä¸ƒã€å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ</h2>\n<h3 id=\"æ•°æ®åº“é”å®šé—®é¢˜\">æ•°æ®åº“é”å®šé—®é¢˜</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-bash\" data-language=\"bash\" data-start=\"1\"><code class=\"language-bash\"># æŸ¥çœ‹é”å®šè¿›ç¨‹\nlsof mydatabase.db\n\n# å®‰å…¨è§£é”\ncp mydatabase.db unlocked.db\nsqlite3 unlocked.db &quot;PRAGMA wal_checkpoint;&quot;</code></pre></div></figure>\n<h3 id=\"æ•°æ®åº“ä¿®å¤\">æ•°æ®åº“ä¿®å¤</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-bash\" data-language=\"bash\" data-start=\"1\"><code class=\"language-bash\"># å¯¼å‡ºæ•°æ®\nsqlite3 corrupt.db .dump &gt; recovery.sql\n\n# é‡å»ºæ•°æ®åº“\nsqlite3 new.db &lt; recovery.sql</code></pre></div></figure>\n<h3 id=\"è·¨æ•°æ®åº“æ“ä½œ\">è·¨æ•°æ®åº“æ“ä½œ</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- é™„åŠ å¦ä¸€ä¸ªæ•°æ®åº“\nATTACH DATABASE &#39;another.db&#39; AS other;\n\n-- è·¨æ•°æ®åº“æŸ¥è¯¢\nSELECT * FROM main.users\nUNION ALL\nSELECT * FROM other.users;\n\n-- åˆ†ç¦»æ•°æ®åº“\nDETACH DATABASE other;</code></pre></div></figure>\n<h2 id=\"å…«ã€å®é™…åº”ç”¨åœºæ™¯\">å…«ã€å®é™…åº”ç”¨åœºæ™¯</h2>\n<h3 id=\"ç§»åŠ¨åº”ç”¨æ•°æ®å­˜å‚¨\">ç§»åŠ¨åº”ç”¨æ•°æ®å­˜å‚¨</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-java\" data-language=\"java\" data-start=\"1\"><code class=\"language-java\">&#x2F;&#x2F; Androidç¤ºä¾‹\nSQLiteDatabase db &#x3D; openOrCreateDatabase(&quot;app_data.db&quot;, MODE_PRIVATE, null);\ndb.execSQL(&quot;CREATE TABLE IF NOT EXISTS settings (key TEXT PRIMARY KEY, value TEXT)&quot;);\nContentValues values &#x3D; new ContentValues();\nvalues.put(&quot;key&quot;, &quot;theme&quot;);\nvalues.put(&quot;value&quot;, &quot;dark&quot;);\ndb.insert(&quot;settings&quot;, null, values);</code></pre></div></figure>\n<h3 id=\"ç½‘ç«™æ•°æ®åˆ†æ\">ç½‘ç«™æ•°æ®åˆ†æ</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-python\" data-language=\"python\" data-start=\"1\"><code class=\"language-python\"># æ—¥å¿—åˆ†æç¤ºä¾‹\nimport sqlite3\n\nconn &#x3D; sqlite3.connect(&#39;weblog.db&#39;)\nconn.execute(&#39;&#39;&#39;CREATE TABLE IF NOT EXISTS visits\n(id INTEGER PRIMARY KEY,\nip TEXT,\nurl TEXT,\ntimestamp DATETIME DEFAULT CURRENT_TIMESTAMP)&#39;&#39;&#39;)\n\n# æ¨¡æ‹Ÿæ’å…¥è®¿é—®è®°å½•\nconn.execute(&quot;INSERT INTO visits (ip, url) VALUES (?, ?)&quot;,\n(&#39;192.168.1.1&#39;, &#39;&#x2F;homepage&#39;))\nconn.commit()</code></pre></div></figure>\n<h2 id=\"å­¦ä¹ èµ„æºæ¨è\">å­¦ä¹ èµ„æºæ¨è</h2>\n<ol>\n<li><a href=\"https://sqlite.org/docs.html\">SQLiteå®˜æ–¹æ–‡æ¡£</a> - æœ€æƒå¨çš„å‚è€ƒæŒ‡å—</li>\n<li><a href=\"https://www.sqlitetutorial.net/\">SQLite Tutorial</a> - äº¤äº’å¼å­¦ä¹ å¹³å°</li>\n<li><a href=\"https://sqlfiddle.com/\">SQLite Fiddle</a> - åœ¨çº¿SQLiteæµ‹è¯•ç¯å¢ƒ</li>\n<li><a href=\"https://sqliteviewer.app/\">SQLite Viewer</a> - åœ¨çº¿æŸ¥çœ‹SQLiteæ–‡ä»¶</li>\n</ol>\n<pre><code class=\"mermaid\">graph TD\nA[å¯åŠ¨SQLite] --&gt; B&#123;æ•°æ®åº“å­˜åœ¨ï¼Ÿ&#125;\nB --&gt;|æ˜¯| C[æ‰“å¼€æ•°æ®åº“]\nB --&gt;|å¦| D[åˆ›å»ºæ–°æ•°æ®åº“]\nC --&gt; E[æ‰§è¡ŒSQLæ“ä½œ]\nD --&gt; E\nE --&gt; F[ä¿å­˜æ›´æ”¹]\nF --&gt; G[é€€å‡ºSQLite]</code></pre>\n<blockquote>\n<p>é€šè¿‡æœ¬å¢å¼ºç‰ˆæ•™ç¨‹ï¼Œä½ ä¸ä»…æŒæ¡äº†SQLiteçš„æ ¸å¿ƒæ“ä½œï¼Œè¿˜å­¦ä¹ äº†å®é™…å¼€å‘ä¸­çš„é«˜çº§æŠ€å·§ã€‚SQLiteçš„è½»é‡çº§ç‰¹æ€§ä½¿å…¶æˆä¸ºåµŒå…¥å¼ç³»ç»Ÿã€ç§»åŠ¨åº”ç”¨å’Œå°å‹ç½‘ç«™çš„å®Œç¾é€‰æ‹©ï¼Œç«‹å³å¼€å§‹ä½ çš„SQLiteé¡¹ç›®å®è·µå§ï¼</p>\n</blockquote>\n<h2 id=\"å‚è€ƒ-è‡´è°¢\">å‚è€ƒ&amp;è‡´è°¢</h2>\n<h2 id=\"ç³»åˆ—æ•™ç¨‹\"><strong>ç³»åˆ—æ•™ç¨‹</strong></h2>\n<p><a href=\"/atom.xml\"><i class=\"fas fa-rss\"></i>å…¨éƒ¨æ–‡ç« RSSè®¢é˜…</a></p>\n\n<h3 id=\"æ•°æ®åº“ç³»åˆ—\"><strong>æ•°æ®åº“ç³»åˆ—</strong></h3>\n<ul>\n<li><a href=\"/posts/b2f7c564/\">SQLå‘½ä»¤ä½¿ç”¨æ•™ç¨‹ï¼šä»å…¥é—¨åˆ°ç²¾é€š</a></li>\n<li><a href=\"/posts/847851a6/\">SQLiteä½¿ç”¨å…¨é¢æ•™ç¨‹ï¼šè½»é‡çº§æ•°æ®åº“çš„ç»ˆææŒ‡å—</a></li>\n<li><a href=\"/posts/a460ae99/\">MySQLå‘½ä»¤è¡Œä½¿ç”¨å…¨é¢æ•™ç¨‹ï¼šä»å…¥é—¨åˆ°ç²¾é€š</a></li>\n<li><a href=\"/posts/622f0f0f/\">MySQL ä½¿ç”¨å…¨é¢æŒ‡å—ï¼šä»å…¥é—¨åˆ°é«˜çº§å®è·µ</a></li>\n<li><a href=\"/posts/16bffe88/\">PostgreSQL ä½¿ç”¨å…¨é¢æŒ‡å—ï¼šä»å…¥é—¨åˆ°ä¼ä¸šçº§åº”ç”¨</a></li>\n<li><a href=\"/posts/6c6f64dc/\">PostgreSQLå‘½ä»¤è¡Œä½¿ç”¨æ•™ç¨‹ï¼šæŒæ¡ psql å·¥å…·</a></li>\n<li><a href=\"/posts/a416ccaa/\">PostgreSQL å®ç°åŸç†æ·±åº¦å‰–æï¼šé«˜æ€§èƒ½æ•°æ®åº“å¼•æ“çš„æ ¸å¿ƒæœºåˆ¶</a></li>\n</ul>\n\n<link rel=\"stylesheet\" href=\"https://fastly.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/style.css\"><script src=\"https://fastly.jsdelivr.net/npm/d3@7\"></script><script src=\"https://fastly.jsdelivr.net/npm/markmap-view@0.18.10\"></script><script src=\"https://fastly.jsdelivr.net/npm/markmap-toolbar@0.18.10\"></script>\n<link rel=\"stylesheet\" href=\"/css/markmap.css\">\n\n<script src=\"/js/markmap.js\"></script>\n",
            "tags": [
                "sql",
                "sqlite"
            ]
        },
        {
            "id": "https://blog.17lai.site/posts/a460ae99/",
            "url": "https://blog.17lai.site/posts/a460ae99/",
            "title": "MySQLå‘½ä»¤è¡Œä½¿ç”¨å…¨é¢æ•™ç¨‹ï¼šä»å…¥é—¨åˆ°ç²¾é€š",
            "date_published": "2025-11-22T07:18:53.000Z",
            "content_html": "<blockquote>\n<p>MySQLæ˜¯æœ€æµè¡Œçš„å…³ç³»å‹æ•°æ®åº“ä¹‹ä¸€ï¼ŒæŒæ¡å…¶å‘½ä»¤è¡Œå·¥å…·æ˜¯æ¯ä½å¼€å‘è€…å’ŒDBAçš„å¿…å¤‡æŠ€èƒ½ã€‚æœ¬æ•™ç¨‹å°†å¸¦ä½ ç³»ç»Ÿå­¦ä¹ MySQLå‘½ä»¤è¡Œçš„æ ¸å¿ƒåŠŸèƒ½å’Œå®ç”¨æŠ€å·§ã€‚</p>\n</blockquote>\n<span id=\"more\"></span>\n<p><img src=\"https://cimg1.17lai.site/data/2025/11/22/20251122171403.webp\" alt=\"\"></p>\n<h2 id=\"ğŸš€-è¿æ¥MySQLæœåŠ¡å™¨\">ğŸš€ è¿æ¥MySQLæœåŠ¡å™¨</h2>\n<h3 id=\"åŸºç¡€è¿æ¥æ–¹å¼\">åŸºç¡€è¿æ¥æ–¹å¼</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-bash\" data-language=\"bash\" data-start=\"1\"><code class=\"language-bash\"># è¿æ¥åˆ°æœ¬åœ°MySQLæœåŠ¡å™¨\nmysql -u root -p\n\n# æŒ‡å®šä¸»æœºå’Œç«¯å£\nmysql -h 127.0.0.1 -P 3306 -u username -p\n\n# è¿æ¥åç›´æ¥é€‰æ‹©æ•°æ®åº“\nmysql -u root -p database_name</code></pre></div></figure>\n<h3 id=\"è¿æ¥å‚æ•°è¯´æ˜\">è¿æ¥å‚æ•°è¯´æ˜</h3>\n<table>\n<thead>\n<tr>\n<th>å‚æ•°</th>\n<th>è¯´æ˜</th>\n<th>ç¤ºä¾‹</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>-u</code></td>\n<td>ç”¨æˆ·å</td>\n<td><code>-u admin</code></td>\n</tr>\n<tr>\n<td><code>-p</code></td>\n<td>å¯†ç æç¤º</td>\n<td>(å›è½¦åè¾“å…¥å¯†ç )</td>\n</tr>\n<tr>\n<td><code>-h</code></td>\n<td>ä¸»æœºåœ°å€</td>\n<td><code>-h db.example.com</code></td>\n</tr>\n<tr>\n<td><code>-P</code></td>\n<td>ç«¯å£å·</td>\n<td><code>-P 3307</code></td>\n</tr>\n<tr>\n<td><code>-D</code></td>\n<td>æŒ‡å®šæ•°æ®åº“</td>\n<td><code>-D mydb</code></td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"ğŸ”-æ•°æ®åº“ä¸è¡¨æ“ä½œ\">ğŸ” æ•°æ®åº“ä¸è¡¨æ“ä½œ</h2>\n<h3 id=\"æ•°æ®åº“ç®¡ç†\">æ•°æ®åº“ç®¡ç†</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- æ˜¾ç¤ºæ‰€æœ‰æ•°æ®åº“\nSHOW DATABASES;\n\n-- åˆ›å»ºæ–°æ•°æ®åº“\nCREATE DATABASE school_db;\n\n-- é€‰æ‹©æ•°æ®åº“\nUSE school_db;\n\n-- åˆ é™¤æ•°æ®åº“\nDROP DATABASE old_db;</code></pre></div></figure>\n<h3 id=\"è¡¨æ“ä½œ\">è¡¨æ“ä½œ</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- åˆ›å»ºå­¦ç”Ÿè¡¨\nCREATE TABLE students (\nid INT PRIMARY KEY AUTO_INCREMENT,\nname VARCHAR(50) NOT NULL,\nage INT CHECK (age &gt;&#x3D; 15),\nemail VARCHAR(100) UNIQUE,\ncreated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\n-- æ˜¾ç¤ºæ‰€æœ‰è¡¨\nSHOW TABLES;\n\n-- æŸ¥çœ‹è¡¨ç»“æ„\nDESCRIBE students;\n\n-- ä¿®æ”¹è¡¨ç»“æ„\nALTER TABLE students ADD COLUMN major VARCHAR(50);\nALTER TABLE students MODIFY COLUMN age TINYINT;\nALTER TABLE students DROP COLUMN email;</code></pre></div></figure>\n<h2 id=\"ğŸ“Š-æ•°æ®æ“ä½œ-CRUD\">ğŸ“Š æ•°æ®æ“ä½œ(CRUD)</h2>\n<h3 id=\"æ’å…¥æ•°æ®\">æ’å…¥æ•°æ®</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">INSERT INTO students (name, age)\nVALUES\n(&#39;å¼ ä¸‰&#39;, 18),\n(&#39;æå››&#39;, 19),\n(&#39;ç‹äº”&#39;, 17);</code></pre></div></figure>\n<h3 id=\"æŸ¥è¯¢æ•°æ®\">æŸ¥è¯¢æ•°æ®</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- æŸ¥è¯¢æ‰€æœ‰æ•°æ®\nSELECT * FROM students;\n\n-- æ¡ä»¶æŸ¥è¯¢\nSELECT name, age FROM students WHERE age &gt; 18;\n\n-- æ’åºå’Œé™åˆ¶\nSELECT * FROM students ORDER BY created_at DESC LIMIT 5;\n\n-- æ¨¡ç³ŠæŸ¥è¯¢\nSELECT * FROM students WHERE name LIKE &#39;å¼ %&#39;;</code></pre></div></figure>\n<h3 id=\"æ›´æ–°æ•°æ®\">æ›´æ–°æ•°æ®</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">UPDATE students\nSET age &#x3D; 20\nWHERE name &#x3D; &#39;å¼ ä¸‰&#39;;</code></pre></div></figure>\n<h3 id=\"åˆ é™¤æ•°æ®\">åˆ é™¤æ•°æ®</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">DELETE FROM students\nWHERE name &#x3D; &#39;ç‹äº”&#39;;</code></pre></div></figure>\n<h2 id=\"ğŸ”§-é«˜çº§æŸ¥è¯¢æŠ€å·§\">ğŸ”§ é«˜çº§æŸ¥è¯¢æŠ€å·§</h2>\n<h3 id=\"èšåˆå‡½æ•°\">èšåˆå‡½æ•°</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">SELECT\nCOUNT(*) AS total,\nAVG(age) AS avg_age,\nMIN(created_at) AS oldest,\nMAX(age) AS max_age\nFROM students;</code></pre></div></figure>\n<h3 id=\"åˆ†ç»„ç»Ÿè®¡\">åˆ†ç»„ç»Ÿè®¡</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">SELECT\nmajor,\nCOUNT(*) AS student_count,\nAVG(age) AS avg_age\nFROM students\nGROUP BY major\nHAVING COUNT(*) &gt; 5;</code></pre></div></figure>\n<h3 id=\"è¡¨è¿æ¥\">è¡¨è¿æ¥</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- åˆ›å»ºè¯¾ç¨‹è¡¨\nCREATE TABLE courses (\nid INT PRIMARY KEY AUTO_INCREMENT,\nname VARCHAR(50),\ninstructor VARCHAR(50)\n);\n\n-- å†…è¿æ¥æŸ¥è¯¢\nSELECT s.name, c.name AS course\nFROM students s\nJOIN courses c ON s.id &#x3D; c.student_id;</code></pre></div></figure>\n<h2 id=\"ğŸ‘¥-ç”¨æˆ·ä¸æƒé™ç®¡ç†\">ğŸ‘¥ ç”¨æˆ·ä¸æƒé™ç®¡ç†</h2>\n<h3 id=\"ç”¨æˆ·ç®¡ç†\">ç”¨æˆ·ç®¡ç†</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- åˆ›å»ºæ–°ç”¨æˆ·\nCREATE USER &#39;dev&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;password123&#39;;\n\n-- ä¿®æ”¹å¯†ç \nALTER USER &#39;dev&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;newpassword456&#39;;\n\n-- åˆ é™¤ç”¨æˆ·\nDROP USER &#39;dev&#39;@&#39;localhost&#39;;</code></pre></div></figure>\n<h3 id=\"æƒé™ç®¡ç†\">æƒé™ç®¡ç†</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- æˆäºˆæƒé™\nGRANT SELECT, INSERT, UPDATE ON school_db.* TO &#39;dev&#39;@&#39;localhost&#39;;\n\n-- æŸ¥çœ‹æƒé™\nSHOW GRANTS FOR &#39;dev&#39;@&#39;localhost&#39;;\n\n-- æ’¤é”€æƒé™\nREVOKE UPDATE ON school_db.* FROM &#39;dev&#39;@&#39;localhost&#39;;</code></pre></div></figure>\n<h2 id=\"ğŸ“¤-æ•°æ®å¯¼å…¥å¯¼å‡º\">ğŸ“¤ æ•°æ®å¯¼å…¥å¯¼å‡º</h2>\n<h3 id=\"å¯¼å‡ºæ•°æ®\">å¯¼å‡ºæ•°æ®</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-bash\" data-language=\"bash\" data-start=\"1\"><code class=\"language-bash\"># å¯¼å‡ºæ•´ä¸ªæ•°æ®åº“\nmysqldump -u root -p school_db &gt; school_db.sql\n\n# å¯¼å‡ºç‰¹å®šè¡¨\nmysqldump -u root -p school_db students &gt; students.sql\n\n# å¯¼å‡ºä¸ºCSVæ ¼å¼\nmysql -u root -p -e &quot;SELECT * FROM students&quot; school_db &gt; students.csv</code></pre></div></figure>\n<h3 id=\"å¯¼å…¥æ•°æ®\">å¯¼å…¥æ•°æ®</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-bash\" data-language=\"bash\" data-start=\"1\"><code class=\"language-bash\"># å¯¼å…¥SQLæ–‡ä»¶\nmysql -u root -p school_db &lt; backup.sql\n\n# å¯¼å…¥CSVæ•°æ®\nmysql -u root -p school_db -e &quot;\nLOAD DATA INFILE &#39;&#x2F;path&#x2F;to&#x2F;students.csv&#39;\nINTO TABLE students\nFIELDS TERMINATED BY &#39;,&#39;\nLINES TERMINATED BY &#39;\\n&#39;\nIGNORE 1 ROWS;&quot;</code></pre></div></figure>\n<h2 id=\"âš™ï¸-é…ç½®ä¸ä¼˜åŒ–\">âš™ï¸ é…ç½®ä¸ä¼˜åŒ–</h2>\n<h3 id=\"é…ç½®æ–‡ä»¶-my-cnf\">é…ç½®æ–‡ä»¶(my.cnf)</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-ini\" data-language=\"ini\" data-start=\"1\"><code class=\"language-ini\">[mysqld]\ndatadir&#x3D;&#x2F;var&#x2F;lib&#x2F;mysql\nsocket&#x3D;&#x2F;var&#x2F;lib&#x2F;mysql&#x2F;mysql.sock\nlog-error&#x3D;&#x2F;var&#x2F;log&#x2F;mysql&#x2F;error.log\npid-file&#x3D;&#x2F;var&#x2F;run&#x2F;mysql&#x2F;mysql.pid\n\n# æ€§èƒ½ä¼˜åŒ–\ninnodb_buffer_pool_size&#x3D;1G\nmax_connections&#x3D;200\nquery_cache_size&#x3D;128M</code></pre></div></figure>\n<h3 id=\"æ€§èƒ½åˆ†æ\">æ€§èƒ½åˆ†æ</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- æŸ¥çœ‹æŸ¥è¯¢æ‰§è¡Œè®¡åˆ’\nEXPLAIN SELECT * FROM students WHERE age &gt; 18;\n\n-- æŸ¥çœ‹è¿›ç¨‹åˆ—è¡¨\nSHOW PROCESSLIST;\n\n-- ä¼˜åŒ–è¡¨\nOPTIMIZE TABLE students;</code></pre></div></figure>\n<h2 id=\"ğŸš¨-å¸¸è§é—®é¢˜è§£å†³\">ğŸš¨ å¸¸è§é—®é¢˜è§£å†³</h2>\n<h3 id=\"å¿˜è®°rootå¯†ç \">å¿˜è®°rootå¯†ç </h3>\n<ol>\n<li>åœæ­¢MySQLæœåŠ¡</li>\n<li>å¯åŠ¨å®‰å…¨æ¨¡å¼ï¼š</li>\n</ol>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-bash\" data-language=\"bash\" data-start=\"1\"><code class=\"language-bash\">mysqld_safe --skip-grant-tables &amp;</code></pre></div></figure>\n<ol start=\"3\">\n<li>ç™»å½•å¹¶ä¿®æ”¹å¯†ç ï¼š</li>\n</ol>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">FLUSH PRIVILEGES;\nALTER USER &#39;root&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;newpassword&#39;;</code></pre></div></figure>\n<ol start=\"4\">\n<li>é‡å¯MySQLæœåŠ¡</li>\n</ol>\n<h3 id=\"è¿æ¥é”™è¯¯\">è¿æ¥é”™è¯¯</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-bash\" data-language=\"bash\" data-start=\"1\"><code class=\"language-bash\"># é”™è¯¯ï¼šERROR 1045 (28000)\n# è§£å†³æ–¹æ¡ˆï¼šæ£€æŸ¥ç”¨æˆ·å&#x2F;å¯†ç ï¼Œç¡®ä¿ä¸»æœºæƒé™\n\n# é”™è¯¯ï¼šERROR 2002 (HY000)\n# è§£å†³æ–¹æ¡ˆï¼šç¡®è®¤MySQLæœåŠ¡è¿è¡Œä¸­ï¼Œæ£€æŸ¥socketè·¯å¾„</code></pre></div></figure>\n<h3 id=\"å¤‡ä»½ä¸æ¢å¤\">å¤‡ä»½ä¸æ¢å¤</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-bash\" data-language=\"bash\" data-start=\"1\"><code class=\"language-bash\"># å®šæ—¶å¤‡ä»½è„šæœ¬\nmysqldump -u root -p --all-databases | gzip &gt; &#x2F;backups&#x2F;mysql-$(date +%F).sql.gz\n\n# æ¢å¤å¤‡ä»½\ngunzip &lt; &#x2F;backups&#x2F;mysql-2023-01-01.sql.gz | mysql -u root -p</code></pre></div></figure>\n<h2 id=\"ğŸ’¡-å®ç”¨æŠ€å·§\">ğŸ’¡ å®ç”¨æŠ€å·§</h2>\n<h3 id=\"æ‰¹å¤„ç†æ¨¡å¼\">æ‰¹å¤„ç†æ¨¡å¼</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-bash\" data-language=\"bash\" data-start=\"1\"><code class=\"language-bash\">mysql -u root -p -e &quot;SHOW DATABASES; SELECT VERSION();&quot;\n\n# æ‰§è¡ŒSQLè„šæœ¬\nmysql -u root -p &lt; script.sql</code></pre></div></figure>\n<h3 id=\"è¾“å‡ºæ ¼å¼åŒ–\">è¾“å‡ºæ ¼å¼åŒ–</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- å‚ç›´æ˜¾ç¤ºç»“æœ\nSELECT * FROM students \\G\n\n-- è¡¨æ ¼æ ¼å¼\nSELECT * FROM students \\T\n\n-- å¯¼å‡ºä¸ºHTML\nSELECT * FROM students --html</code></pre></div></figure>\n<h3 id=\"å‘½ä»¤å†å²\">å‘½ä»¤å†å²</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-bash\" data-language=\"bash\" data-start=\"1\"><code class=\"language-bash\"># æŸ¥çœ‹å†å²å‘½ä»¤\ncat ~&#x2F;.mysql_history\n\n# å®æ—¶ç›‘æ§æŸ¥è¯¢\nmysqladmin -u root -p processlist</code></pre></div></figure>\n<h2 id=\"ğŸ“š-å­¦ä¹ èµ„æºæ¨è\">ğŸ“š å­¦ä¹ èµ„æºæ¨è</h2>\n<ol>\n<li><a href=\"https://dev.mysql.com/doc/\">MySQLå®˜æ–¹æ–‡æ¡£</a></li>\n<li><a href=\"https://www.mysqltutorial.org/\">MySQL Tutorial</a></li>\n<li><a href=\"https://sqlzoo.net/wiki/SQL_Tutorial\">SQLZoo MySQLç»ƒä¹ </a></li>\n<li><a href=\"https://www.mysql.com/products/workbench/\">MySQL Workbenchå›¾å½¢å·¥å…·</a></li>\n</ol>\n<blockquote>\n<p>é€šè¿‡æŒæ¡è¿™äº›MySQLå‘½ä»¤å’ŒæŠ€å·§ï¼Œä½ å°†èƒ½å¤Ÿé«˜æ•ˆåœ°ç®¡ç†å’Œæ“ä½œæ•°æ®åº“ã€‚å®è·µæ˜¯æœ€å¥½çš„å­¦ä¹ æ–¹å¼ - ç«‹å³åˆ›å»ºä½ çš„ç¬¬ä¸€ä¸ªæ•°æ®åº“é¡¹ç›®å§ï¼</p>\n</blockquote>\n<h2 id=\"é™„å½•ï¼šå¸¸ç”¨å‘½ä»¤é€ŸæŸ¥è¡¨\">é™„å½•ï¼šå¸¸ç”¨å‘½ä»¤é€ŸæŸ¥è¡¨</h2>\n<table>\n<thead>\n<tr>\n<th>ç±»åˆ«</th>\n<th>å‘½ä»¤</th>\n<th>è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>è¿æ¥</strong></td>\n<td><code>mysql -u user -p</code></td>\n<td>è¿æ¥æ•°æ®åº“</td>\n</tr>\n<tr>\n<td><strong>æ•°æ®åº“</strong></td>\n<td><code>SHOW DATABASES;</code></td>\n<td>æ˜¾ç¤ºæ‰€æœ‰æ•°æ®åº“</td>\n</tr>\n<tr>\n<td></td>\n<td><code>CREATE DATABASE dbname;</code></td>\n<td>åˆ›å»ºæ•°æ®åº“</td>\n</tr>\n<tr>\n<td></td>\n<td><code>USE dbname;</code></td>\n<td>é€‰æ‹©æ•°æ®åº“</td>\n</tr>\n<tr>\n<td><strong>è¡¨æ“ä½œ</strong></td>\n<td><code>SHOW TABLES;</code></td>\n<td>æ˜¾ç¤ºæ‰€æœ‰è¡¨</td>\n</tr>\n<tr>\n<td></td>\n<td><code>DESCRIBE tablename;</code></td>\n<td>æŸ¥çœ‹è¡¨ç»“æ„</td>\n</tr>\n<tr>\n<td></td>\n<td><code>ALTER TABLE ...</code></td>\n<td>ä¿®æ”¹è¡¨ç»“æ„</td>\n</tr>\n<tr>\n<td><strong>æ•°æ®</strong></td>\n<td><code>SELECT ... FROM ...</code></td>\n<td>æŸ¥è¯¢æ•°æ®</td>\n</tr>\n<tr>\n<td></td>\n<td><code>INSERT INTO ... VALUES ...</code></td>\n<td>æ’å…¥æ•°æ®</td>\n</tr>\n<tr>\n<td></td>\n<td><code>UPDATE ... SET ... WHERE ...</code></td>\n<td>æ›´æ–°æ•°æ®</td>\n</tr>\n<tr>\n<td></td>\n<td><code>DELETE FROM ... WHERE ...</code></td>\n<td>åˆ é™¤æ•°æ®</td>\n</tr>\n<tr>\n<td><strong>ç”¨æˆ·</strong></td>\n<td><code>CREATE USER ...</code></td>\n<td>åˆ›å»ºç”¨æˆ·</td>\n</tr>\n<tr>\n<td></td>\n<td><code>GRANT ... ON ... TO ...</code></td>\n<td>æˆäºˆæƒé™</td>\n</tr>\n<tr>\n<td><strong>ç»´æŠ¤</strong></td>\n<td><code>SHOW PROCESSLIST;</code></td>\n<td>æŸ¥çœ‹æ´»åŠ¨è¿æ¥</td>\n</tr>\n<tr>\n<td></td>\n<td><code>EXPLAIN SELECT ...</code></td>\n<td>åˆ†ææŸ¥è¯¢æ€§èƒ½</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"å‚è€ƒ-è‡´è°¢\">å‚è€ƒ&amp;è‡´è°¢</h2>\n<h2 id=\"ç³»åˆ—æ•™ç¨‹\"><strong>ç³»åˆ—æ•™ç¨‹</strong></h2>\n<p><a href=\"/atom.xml\"><i class=\"fas fa-rss\"></i>å…¨éƒ¨æ–‡ç« RSSè®¢é˜…</a></p>\n\n<h3 id=\"æ•°æ®åº“ç³»åˆ—\"><strong>æ•°æ®åº“ç³»åˆ—</strong></h3>\n<ul>\n<li><a href=\"/posts/b2f7c564/\">SQLå‘½ä»¤ä½¿ç”¨æ•™ç¨‹ï¼šä»å…¥é—¨åˆ°ç²¾é€š</a></li>\n<li><a href=\"/posts/847851a6/\">SQLiteä½¿ç”¨å…¨é¢æ•™ç¨‹ï¼šè½»é‡çº§æ•°æ®åº“çš„ç»ˆææŒ‡å—</a></li>\n<li><a href=\"/posts/a460ae99/\">MySQLå‘½ä»¤è¡Œä½¿ç”¨å…¨é¢æ•™ç¨‹ï¼šä»å…¥é—¨åˆ°ç²¾é€š</a></li>\n<li><a href=\"/posts/622f0f0f/\">MySQL ä½¿ç”¨å…¨é¢æŒ‡å—ï¼šä»å…¥é—¨åˆ°é«˜çº§å®è·µ</a></li>\n<li><a href=\"/posts/16bffe88/\">PostgreSQL ä½¿ç”¨å…¨é¢æŒ‡å—ï¼šä»å…¥é—¨åˆ°ä¼ä¸šçº§åº”ç”¨</a></li>\n<li><a href=\"/posts/6c6f64dc/\">PostgreSQLå‘½ä»¤è¡Œä½¿ç”¨æ•™ç¨‹ï¼šæŒæ¡ psql å·¥å…·</a></li>\n<li><a href=\"/posts/a416ccaa/\">PostgreSQL å®ç°åŸç†æ·±åº¦å‰–æï¼šé«˜æ€§èƒ½æ•°æ®åº“å¼•æ“çš„æ ¸å¿ƒæœºåˆ¶</a></li>\n</ul>\n\n<link rel=\"stylesheet\" href=\"https://fastly.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/style.css\"><script src=\"https://fastly.jsdelivr.net/npm/d3@7\"></script><script src=\"https://fastly.jsdelivr.net/npm/markmap-view@0.18.10\"></script><script src=\"https://fastly.jsdelivr.net/npm/markmap-toolbar@0.18.10\"></script>\n<link rel=\"stylesheet\" href=\"/css/markmap.css\">\n\n<script src=\"/js/markmap.js\"></script>\n",
            "tags": [
                "web",
                "sql"
            ]
        },
        {
            "id": "https://blog.17lai.site/posts/6c6f64dc/",
            "url": "https://blog.17lai.site/posts/6c6f64dc/",
            "title": "PostgreSQLå‘½ä»¤è¡Œä½¿ç”¨æ•™ç¨‹ï¼šæŒæ¡ psql å·¥å…·",
            "date_published": "2025-11-22T07:17:17.000Z",
            "content_html": "<blockquote>\n<p>æŒæ¡PostgreSQLçš„å‘½ä»¤è¡Œå·¥å…·<code>psql</code>æ˜¯é«˜æ•ˆç®¡ç†æ•°æ®åº“çš„å…³é”®ã€‚æœ¬æ–‡å°†å¸¦ä½ å…¨é¢äº†è§£è¿™ä¸ªå¼ºå¤§çš„äº¤äº’å¼ç»ˆç«¯å·¥å…·çš„å„ç§ä½¿ç”¨æ–¹æ³•ï¼ŒåŒ…æ‹¬å„ç§å¸¸è§é—®é¢˜å’ŒæŠ€å·§æ€»ç»“ã€‚</p>\n</blockquote>\n<span id=\"more\"></span>\n<h2 id=\"ğŸš€-å¯åŠ¨psql\">ğŸš€ å¯åŠ¨psql</h2>\n<h3 id=\"åŸºæœ¬è¿æ¥æ–¹å¼\">åŸºæœ¬è¿æ¥æ–¹å¼</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-bash\" data-language=\"bash\" data-start=\"1\"><code class=\"language-bash\"># è¿æ¥åˆ°æœ¬åœ°é»˜è®¤æ•°æ®åº“\npsql\n\n# æŒ‡å®šç”¨æˆ·åå’Œæ•°æ®åº“\npsql -U username -d dbname\n\n# æŒ‡å®šä¸»æœºå’Œç«¯å£\npsql -h localhost -p 5432 -U postgres -d mydb</code></pre></div></figure>\n<h3 id=\"è¿æ¥å‚æ•°è¯´æ˜\">è¿æ¥å‚æ•°è¯´æ˜</h3>\n<table>\n<thead>\n<tr>\n<th>å‚æ•°</th>\n<th>è¯´æ˜</th>\n<th>ç¤ºä¾‹</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>-U</code></td>\n<td>ç”¨æˆ·å</td>\n<td><code>-U admin</code></td>\n</tr>\n<tr>\n<td><code>-d</code></td>\n<td>æ•°æ®åº“å</td>\n<td><code>-d sales_db</code></td>\n</tr>\n<tr>\n<td><code>-h</code></td>\n<td>ä¸»æœºåœ°å€</td>\n<td><code>-h db.example.com</code></td>\n</tr>\n<tr>\n<td><code>-p</code></td>\n<td>ç«¯å£å·</td>\n<td><code>-p 6432</code></td>\n</tr>\n<tr>\n<td><code>-W</code></td>\n<td>å¼ºåˆ¶å¯†ç æç¤º</td>\n<td></td>\n</tr>\n<tr>\n<td><code>-f</code></td>\n<td>æ‰§è¡ŒSQLæ–‡ä»¶</td>\n<td><code>-f setup.sql</code></td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"ğŸ”-å¸¸ç”¨å…ƒå‘½ä»¤ï¼ˆä»¥-å¼€å¤´ï¼‰\">ğŸ” å¸¸ç”¨å…ƒå‘½ä»¤ï¼ˆä»¥<code>\\</code>å¼€å¤´ï¼‰</h2>\n<h3 id=\"æ•°æ®åº“æ“ä½œ\">æ•°æ®åº“æ“ä½œ</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- åˆ—å‡ºæ‰€æœ‰æ•°æ®åº“\n\\l\n\n-- åˆ‡æ¢æ•°æ®åº“\n\\c dbname\n\n-- åˆ›å»ºæ–°æ•°æ®åº“\nCREATE DATABASE newdb;\n\n-- åˆ é™¤æ•°æ®åº“\nDROP DATABASE olddb;</code></pre></div></figure>\n<h3 id=\"è¡¨æ“ä½œ\">è¡¨æ“ä½œ</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- åˆ—å‡ºå½“å‰æ•°æ®åº“æ‰€æœ‰è¡¨\n\\dt\n\n-- æŸ¥çœ‹è¡¨ç»“æ„\n\\d users\n\n-- æ˜¾ç¤ºè¡¨è¯¦ç»†ä¿¡æ¯\n\\d+ orders\n\n-- æ˜¾ç¤ºè¡¨ã€è§†å›¾å’Œåºåˆ—\n\\dv</code></pre></div></figure>\n<h3 id=\"ç”¨æˆ·å’Œæƒé™ç®¡ç†\">ç”¨æˆ·å’Œæƒé™ç®¡ç†</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- åˆ—å‡ºæ‰€æœ‰ç”¨æˆ·\n\\du\n\n-- åˆ›å»ºæ–°ç”¨æˆ·\nCREATE USER dev WITH PASSWORD &#39;secret123&#39;;\n\n-- ä¿®æ”¹å¯†ç \nALTER USER dev WITH PASSWORD &#39;newsecret456&#39;;\n\n-- æˆäºˆæƒé™\nGRANT SELECT, INSERT ON customers TO dev;</code></pre></div></figure>\n<h3 id=\"ä¿¡æ¯æŸ¥è¯¢\">ä¿¡æ¯æŸ¥è¯¢</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- æ˜¾ç¤ºå½“å‰è¿æ¥ä¿¡æ¯\n\\conninfo\n\n-- æ˜¾ç¤ºSQLç‰ˆæœ¬\nSELECT version();\n\n-- æ˜¾ç¤ºå½“å‰æ—¶é—´\nSELECT NOW();\n\n-- æ˜¾ç¤ºå½“å‰æ•°æ®åº“\nSELECT current_database();</code></pre></div></figure>\n<h3 id=\"æ–‡ä»¶æ“ä½œ\">æ–‡ä»¶æ“ä½œ</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- æ‰§è¡ŒSQLæ–‡ä»¶\n\\i path&#x2F;to&#x2F;script.sql\n\n-- å°†æŸ¥è¯¢ç»“æœè¾“å‡ºåˆ°æ–‡ä»¶\n\\o output.txt\nSELECT * FROM products;\n\\o</code></pre></div></figure>\n<h3 id=\"å¸®åŠ©ç³»ç»Ÿ\">å¸®åŠ©ç³»ç»Ÿ</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- æ˜¾ç¤ºæ‰€æœ‰å…ƒå‘½ä»¤å¸®åŠ©\n\\?\n\n-- æ˜¾ç¤ºSQLå‘½ä»¤å¸®åŠ©\n\\h\n\n-- æŸ¥çœ‹ç‰¹å®šå‘½ä»¤å¸®åŠ©\n\\h CREATE TABLE</code></pre></div></figure>\n<h2 id=\"ğŸ“Š-æŸ¥è¯¢ä¸ç¼–è¾‘\">ğŸ“Š æŸ¥è¯¢ä¸ç¼–è¾‘</h2>\n<h3 id=\"åŸºæœ¬æŸ¥è¯¢\">åŸºæœ¬æŸ¥è¯¢</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- ç®€å•æŸ¥è¯¢\nSELECT * FROM employees;\n\n-- æ¡ä»¶æŸ¥è¯¢\nSELECT name, salary FROM employees WHERE salary &gt; 50000;\n\n-- æ’åº\nSELECT * FROM orders ORDER BY order_date DESC;\n\n-- é™åˆ¶ç»“æœ\nSELECT * FROM products LIMIT 10;</code></pre></div></figure>\n<h3 id=\"å¤šè¡Œç¼–è¾‘\">å¤šè¡Œç¼–è¾‘</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- å¼€å¯å¤šè¡Œæ¨¡å¼\n\\set PROMPT1 &#39;%&#x2F;%R%# &#39;\n\n-- è¾“å…¥å¤šè¡ŒSQLè¯­å¥\nSELECT\nfirst_name,\nlast_name,\ndepartment\nFROM employees\nWHERE hire_date &gt; &#39;2020-01-01&#39;;\n\n-- ç»“æŸå¤šè¡Œè¾“å…¥ï¼ˆåˆ†å·åå›è½¦ï¼‰\n;</code></pre></div></figure>\n<h3 id=\"æŸ¥è¯¢å†å²\">æŸ¥è¯¢å†å²</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- æŸ¥çœ‹å†å²å‘½ä»¤\n\\s\n\n-- ä¿å­˜å†å²åˆ°æ–‡ä»¶\n\\s history.sql\n\n-- æ‰§è¡Œå†å²å‘½ä»¤ï¼ˆ!åè·Ÿè¡Œå·ï¼‰\n\\! 15</code></pre></div></figure>\n<h2 id=\"ğŸ”„-å¯¼å…¥å¯¼å‡ºæ•°æ®\">ğŸ”„ å¯¼å…¥å¯¼å‡ºæ•°æ®</h2>\n<h3 id=\"å¯¼å‡ºæ•°æ®\">å¯¼å‡ºæ•°æ®</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-bash\" data-language=\"bash\" data-start=\"1\"><code class=\"language-bash\"># å¯¼å‡ºæ•´ä¸ªæ•°æ®åº“\npg_dump dbname &gt; dbname.sql\n\n# å¯¼å‡ºç‰¹å®šè¡¨\npg_dump -t tablename dbname &gt; table.sql\n\n# å¯¼å‡ºä¸ºCSVæ ¼å¼\n\\copy (SELECT * FROM users) TO &#39;&#x2F;path&#x2F;to&#x2F;users.csv&#39; CSV HEADER</code></pre></div></figure>\n<h3 id=\"å¯¼å…¥æ•°æ®\">å¯¼å…¥æ•°æ®</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-bash\" data-language=\"bash\" data-start=\"1\"><code class=\"language-bash\"># å¯¼å…¥SQLæ–‡ä»¶\npsql -d dbname -f backup.sql\n\n# å¯¼å…¥CSVæ–‡ä»¶\n\\copy users FROM &#39;&#x2F;path&#x2F;to&#x2F;users.csv&#39; CSV HEADER\n\n# ä½¿ç”¨COPYå‘½ä»¤ï¼ˆéœ€è¦è¶…çº§ç”¨æˆ·æƒé™ï¼‰\nCOPY employees FROM &#39;&#x2F;path&#x2F;to&#x2F;employees.csv&#39; DELIMITER &#39;,&#39; CSV HEADER;</code></pre></div></figure>\n<h2 id=\"âš™ï¸-é…ç½®ä¸å®šåˆ¶\">âš™ï¸ é…ç½®ä¸å®šåˆ¶</h2>\n<h3 id=\"é…ç½®æ–‡ä»¶ï¼ˆ-psqlrcï¼‰\">é…ç½®æ–‡ä»¶ï¼ˆ.psqlrcï¼‰</h3>\n<p>åœ¨ç”¨æˆ·ä¸»ç›®å½•åˆ›å»º<code>.psqlrc</code>æ–‡ä»¶ï¼š</p>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- è®¾ç½®æ—¶é—´æ ¼å¼\n\\set HISTFILE ~&#x2F;.psql_history- :DBNAME\n\\set HISTSIZE 1000\n\n-- è‡ªå®šä¹‰æç¤ºç¬¦\n\\set PROMPT1 &#39;%[%033[1;33m%]%&#x2F;%R%#%[%033[0m%] &#39;\n\n-- è‡ªåŠ¨æäº¤\n\\set AUTOCOMMIT on\n\n-- å¸¸ç”¨åˆ«å\n\\set QUIET on\n\\echo &#39;å¸¸ç”¨åˆ«å:&#39;\n\\echo &#39;e: \\\\dt&#39;\n\\echo &#39;s: SELECT * FROM&#39;\n\\set QUIET off</code></pre></div></figure>\n<h3 id=\"å¸¸ç”¨é…ç½®é€‰é¡¹\">å¸¸ç”¨é…ç½®é€‰é¡¹</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- æ˜¾ç¤ºæŸ¥è¯¢æ‰§è¡Œæ—¶é—´\n\\timing\n\n-- æ‰©å±•æ˜¾ç¤ºæ¨¡å¼\n\\x auto\n\n-- è®¾ç½®ç©ºå€¼æ˜¾ç¤º\n\\pset null &#39;[NULL]&#39;\n\n-- è®¾ç½®è¾¹æ¡†æ ·å¼\n\\pset border 2</code></pre></div></figure>\n<h2 id=\"ğŸ› ï¸-é«˜çº§æŠ€å·§\">ğŸ› ï¸ é«˜çº§æŠ€å·§</h2>\n<h3 id=\"äº‹åŠ¡ç®¡ç†\">äº‹åŠ¡ç®¡ç†</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- å¼€å§‹äº‹åŠ¡\nBEGIN;\n\n-- æ‰§è¡Œå¤šä¸ªæ“ä½œ\nUPDATE accounts SET balance &#x3D; balance - 100 WHERE id &#x3D; 1;\nUPDATE accounts SET balance &#x3D; balance + 100 WHERE id &#x3D; 2;\n\n-- æäº¤æˆ–å›æ»š\nCOMMIT;\n-- ROLLBACK;</code></pre></div></figure>\n<h3 id=\"æ€§èƒ½åˆ†æ\">æ€§èƒ½åˆ†æ</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- æŸ¥çœ‹æŸ¥è¯¢è®¡åˆ’\nEXPLAIN SELECT * FROM large_table WHERE condition &#x3D; &#39;value&#39;;\n\n-- è¯¦ç»†åˆ†æï¼ˆå®é™…æ‰§è¡Œï¼‰\nEXPLAIN ANALYZE SELECT * FROM large_table;\n\n-- ç´¢å¼•ä½¿ç”¨æƒ…å†µ\nSELECT * FROM pg_stat_user_indexes;</code></pre></div></figure>\n<h3 id=\"ç»´æŠ¤æ“ä½œ\">ç»´æŠ¤æ“ä½œ</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- é‡å»ºç´¢å¼•\nREINDEX TABLE large_table;\n\n-- æ¸…ç†è¡¨ç©ºé—´\nVACUUM FULL ANALYZE;\n\n-- æ”¶é›†ç»Ÿè®¡ä¿¡æ¯\nANALYZE VERBOSE;</code></pre></div></figure>\n<h2 id=\"ğŸš¨-å¸¸è§é—®é¢˜è§£å†³\">ğŸš¨ å¸¸è§é—®é¢˜è§£å†³</h2>\n<h3 id=\"è¿æ¥é—®é¢˜\">è¿æ¥é—®é¢˜</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-bash\" data-language=\"bash\" data-start=\"1\"><code class=\"language-bash\"># è®¤è¯å¤±è´¥\npsql: FATAL: password authentication failed for user &quot;user&quot;\n\n# è§£å†³æ–¹æ¡ˆï¼š\n# 1. æ£€æŸ¥pg_hba.confé…ç½®\n# 2. é‡ç½®å¯†ç ï¼šALTER USER user WITH PASSWORD &#39;newpassword&#39;;</code></pre></div></figure>\n<h3 id=\"æƒé™é—®é¢˜\">æƒé™é—®é¢˜</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- æƒé™æ‹’ç»\nERROR: permission denied for table tablename\n\n# è§£å†³æ–¹æ¡ˆï¼š\nGRANT SELECT, INSERT ON tablename TO username;</code></pre></div></figure>\n<h3 id=\"ç‰¹æ®Šå­—ç¬¦å¤„ç†\">ç‰¹æ®Šå­—ç¬¦å¤„ç†</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- åŒ…å«å¼•å·çš„å­—ç¬¦ä¸²\nSELECT * FROM comments WHERE text E&#39;contains \\&#39;quote\\&#39;&#39;;\n\n-- ä½¿ç”¨$tag$è¯­æ³•\nDO $$\nBEGIN\nINSERT INTO logs (message) VALUES (&#39;This contains &#39;&#39;quotes&#39;&#39;&#39;);\nEND $$;</code></pre></div></figure>\n<h2 id=\"ğŸ’¡-å®ç”¨æŠ€å·§æ€»ç»“\">ğŸ’¡ å®ç”¨æŠ€å·§æ€»ç»“</h2>\n<ol>\n<li><strong>å†å²å‘½ä»¤</strong>ï¼šä½¿ç”¨ä¸Šä¸‹ç®­å¤´é”®æµè§ˆå†å²å‘½ä»¤</li>\n<li><strong>è‡ªåŠ¨è¡¥å…¨</strong>ï¼šTabé”®è¡¥å…¨å¯¹è±¡åï¼ˆè¡¨åã€åˆ—åç­‰ï¼‰</li>\n<li><strong>å˜é‡è®¾ç½®</strong>ï¼šä½¿ç”¨<code>:variable</code>å­˜å‚¨å’Œé‡ç”¨å€¼</li>\n</ol>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">\\set id 100\nSELECT * FROM users WHERE id &#x3D; :id;</code></pre></div></figure>\n<ol start=\"4\">\n<li><strong>å¿«é€Ÿç¼–è¾‘</strong>ï¼šä½¿ç”¨<code>\\e</code>æ‰“å¼€ç¼–è¾‘å™¨ç¼–è¾‘å½“å‰æŸ¥è¯¢</li>\n<li><strong>æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</strong>ï¼š<code>\\!</code>åè·Ÿç³»ç»Ÿå‘½ä»¤</li>\n</ol>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">\\! ls -l &#x2F;backups</code></pre></div></figure>\n<h2 id=\"ğŸ“š-å­¦ä¹ èµ„æº\">ğŸ“š å­¦ä¹ èµ„æº</h2>\n<ol>\n<li><a href=\"https://www.postgresql.org/docs/current/app-psql.html\">PostgreSQLå®˜æ–¹æ–‡æ¡£</a></li>\n<li><a href=\"https://www.postgresqltutorial.com/psql-commands/\">psqlå‘½ä»¤è¡Œå¤‡å¿˜å•</a></li>\n<li><a href=\"https://www.pgadmin.org/\">pgAdmin - PostgreSQLå›¾å½¢åŒ–ç®¡ç†å·¥å…·</a></li>\n</ol>\n<p>é€šè¿‡æŒæ¡è¿™äº›<code>psql</code>å‘½ä»¤å’ŒæŠ€å·§ï¼Œä½ å°†èƒ½å¤Ÿé«˜æ•ˆåœ°ç®¡ç†å’Œæ“ä½œPostgreSQLæ•°æ®åº“ã€‚ä¸æ–­ç»ƒä¹ å’Œå®è·µæ˜¯æˆä¸ºæ•°æ®åº“ç®¡ç†ä¸“å®¶çš„å…³é”®ï¼</p>\n<h2 id=\"å‚è€ƒ-è‡´è°¢\">å‚è€ƒ&amp;è‡´è°¢</h2>\n<link rel=\"stylesheet\" href=\"https://fastly.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/style.css\"><script src=\"https://fastly.jsdelivr.net/npm/d3@7\"></script><script src=\"https://fastly.jsdelivr.net/npm/markmap-view@0.18.10\"></script><script src=\"https://fastly.jsdelivr.net/npm/markmap-toolbar@0.18.10\"></script>\n<link rel=\"stylesheet\" href=\"/css/markmap.css\">\n\n<script src=\"/js/markmap.js\"></script>\n",
            "tags": [
                "sql",
                "postgresql"
            ]
        },
        {
            "id": "https://blog.17lai.site/posts/b2f7c564/",
            "url": "https://blog.17lai.site/posts/b2f7c564/",
            "title": "SQLå‘½ä»¤ä½¿ç”¨æ•™ç¨‹ï¼šä»å…¥é—¨åˆ°ç²¾é€š",
            "date_published": "2025-11-22T07:14:19.000Z",
            "content_html": "<blockquote>\n<p>ä½œä¸ºä¸€ä¸ªç¨‹åºå‘˜ï¼Œä¸æŒæ¡SQLæ€ä¹ˆè¡Œï¼ŸæŒæ¡SQLæ˜¯æ•°æ®ç®¡ç†å’Œåˆ†æçš„å¿…å¤‡æŠ€èƒ½ï¼Œæœ¬æ•™ç¨‹å°†å¸¦ä½ ç³»ç»Ÿå­¦ä¹ SQLçš„æ ¸å¿ƒå‘½ä»¤å’Œå®ç”¨æŠ€å·§ï¼Œä»å…¥é—¨åˆ°ç²¾é€šã€‚</p>\n</blockquote>\n<p><img src=\"https://cimg1.17lai.site/data/2025/11/22/20251122172229.webp\" alt=\"\"></p>\n<span id=\"more\"></span>\n<h2 id=\"ä»€ä¹ˆæ˜¯SQLï¼Ÿ\">ä»€ä¹ˆæ˜¯SQLï¼Ÿ</h2>\n<p>SQLï¼ˆStructured Query Languageï¼‰æ˜¯ç”¨äºç®¡ç†å’Œæ“ä½œå…³ç³»å‹æ•°æ®åº“çš„æ ‡å‡†è¯­è¨€ã€‚é€šè¿‡SQLï¼Œä½ å¯ä»¥ï¼š</p>\n<ul>\n<li>åˆ›å»ºå’Œç®¡ç†æ•°æ®åº“å’Œè¡¨</li>\n<li>æ’å…¥ã€æ›´æ–°å’Œåˆ é™¤æ•°æ®</li>\n<li>æŸ¥è¯¢å’Œåˆ†ææ•°æ®</li>\n<li>è®¾ç½®è®¿é—®æƒé™</li>\n<li>ç®¡ç†äº‹åŠ¡</li>\n</ul>\n<p>SQLä¸»è¦åˆ†ä¸ºå››ç±»å‘½ä»¤ï¼š</p>\n<ol>\n<li><strong>DDL</strong>ï¼ˆæ•°æ®å®šä¹‰è¯­è¨€ï¼‰ - åˆ›å»º/ä¿®æ”¹æ•°æ®åº“ç»“æ„</li>\n<li><strong>DML</strong>ï¼ˆæ•°æ®æ“ä½œè¯­è¨€ï¼‰ - æ“ä½œæ•°æ®</li>\n<li><strong>DQL</strong>ï¼ˆæ•°æ®æŸ¥è¯¢è¯­è¨€ï¼‰ - æŸ¥è¯¢æ•°æ®</li>\n<li><strong>DCL</strong>ï¼ˆæ•°æ®æ§åˆ¶è¯­è¨€ï¼‰ - æ§åˆ¶è®¿é—®æƒé™</li>\n</ol>\n<h2 id=\"ä¸€ã€æ•°æ®åº“æ“ä½œ\">ä¸€ã€æ•°æ®åº“æ“ä½œ</h2>\n<h3 id=\"åˆ›å»ºæ•°æ®åº“\">åˆ›å»ºæ•°æ®åº“</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">CREATE DATABASE school_db;</code></pre></div></figure>\n<h3 id=\"æŸ¥çœ‹æ‰€æœ‰æ•°æ®åº“\">æŸ¥çœ‹æ‰€æœ‰æ•°æ®åº“</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">SHOW DATABASES;</code></pre></div></figure>\n<h3 id=\"é€‰æ‹©æ•°æ®åº“\">é€‰æ‹©æ•°æ®åº“</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">USE school_db;</code></pre></div></figure>\n<h3 id=\"åˆ é™¤æ•°æ®åº“\">åˆ é™¤æ•°æ®åº“</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">DROP DATABASE school_db;</code></pre></div></figure>\n<h2 id=\"äºŒã€è¡¨æ“ä½œ\">äºŒã€è¡¨æ“ä½œ</h2>\n<h3 id=\"åˆ›å»ºè¡¨\">åˆ›å»ºè¡¨</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">CREATE TABLE students (\nid INT PRIMARY KEY AUTO_INCREMENT,\nname VARCHAR(50) NOT NULL,\nage INT CHECK (age &gt;&#x3D; 15),\nemail VARCHAR(100) UNIQUE,\nenrollment_date DATE DEFAULT CURRENT_DATE\n);</code></pre></div></figure>\n<h3 id=\"æŸ¥çœ‹è¡¨ç»“æ„\">æŸ¥çœ‹è¡¨ç»“æ„</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">DESCRIBE students;</code></pre></div></figure>\n<h3 id=\"ä¿®æ”¹è¡¨ç»“æ„\">ä¿®æ”¹è¡¨ç»“æ„</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- æ·»åŠ æ–°åˆ—\nALTER TABLE students ADD COLUMN major VARCHAR(50);\n\n-- ä¿®æ”¹åˆ—ç±»å‹\nALTER TABLE students MODIFY COLUMN age SMALLINT;\n\n-- åˆ é™¤åˆ—\nALTER TABLE students DROP COLUMN email;</code></pre></div></figure>\n<h3 id=\"åˆ é™¤è¡¨\">åˆ é™¤è¡¨</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">DROP TABLE students;</code></pre></div></figure>\n<h2 id=\"ä¸‰ã€æ•°æ®æ“ä½œï¼ˆCRUDï¼‰\">ä¸‰ã€æ•°æ®æ“ä½œï¼ˆCRUDï¼‰</h2>\n<h3 id=\"æ’å…¥æ•°æ®\">æ’å…¥æ•°æ®</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">INSERT INTO students (name, age, enrollment_date)\nVALUES\n(&#39;å¼ ä¸‰&#39;, 18, &#39;2023-09-01&#39;),\n(&#39;æå››&#39;, 19, &#39;2023-08-25&#39;),\n(&#39;ç‹äº”&#39;, 17, &#39;2023-09-05&#39;);</code></pre></div></figure>\n<h3 id=\"æŸ¥è¯¢æ•°æ®\">æŸ¥è¯¢æ•°æ®</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- æŸ¥è¯¢æ‰€æœ‰åˆ—\nSELECT * FROM students;\n\n-- æŸ¥è¯¢ç‰¹å®šåˆ—\nSELECT name, age FROM students;\n\n-- å¸¦æ¡ä»¶æŸ¥è¯¢\nSELECT * FROM students WHERE age &gt; 18;</code></pre></div></figure>\n<h3 id=\"æ›´æ–°æ•°æ®\">æ›´æ–°æ•°æ®</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">UPDATE students\nSET age &#x3D; 20\nWHERE name &#x3D; &#39;å¼ ä¸‰&#39;;</code></pre></div></figure>\n<h3 id=\"åˆ é™¤æ•°æ®\">åˆ é™¤æ•°æ®</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">DELETE FROM students\nWHERE name &#x3D; &#39;ç‹äº”&#39;;</code></pre></div></figure>\n<h2 id=\"å››ã€é«˜çº§æŸ¥è¯¢æŠ€å·§\">å››ã€é«˜çº§æŸ¥è¯¢æŠ€å·§</h2>\n<h3 id=\"æ’åºç»“æœ\">æ’åºç»“æœ</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">SELECT * FROM students\nORDER BY age DESC, name ASC;</code></pre></div></figure>\n<h3 id=\"é™åˆ¶ç»“æœæ•°é‡\">é™åˆ¶ç»“æœæ•°é‡</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">SELECT * FROM students\nORDER BY enrollment_date DESC\nLIMIT 5;</code></pre></div></figure>\n<h3 id=\"æ¨¡ç³ŠæŸ¥è¯¢\">æ¨¡ç³ŠæŸ¥è¯¢</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">SELECT * FROM students\nWHERE name LIKE &#39;å¼ %&#39;;</code></pre></div></figure>\n<h3 id=\"èšåˆå‡½æ•°\">èšåˆå‡½æ•°</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">SELECT\nCOUNT(*) AS total_students,\nAVG(age) AS average_age,\nMIN(enrollment_date) AS earliest_enrollment,\nMAX(age) AS max_age\nFROM students;</code></pre></div></figure>\n<h3 id=\"åˆ†ç»„ç»Ÿè®¡\">åˆ†ç»„ç»Ÿè®¡</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">SELECT\nmajor,\nCOUNT(*) AS student_count,\nAVG(age) AS avg_age\nFROM students\nGROUP BY major\nHAVING COUNT(*) &gt; 5;</code></pre></div></figure>\n<h2 id=\"äº”ã€è¡¨è¿æ¥\">äº”ã€è¡¨è¿æ¥</h2>\n<h3 id=\"åˆ›å»ºè¯¾ç¨‹è¡¨\">åˆ›å»ºè¯¾ç¨‹è¡¨</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">CREATE TABLE courses (\ncourse_id INT PRIMARY KEY AUTO_INCREMENT,\ncourse_name VARCHAR(50),\ninstructor VARCHAR(50)\n);\n\nCREATE TABLE enrollments (\nstudent_id INT,\ncourse_id INT,\nenrollment_date DATE,\nFOREIGN KEY (student_id) REFERENCES students(id),\nFOREIGN KEY (course_id) REFERENCES courses(course_id)\n);</code></pre></div></figure>\n<h3 id=\"å†…è¿æ¥\">å†…è¿æ¥</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">SELECT s.name, c.course_name\nFROM students s\nINNER JOIN enrollments e ON s.id &#x3D; e.student_id\nINNER JOIN courses c ON e.course_id &#x3D; c.course_id;</code></pre></div></figure>\n<h3 id=\"å·¦è¿æ¥\">å·¦è¿æ¥</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">SELECT s.name, c.course_name\nFROM students s\nLEFT JOIN enrollments e ON s.id &#x3D; e.student_id\nLEFT JOIN courses c ON e.course_id &#x3D; c.course_id;</code></pre></div></figure>\n<h2 id=\"å…­ã€å­æŸ¥è¯¢\">å…­ã€å­æŸ¥è¯¢</h2>\n<h3 id=\"å•è¡Œå­æŸ¥è¯¢\">å•è¡Œå­æŸ¥è¯¢</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">SELECT * FROM students\nWHERE age &gt; (SELECT AVG(age) FROM students);</code></pre></div></figure>\n<h3 id=\"å¤šè¡Œå­æŸ¥è¯¢\">å¤šè¡Œå­æŸ¥è¯¢</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">SELECT * FROM courses\nWHERE course_id IN (\nSELECT course_id FROM enrollments\nGROUP BY course_id\nHAVING COUNT(*) &gt; 30\n);</code></pre></div></figure>\n<h2 id=\"ä¸ƒã€ç´¢å¼•ä¼˜åŒ–\">ä¸ƒã€ç´¢å¼•ä¼˜åŒ–</h2>\n<h3 id=\"åˆ›å»ºç´¢å¼•\">åˆ›å»ºç´¢å¼•</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- å•åˆ—ç´¢å¼•\nCREATE INDEX idx_student_name ON students(name);\n\n-- å¤åˆç´¢å¼•\nCREATE INDEX idx_student_age_name ON students(age, name);\n\n-- å”¯ä¸€ç´¢å¼•\nCREATE UNIQUE INDEX idx_unique_email ON students(email);</code></pre></div></figure>\n<h3 id=\"æŸ¥çœ‹ç´¢å¼•\">æŸ¥çœ‹ç´¢å¼•</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">SHOW INDEX FROM students;</code></pre></div></figure>\n<h3 id=\"åˆ é™¤ç´¢å¼•\">åˆ é™¤ç´¢å¼•</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">DROP INDEX idx_student_name ON students;</code></pre></div></figure>\n<h2 id=\"å…«ã€è§†å›¾\">å…«ã€è§†å›¾</h2>\n<h3 id=\"åˆ›å»ºè§†å›¾\">åˆ›å»ºè§†å›¾</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">CREATE VIEW student_summary AS\nSELECT\ns.id,\ns.name,\nCOUNT(e.course_id) AS courses_enrolled\nFROM students s\nLEFT JOIN enrollments e ON s.id &#x3D; e.student_id\nGROUP BY s.id, s.name;</code></pre></div></figure>\n<h3 id=\"ä½¿ç”¨è§†å›¾\">ä½¿ç”¨è§†å›¾</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">SELECT * FROM student_summary\nWHERE courses_enrolled &gt; 3;</code></pre></div></figure>\n<h3 id=\"åˆ é™¤è§†å›¾\">åˆ é™¤è§†å›¾</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">DROP VIEW student_summary;</code></pre></div></figure>\n<h2 id=\"ä¹ã€äº‹åŠ¡ç®¡ç†\">ä¹ã€äº‹åŠ¡ç®¡ç†</h2>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">START TRANSACTION;\n\n-- ä¸€ç³»åˆ—æ“ä½œ\nUPDATE accounts SET balance &#x3D; balance - 100 WHERE id &#x3D; 1;\nUPDATE accounts SET balance &#x3D; balance + 100 WHERE id &#x3D; 2;\n\n-- æäº¤äº‹åŠ¡\nCOMMIT;\n\n-- æˆ–å›æ»šäº‹åŠ¡\n-- ROLLBACK;</code></pre></div></figure>\n<h2 id=\"åã€æœ€ä½³å®è·µ\">åã€æœ€ä½³å®è·µ</h2>\n<ol>\n<li><strong>å‘½åè§„èŒƒ</strong>ï¼šä½¿ç”¨æœ‰æ„ä¹‰çš„è¡¨åå’Œåˆ—åï¼ˆå¦‚<code>student_id</code>è€Œé<code>sid</code>ï¼‰</li>\n<li>**é¿å…SELECT ***ï¼šåªé€‰æ‹©éœ€è¦çš„åˆ—</li>\n<li><strong>ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢</strong>ï¼šé˜²æ­¢SQLæ³¨å…¥æ”»å‡»</li>\n<li><strong>ç´¢å¼•ä¼˜åŒ–</strong>ï¼šä¸ºç»å¸¸æŸ¥è¯¢çš„åˆ—åˆ›å»ºç´¢å¼•</li>\n<li><strong>å®šæœŸå¤‡ä»½</strong>ï¼šä½¿ç”¨<code>mysqldump</code>æˆ–ç±»ä¼¼å·¥å…·</li>\n</ol>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-bash\" data-language=\"bash\" data-start=\"1\"><code class=\"language-bash\">mysqldump -u username -p database_name &gt; backup.sql</code></pre></div></figure>\n<h2 id=\"å¸¸è§é”™è¯¯å¤„ç†\">å¸¸è§é”™è¯¯å¤„ç†</h2>\n<h3 id=\"æƒé™é—®é¢˜\">æƒé™é—®é¢˜</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- æˆäºˆæƒé™\nGRANT SELECT, INSERT ON school_db.* TO &#39;user&#39;@&#39;localhost&#39;;\n\n-- æ’¤é”€æƒé™\nREVOKE INSERT ON school_db.* FROM &#39;user&#39;@&#39;localhost&#39;;</code></pre></div></figure>\n<h3 id=\"ä¿ç•™å…³é”®å­—å†²çª\">ä¿ç•™å…³é”®å­—å†²çª</h3>\n<figure><div class=\"code-area\"><pre class=\"line-numbers language-sql\" data-language=\"sql\" data-start=\"1\"><code class=\"language-sql\">-- ä½¿ç”¨åå¼•å·åŒ…è£¹å…³é”®å­—\nCREATE TABLE &#96;user&#96; (\n&#96;id&#96; INT PRIMARY KEY,\n&#96;name&#96; VARCHAR(50)\n);</code></pre></div></figure>\n<h2 id=\"å­¦ä¹ èµ„æºæ¨è\">å­¦ä¹ èµ„æºæ¨è</h2>\n<ol>\n<li><a href=\"https://sqlzoo.net/\">SQLZoo</a> - äº¤äº’å¼SQLå­¦ä¹ å¹³å°</li>\n<li><a href=\"https://www.w3schools.com/sql/\">W3Schools SQLæ•™ç¨‹</a> - åŸºç¡€åˆ°è¿›é˜¶æ•™ç¨‹</li>\n<li><a href=\"http://sqlfiddle.com/\">SQL Fiddle</a> - åœ¨çº¿SQLæµ‹è¯•ç¯å¢ƒ</li>\n<li><a href=\"https://leetcode.com/problemset/database/\">LeetCodeæ•°æ®åº“é¢˜åº“</a> - å®æˆ˜ç»ƒä¹ é¢˜</li>\n</ol>\n<blockquote>\n<p>é€šè¿‡æœ¬æ•™ç¨‹ï¼Œä½ å·²ç»æŒæ¡äº†SQLçš„æ ¸å¿ƒæ¦‚å¿µå’Œå¸¸ç”¨å‘½ä»¤ã€‚æŒç»­ç»ƒä¹ æ˜¯æé«˜SQLæŠ€èƒ½çš„å…³é”® - å°è¯•åˆ›å»ºè‡ªå·±çš„æ•°æ®åº“é¡¹ç›®ï¼Œè§£å†³å®é™…é—®é¢˜ï¼Œä½ å°†æˆä¸ºSQLä¸“å®¶ï¼</p>\n</blockquote>\n<h2 id=\"å‚è€ƒ-è‡´è°¢\">å‚è€ƒ&amp;è‡´è°¢</h2>\n<h2 id=\"ç³»åˆ—æ•™ç¨‹\"><strong>ç³»åˆ—æ•™ç¨‹</strong></h2>\n<p><a href=\"/atom.xml\"><i class=\"fas fa-rss\"></i>å…¨éƒ¨æ–‡ç« RSSè®¢é˜…</a></p>\n\n<h3 id=\"æ•°æ®åº“ç³»åˆ—\"><strong>æ•°æ®åº“ç³»åˆ—</strong></h3>\n<ul>\n<li><a href=\"/posts/b2f7c564/\">SQLå‘½ä»¤ä½¿ç”¨æ•™ç¨‹ï¼šä»å…¥é—¨åˆ°ç²¾é€š</a></li>\n<li><a href=\"/posts/847851a6/\">SQLiteä½¿ç”¨å…¨é¢æ•™ç¨‹ï¼šè½»é‡çº§æ•°æ®åº“çš„ç»ˆææŒ‡å—</a></li>\n<li><a href=\"/posts/a460ae99/\">MySQLå‘½ä»¤è¡Œä½¿ç”¨å…¨é¢æ•™ç¨‹ï¼šä»å…¥é—¨åˆ°ç²¾é€š</a></li>\n<li><a href=\"/posts/622f0f0f/\">MySQL ä½¿ç”¨å…¨é¢æŒ‡å—ï¼šä»å…¥é—¨åˆ°é«˜çº§å®è·µ</a></li>\n<li><a href=\"/posts/16bffe88/\">PostgreSQL ä½¿ç”¨å…¨é¢æŒ‡å—ï¼šä»å…¥é—¨åˆ°ä¼ä¸šçº§åº”ç”¨</a></li>\n<li><a href=\"/posts/6c6f64dc/\">PostgreSQLå‘½ä»¤è¡Œä½¿ç”¨æ•™ç¨‹ï¼šæŒæ¡ psql å·¥å…·</a></li>\n<li><a href=\"/posts/a416ccaa/\">PostgreSQL å®ç°åŸç†æ·±åº¦å‰–æï¼šé«˜æ€§èƒ½æ•°æ®åº“å¼•æ“çš„æ ¸å¿ƒæœºåˆ¶</a></li>\n</ul>\n\n<link rel=\"stylesheet\" href=\"https://fastly.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/style.css\"><script src=\"https://fastly.jsdelivr.net/npm/d3@7\"></script><script src=\"https://fastly.jsdelivr.net/npm/markmap-view@0.18.10\"></script><script src=\"https://fastly.jsdelivr.net/npm/markmap-toolbar@0.18.10\"></script>\n<link rel=\"stylesheet\" href=\"/css/markmap.css\">\n\n<script src=\"/js/markmap.js\"></script>\n",
            "tags": [
                "web",
                "sql"
            ]
        }
    ]
}