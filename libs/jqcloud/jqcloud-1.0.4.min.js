!function(C){"use strict";C.fn.jQCloud=function(k,y){function e(){for(var m=function(e,t){for(var i,h,n=0,n=0;n<t.length;n++)if(i=e,h=t[n],Math.abs(2*i.offsetLeft+i.offsetWidth-2*h.offsetLeft-h.offsetWidth)<i.offsetWidth+h.offsetWidth&&Math.abs(2*i.offsetTop+i.offsetHeight-2*h.offsetTop-h.offsetHeight)<i.offsetHeight+h.offsetHeight)return!0;return!1},e=0;e<k.length;e++)k[e].weight=parseFloat(k[e].weight,10);function t(e,t){var i,h=b+"_word_"+e,n=6.28*Math.random(),o=0,r=0,a=0,s=5,d="",f="";if(t.html=C.extend(t.html,{id:h}),t.html&&t.html.class&&(d=t.html.class,delete t.html.class),k[0].weight>k[k.length-1].weight&&(s=Math.round((t.weight-k[k.length-1].weight)/(k[0].weight-k[k.length-1].weight)*9)+1),i=C("<span>").attr(t.html).addClass("w"+s+" "+d),f=t.link?("string"==typeof t.link&&(t.link={href:t.link}),y.encodeURI&&(t.link=C.extend(t.link,{href:encodeURI(t.link.href).replace(/'/g,"%27")})),C("<a>").attr(t.link).text(t.text)):t.text,i.append(f),t.handlers)for(var l in t.handlers)t.handlers.hasOwnProperty(l)&&"function"==typeof t.handlers[l]&&C(i).bind(l,t.handlers[l]);R.append(i);var c=i.width(),g=i.height(),u=y.center.x-c/2,w=y.center.y-g/2,p=i[0].style;for(p.position="absolute",p.left=u+"px",p.top=w+"px";m(i[0],v);){if("rectangular"===y.shape)switch(++r*M>(1+Math.floor(a/2))*M*(a%4%2==0?1:x)&&(r=0,a++),a%4){case 1:u+=M*x+2*Math.random();break;case 2:w-=M+2*Math.random();break;case 3:u-=M*x+2*Math.random();break;case 0:w+=M+2*Math.random()}else o+=M,n+=(e%2==0?1:-1)*M,u=y.center.x-c/2+o*Math.cos(n)*x,w=y.center.y+o*Math.sin(n)-g/2;p.left=u+"px",p.top=w+"px"}y.removeOverflowing&&(u<0||w<0||u+c>y.width||w+g>y.height)?i.remove():(v.push(i[0]),C.isFunction(t.afterWordRender)&&t.afterWordRender.call(i))}function i(e){e=e||0,R.is(":visible")?e<k.length?(t(e,k[e]),setTimeout(function(){i(e+1)},10)):C.isFunction(y.afterCloudRender)&&y.afterCloudRender.call(R):setTimeout(function(){i(e)},10)}k.sort(function(e,t){return e.weight<t.weight?1:e.weight>t.weight?-1:0});var M="rectangular"===y.shape?18:2,v=[],x=y.width/y.height;y.delayedMode?i():(C.each(k,t),C.isFunction(y.afterCloudRender)&&y.afterCloudRender.call(R))}var R=this,b=R.attr("id")||Math.floor(1e6*Math.random()).toString(36),t={width:R.width(),height:R.height(),center:{x:(y&&y.width?y.width:R.width())/2,y:(y&&y.height?y.height:R.height())/2},delayedMode:50<k.length,shape:!1,encodeURI:!0,removeOverflowing:!0};y=C.extend(t,y||{}),R.addClass("jqcloud").width(y.width).height(y.height),"static"===R.css("position")&&R.css("position","relative");return setTimeout(function(){e()},10),R}}(jQuery);