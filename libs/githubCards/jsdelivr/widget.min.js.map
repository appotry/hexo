{"version":3,"file":"widget.min.js","names":["d","i","client_url","client_id","client_secret","client_theme","base","count","metas","getElementsByTagName","length","n","getAttribute","c","querydata","element","name","render","card","cardurl","theme","user","repo","github","split","width","height","target","key","secret","identity","iframe","createElement","setAttribute","style","cssText","onload","backgroundImage","handleFrameLoad","this","classList","add","onerror","console","error","src","handleFrameError","url","Math","min","parentNode","clientWidth","window","addEventListener","e","id","data","sender","heighty","replaceChild","cards","querySelectorAll","elements","ret","className","indexOf","push","queryclass","githubCard","document"],"sources":["src/widget.js"],"sourcesContent":["(function(d) {\r\n  var base = \"/libs/githubCards/\";\r\n\r\n  var i, count = 0;\r\n\r\n  var metas = d.getElementsByTagName('meta');\r\n  var client_url, client_id, client_secret, client_theme;\r\n  for (i = 0; i < metas.length; i++) {\r\n    var n = metas[i].getAttribute('name');\r\n    var c = metas[i].getAttribute('content');\r\n    if (n === 'gc:url') {\r\n      client_url = c;\r\n    } else if (n === 'gc:base') {\r\n      base = c;\r\n    } else if (n === 'gc:client-id') {\r\n      client_id = c;\r\n    } else if (n === 'gc:client-secret') {\r\n      client_secret = c;\r\n    } else if (n === 'gc:theme') {\r\n      client_theme = c;\r\n    }\r\n  }\r\n\r\n  function queryclass(name) {\r\n    if (d.querySelectorAll) {\r\n      return d.querySelectorAll('.' + name);\r\n    }\r\n    var elements = d.getElementsByTagName('div');\r\n    var ret = [];\r\n    for (i = 0; i < elements.length; i++) {\r\n      if (~elements[i].className.split(' ').indexOf(name)) {\r\n        ret.push(elements[i]);\r\n      }\r\n    }\r\n    return ret;\r\n  }\r\n\r\n  function querydata(element, name) {\r\n    return element.getAttribute('data-' + name);\r\n  }\r\n\r\n  function heighty(iframe) {\r\n    if (window.addEventListener) {\r\n      window.addEventListener('message', function(e) {\r\n        if (iframe.id === e.data.sender) {\r\n          iframe.height = e.data.height;\r\n        }\r\n      }, false);\r\n    }\r\n  }\r\n\r\n  function render(card, cardurl) {\r\n    cardurl = cardurl || client_url;\r\n    if (!cardurl) {\r\n      var theme = querydata(card, 'theme') || client_theme || 'default';\r\n      cardurl = base + 'cards/' + theme + '.html';\r\n    }\r\n    var user = querydata(card, 'user');\r\n    var repo = querydata(card, 'repo');\r\n    var github = querydata(card, 'github');\r\n    if (github) {\r\n      github = github.split('/');\r\n      if (github.length && !user) {\r\n        user = github[0];\r\n        repo = repo || github[1];\r\n      }\r\n    }\r\n    if (!user) {\r\n      return;\r\n    }\r\n\r\n    count += 1;\r\n    var width = querydata(card, 'width');\r\n    var height = querydata(card, 'height');\r\n    var target = querydata(card, 'target');\r\n\r\n    var key = querydata(card, 'client-id') || client_id;\r\n    var secret = querydata(card, 'client-secret') || client_secret;\r\n\r\n    var identity = 'ghcard-' + user + '-' + count;\r\n\r\n    var iframe = d.createElement('iframe');\r\n    iframe.setAttribute('loading', 'lazy');\r\n    iframe.setAttribute('id', identity);\r\n\t  iframe.setAttribute('title', 'GitHub Profile');\r\n    iframe.setAttribute('frameborder', 0);\r\n    iframe.setAttribute('scrolling', 0);\r\n    iframe.setAttribute('allowtransparency', true);\r\n    iframe.setAttribute(\"onload\", \"hideBackgroundImg(this)\");\r\n\r\n    iframe.style.cssText = `\r\n      background-image: var(--loading-img-scroll);\r\n      background-size: cover;\r\n      background-repeat: no-repeat;\r\n      background-position: center;\r\n    `;\r\n\r\n    iframe.onload = function() {\r\n      handleFrameLoad(this);\r\n      this.classList.add('loaded');\r\n    };\r\n\r\n    iframe.onerror = function() {\r\n      handleFrameError(this);\r\n    };\r\n\r\n    var url = cardurl + '?user=' + user + '&identity=' + identity;\r\n    if (repo) {\r\n      url += '&repo=' + repo;\r\n    }\r\n    if (target) {\r\n      url += '&target=' + target;\r\n    }\r\n    if (key && secret) {\r\n      url += '&client_id=' + key + '&client_secret=' + secret;\r\n    }\r\n    iframe.src = url;\r\n    iframe.width = width || Math.min(card.parentNode.clientWidth || 400, 400);\r\n    if (height) {\r\n      iframe.height = height;\r\n    }\r\n    heighty(iframe);\r\n    card.parentNode.replaceChild(iframe, card);\r\n    return iframe;\r\n  }\r\n\r\n  function handleFrameLoad(iframe) {\r\n    iframe.style.backgroundImage = \"none\";\r\n  }\r\n\r\n  function handleFrameError(iframe) {\r\n    console.error('iframe加载失败:', iframe.src);\r\n    // iframe.parentNode.removeChild(iframe); // 可选：移除失败元素\r\n  }\r\n\r\n  var cards = queryclass('github-card');\r\n  for (i = 0; i < cards.length; i++) {\r\n    render(cards[i]);\r\n  }\r\n\r\n  if (window.githubCard) {\r\n    window.githubCard.render = render;\r\n  }\r\n\r\n})(document);\r\n"],"mappings":"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","ignoreList":[]}